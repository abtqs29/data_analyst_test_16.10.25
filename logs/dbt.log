[0m13:36:15.351821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF1188D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF221D840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF221D720>]}


============================== 13:36:15.358600 | 7678ff92-edd5-4e15-a67e-d39d9eabdc56 ==============================
[0m13:36:15.358600 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:36:15.358600 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:36:15.400879 [info ] [MainThread]: dbt version: 1.10.13
[0m13:36:15.400879 [info ] [MainThread]: python version: 3.10.11
[0m13:36:15.400879 [info ] [MainThread]: python path: C:\Users\IVS737\AppData\Local\Programs\Python\Python310\python.exe
[0m13:36:15.400879 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:36:15.400879 [info ] [MainThread]: Using profiles dir at C:\Users\IVS737\.dbt
[0m13:36:15.400879 [info ] [MainThread]: Using profiles.yml file at C:\Users\IVS737\.dbt\profiles.yml
[0m13:36:15.400879 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\IVS737\Desktop\16.10 data test task\dbt_project.yml
[0m13:36:15.523672 [info ] [MainThread]: Configuration:
[0m13:36:15.523672 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m13:36:15.534819 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:36:15.534819 [info ] [MainThread]: Required dependencies:
[0m13:36:15.536085 [debug] [MainThread]: Executing "git --help"
[0m13:36:15.539444 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:36:15.540509 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:36:15.540795 [info ] [MainThread]: [31m2 checks failed:[0m
[0m13:36:15.541419 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\IVS737\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m13:36:15.541419 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m13:36:15.542400 [debug] [MainThread]: Command `dbt debug` failed at 13:36:15.542400 after 0.31 seconds
[0m13:36:15.543610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF1188D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF1430DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECF34F0C40>]}
[0m13:36:15.543610 [debug] [MainThread]: Flushing usage events
[0m13:36:16.200219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:12.693642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8216CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F843508B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F843512A0>]}


============================== 13:41:12.697873 | 95e8361e-0093-4423-acb7-35548a45ca8c ==============================
[0m13:41:12.697873 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:41:12.697873 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:41:12.720623 [info ] [MainThread]: dbt version: 1.10.13
[0m13:41:12.720623 [info ] [MainThread]: python version: 3.10.11
[0m13:41:12.720623 [info ] [MainThread]: python path: C:\Users\IVS737\AppData\Local\Programs\Python\Python310\python.exe
[0m13:41:12.722398 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:41:12.927346 [info ] [MainThread]: Using profiles dir at C:\Users\IVS737\.dbt
[0m13:41:12.927346 [info ] [MainThread]: Using profiles.yml file at C:\Users\IVS737\.dbt\profiles.yml
[0m13:41:12.937527 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\IVS737\Desktop\16.10 data test task\dbt_project.yml
[0m13:41:12.937527 [info ] [MainThread]: adapter type: postgres
[0m13:41:12.937527 [info ] [MainThread]: adapter version: 1.9.1
[0m13:41:13.057490 [info ] [MainThread]: Configuration:
[0m13:41:13.057490 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:41:13.057490 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:41:13.057490 [info ] [MainThread]: Required dependencies:
[0m13:41:13.057490 [debug] [MainThread]: Executing "git --help"
[0m13:41:13.070386 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:41:13.070386 [info ] [MainThread]: Connection:
[0m13:41:13.070386 [info ] [MainThread]:   host: localhost
[0m13:41:13.070386 [info ] [MainThread]:   port: 5432
[0m13:41:13.070386 [info ] [MainThread]:   user: your_user
[0m13:41:13.070386 [info ] [MainThread]:   database: your_database
[0m13:41:13.070386 [info ] [MainThread]:   schema: public
[0m13:41:13.070386 [info ] [MainThread]:   connect_timeout: 10
[0m13:41:13.070386 [info ] [MainThread]:   role: None
[0m13:41:13.070386 [info ] [MainThread]:   search_path: None
[0m13:41:13.070386 [info ] [MainThread]:   keepalives_idle: 0
[0m13:41:13.070386 [info ] [MainThread]:   sslmode: None
[0m13:41:13.077627 [info ] [MainThread]:   sslcert: None
[0m13:41:13.077627 [info ] [MainThread]:   sslkey: None
[0m13:41:13.077627 [info ] [MainThread]:   sslrootcert: None
[0m13:41:13.077627 [info ] [MainThread]:   application_name: dbt
[0m13:41:13.077627 [info ] [MainThread]:   retries: 1
[0m13:41:13.077627 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:41:13.437772 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:41:15.353623 [debug] [MainThread]: Using postgres connection "debug"
[0m13:41:15.353623 [debug] [MainThread]: On debug: select 1 as id
[0m13:41:15.353623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:15.417558 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "your_user"

[0m13:41:15.557567 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m13:41:15.557567 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m13:41:15.557567 [debug] [MainThread]: On debug: No close available on handle
[0m13:41:15.557567 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:41:15.557567 [info ] [MainThread]: [31m2 checks failed:[0m
[0m13:41:15.557567 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m13:41:15.562098 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "your_user"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:41:15.563175 [debug] [MainThread]: Command `dbt debug` failed at 13:41:15.563175 after 2.95 seconds
[0m13:41:15.563175 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:41:15.563175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8216CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8453E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F84637820>]}
[0m13:41:15.563175 [debug] [MainThread]: Flushing usage events
[0m13:41:16.161361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:36.524948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012195EC0A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012196A1C040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121970D3910>]}


============================== 13:43:36.524948 | 30c7a2f5-8c49-4bed-b0a6-2e3d6a65f80b ==============================
[0m13:43:36.524948 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:43:36.524948 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:43:36.553932 [info ] [MainThread]: dbt version: 1.10.13
[0m13:43:36.553932 [info ] [MainThread]: python version: 3.10.11
[0m13:43:36.553932 [info ] [MainThread]: python path: C:\Users\IVS737\AppData\Local\Programs\Python\Python310\python.exe
[0m13:43:36.553932 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:43:36.630930 [info ] [MainThread]: Using profiles dir at C:\Users\IVS737\.dbt
[0m13:43:36.630930 [info ] [MainThread]: Using profiles.yml file at C:\Users\IVS737\.dbt\profiles.yml
[0m13:43:36.630930 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\IVS737\Desktop\16.10 data test task\dbt_project.yml
[0m13:43:36.630930 [info ] [MainThread]: adapter type: postgres
[0m13:43:36.630930 [info ] [MainThread]: adapter version: 1.9.1
[0m13:43:36.779296 [info ] [MainThread]: Configuration:
[0m13:43:36.780309 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:43:36.781295 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:43:36.781295 [info ] [MainThread]: Required dependencies:
[0m13:43:36.781295 [debug] [MainThread]: Executing "git --help"
[0m13:43:36.786987 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:43:36.787416 [info ] [MainThread]: Connection:
[0m13:43:36.787997 [info ] [MainThread]:   host: localhost
[0m13:43:36.789003 [info ] [MainThread]:   port: 5432
[0m13:43:36.789003 [info ] [MainThread]:   user: postgres
[0m13:43:36.790008 [info ] [MainThread]:   database: your_database
[0m13:43:36.790008 [info ] [MainThread]:   schema: public
[0m13:43:36.790008 [info ] [MainThread]:   connect_timeout: 10
[0m13:43:36.791291 [info ] [MainThread]:   role: None
[0m13:43:36.791291 [info ] [MainThread]:   search_path: None
[0m13:43:36.792297 [info ] [MainThread]:   keepalives_idle: 0
[0m13:43:36.792297 [info ] [MainThread]:   sslmode: None
[0m13:43:36.793316 [info ] [MainThread]:   sslcert: None
[0m13:43:36.794508 [info ] [MainThread]:   sslkey: None
[0m13:43:36.794879 [info ] [MainThread]:   sslrootcert: None
[0m13:43:36.795455 [info ] [MainThread]:   application_name: dbt
[0m13:43:36.796097 [info ] [MainThread]:   retries: 1
[0m13:43:36.797338 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:43:37.069128 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:43:37.130298 [debug] [MainThread]: Using postgres connection "debug"
[0m13:43:37.130298 [debug] [MainThread]: On debug: select 1 as id
[0m13:43:37.130298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:37.178140 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "your_database" does not exist

[0m13:43:37.211631 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m13:43:37.211631 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m13:43:37.211631 [debug] [MainThread]: On debug: No close available on handle
[0m13:43:37.211631 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:43:37.223150 [info ] [MainThread]: [31m2 checks failed:[0m
[0m13:43:37.223150 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m13:43:37.224075 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "your_database" does not exist
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:43:37.225594 [debug] [MainThread]: Command `dbt debug` failed at 13:43:37.225594 after 0.80 seconds
[0m13:43:37.225594 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:43:37.226593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012195EC0A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121972AC220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001219735C550>]}
[0m13:43:37.226593 [debug] [MainThread]: Flushing usage events
[0m13:43:37.804351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:17.478424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000109C6C20A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000109C7E31660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000109C7E33E50>]}


============================== 13:44:17.482921 | 1a3cdb63-177d-45cd-9ac3-8a67ecdacf30 ==============================
[0m13:44:17.482921 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:44:17.483423 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:44:17.506204 [info ] [MainThread]: dbt version: 1.10.13
[0m13:44:17.506204 [info ] [MainThread]: python version: 3.10.11
[0m13:44:17.506204 [info ] [MainThread]: python path: C:\Users\IVS737\AppData\Local\Programs\Python\Python310\python.exe
[0m13:44:17.506204 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:44:17.584458 [info ] [MainThread]: Using profiles dir at C:\Users\IVS737\.dbt
[0m13:44:17.584458 [info ] [MainThread]: Using profiles.yml file at C:\Users\IVS737\.dbt\profiles.yml
[0m13:44:17.584458 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\IVS737\Desktop\16.10 data test task\dbt_project.yml
[0m13:44:17.584458 [info ] [MainThread]: adapter type: postgres
[0m13:44:17.584458 [info ] [MainThread]: adapter version: 1.9.1
[0m13:44:17.725206 [info ] [MainThread]: Configuration:
[0m13:44:17.725206 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:44:17.725206 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:44:17.725206 [info ] [MainThread]: Required dependencies:
[0m13:44:17.725206 [debug] [MainThread]: Executing "git --help"
[0m13:44:17.734788 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:44:17.734788 [info ] [MainThread]: Connection:
[0m13:44:17.734788 [info ] [MainThread]:   host: localhost
[0m13:44:17.734788 [info ] [MainThread]:   port: 5432
[0m13:44:17.734788 [info ] [MainThread]:   user: postgres
[0m13:44:17.734788 [info ] [MainThread]:   database: postgres
[0m13:44:17.734788 [info ] [MainThread]:   schema: public
[0m13:44:17.734788 [info ] [MainThread]:   connect_timeout: 10
[0m13:44:17.734788 [info ] [MainThread]:   role: None
[0m13:44:17.734788 [info ] [MainThread]:   search_path: None
[0m13:44:17.741269 [info ] [MainThread]:   keepalives_idle: 0
[0m13:44:17.741269 [info ] [MainThread]:   sslmode: None
[0m13:44:17.741269 [info ] [MainThread]:   sslcert: None
[0m13:44:17.743041 [info ] [MainThread]:   sslkey: None
[0m13:44:17.743041 [info ] [MainThread]:   sslrootcert: None
[0m13:44:17.744405 [info ] [MainThread]:   application_name: dbt
[0m13:44:17.744405 [info ] [MainThread]:   retries: 1
[0m13:44:17.744405 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:44:18.020511 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:44:18.084776 [debug] [MainThread]: Using postgres connection "debug"
[0m13:44:18.084776 [debug] [MainThread]: On debug: select 1 as id
[0m13:44:18.084776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:18.162008 [debug] [MainThread]: SQL status: SELECT 1 in 0.072 seconds
[0m13:44:18.162008 [debug] [MainThread]: On debug: Close
[0m13:44:18.162008 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:44:18.169380 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:44:18.169380 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m13:44:18.169380 [debug] [MainThread]: Command `dbt debug` failed at 13:44:18.169380 after 0.79 seconds
[0m13:44:18.169380 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:44:18.169380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000109C6C20A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000109C800E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000109C80BF130>]}
[0m13:44:18.169380 [debug] [MainThread]: Flushing usage events
[0m13:44:18.692878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:40.146013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C924BCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C946A2170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C946A09A0>]}


============================== 13:45:40.150074 | 03301684-77e7-4109-ae13-9ee87da90b0f ==============================
[0m13:45:40.150074 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:45:40.150074 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt seed', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:45:40.525400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03301684-77e7-4109-ae13-9ee87da90b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C909AC490>]}
[0m13:45:40.613544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03301684-77e7-4109-ae13-9ee87da90b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C9449B520>]}
[0m13:45:40.616089 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:45:41.025756 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:45:41.027269 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:45:41.027269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03301684-77e7-4109-ae13-9ee87da90b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C94991720>]}
[0m13:45:44.827793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03301684-77e7-4109-ae13-9ee87da90b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C95EDE500>]}
[0m13:45:45.008726 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:45:45.038858 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:45:45.094808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03301684-77e7-4109-ae13-9ee87da90b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C94D26470>]}
[0m13:45:45.096811 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m13:45:45.098147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03301684-77e7-4109-ae13-9ee87da90b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C95F4EDD0>]}
[0m13:45:45.100423 [info ] [MainThread]: 
[0m13:45:45.101463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:45.102077 [info ] [MainThread]: 
[0m13:45:45.103093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:45.105314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:45:45.198123 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:45:45.198817 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:45:45.198817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:45.368817 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.173 seconds
[0m13:45:45.368817 [debug] [ThreadPool]: On list_postgres: Close
[0m13:45:45.375686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m13:45:45.375686 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m13:45:45.378787 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m13:45:45.378787 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m13:45:45.378787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:45.423885 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m13:45:45.423885 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m13:45:45.424961 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m13:45:45.429165 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m13:45:45.430209 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m13:45:45.431600 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m13:45:45.431600 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m13:45:45.432612 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:45:45.433650 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m13:45:45.439583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m13:45:45.442768 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:45:45.448198 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m13:45:45.448896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:45.585958 [debug] [ThreadPool]: SQL status: BEGIN in 0.138 seconds
[0m13:45:45.588217 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:45:45.588841 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:45:45.604927 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.017 seconds
[0m13:45:45.604927 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m13:45:45.608881 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m13:45:45.608881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m13:45:45.612784 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:45:45.612784 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m13:45:45.612784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:45.756322 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m13:45:45.758242 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:45:45.758941 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:45:45.763348 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m13:45:45.764686 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m13:45:45.765719 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m13:45:45.771018 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:45.771018 [debug] [MainThread]: On master: BEGIN
[0m13:45:45.771018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:45.808865 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m13:45:45.808865 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:45.808865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:45:45.824186 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m13:45:45.824186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03301684-77e7-4109-ae13-9ee87da90b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C94D25F60>]}
[0m13:45:45.828270 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:45.829208 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:45.829208 [debug] [MainThread]: On master: BEGIN
[0m13:45:45.829208 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:45:45.829208 [debug] [MainThread]: On master: COMMIT
[0m13:45:45.829208 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:45.829208 [debug] [MainThread]: On master: COMMIT
[0m13:45:45.829208 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:45:45.829208 [debug] [MainThread]: On master: Close
[0m13:45:45.871583 [debug] [Thread-1 (]: Began running node seed.gyb_test_project.sales_data
[0m13:45:45.872330 [info ] [Thread-1 (]: 1 of 1 START seed file public_staging.sales_data ............................... [RUN]
[0m13:45:45.873330 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.gyb_test_project.sales_data'
[0m13:45:45.874470 [debug] [Thread-1 (]: Began compiling node seed.gyb_test_project.sales_data
[0m13:45:45.874470 [debug] [Thread-1 (]: Began executing node seed.gyb_test_project.sales_data
[0m13:45:45.989669 [debug] [Thread-1 (]: Using postgres connection "seed.gyb_test_project.sales_data"
[0m13:45:45.989669 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: BEGIN
[0m13:45:45.998311 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:45:46.142285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m13:45:46.142285 [debug] [Thread-1 (]: Using postgres connection "seed.gyb_test_project.sales_data"
[0m13:45:46.142285 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "seed.gyb_test_project.sales_data"} */

    create table "postgres"."public_staging"."sales_data" (Reference ID text,Country text,Product Code text,Product Name text,Subscription Start Date date,Subscription Deactivation Date date,Subscription Duration Months integer,Order Date Kyiv timestamp without time zone,Return Date Kyiv timestamp without time zone,Last Rebill Date Kyiv timestamp without time zone,Has Chargeback text,Has Refund text,Sales Agent Name text,Source text,Campaign Name text,Total Amount ($) float8,Discount Amount ($) float8,Number Of Rebills integer,Original Amount ($) float8,Returned Amount ($) float8,Total Rebill Amount float8)
  
[0m13:45:46.146108 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "text"
LINE 3: ...gres"."public_staging"."sales_data" (Reference ID text,Count...
                                                             ^

[0m13:45:46.146108 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: ROLLBACK
[0m13:45:46.146108 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: Close
[0m13:45:46.294346 [debug] [Thread-1 (]: Database Error in seed sales_data (seeds\sales_data.csv)
  syntax error at or near "text"
  LINE 3: ...gres"."public_staging"."sales_data" (Reference ID text,Count...
                                                               ^
[0m13:45:46.296350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03301684-77e7-4109-ae13-9ee87da90b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C93E4C6D0>]}
[0m13:45:46.298187 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public_staging.sales_data ....................... [[31mERROR[0m in 0.42s]
[0m13:45:46.298187 [debug] [Thread-1 (]: Finished running node seed.gyb_test_project.sales_data
[0m13:45:46.298187 [debug] [Thread-4 (]: Marking all children of 'seed.gyb_test_project.sales_data' to be skipped because of status 'error'.  Reason: Database Error in seed sales_data (seeds\sales_data.csv)
  syntax error at or near "text"
  LINE 3: ...gres"."public_staging"."sales_data" (Reference ID text,Count...
                                                               ^.
[0m13:45:46.298187 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:46.303456 [debug] [MainThread]: On master: BEGIN
[0m13:45:46.303456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:46.439394 [debug] [MainThread]: SQL status: BEGIN in 0.136 seconds
[0m13:45:46.439394 [debug] [MainThread]: On master: COMMIT
[0m13:45:46.439394 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:46.439394 [debug] [MainThread]: On master: COMMIT
[0m13:45:46.439394 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:45:46.439394 [debug] [MainThread]: On master: Close
[0m13:45:46.444126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:46.444718 [debug] [MainThread]: Connection 'create_postgres_public_staging' was properly closed.
[0m13:45:46.444718 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m13:45:46.444718 [debug] [MainThread]: Connection 'seed.gyb_test_project.sales_data' was properly closed.
[0m13:45:46.444718 [info ] [MainThread]: 
[0m13:45:46.444718 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m13:45:46.447180 [debug] [MainThread]: Command end result
[0m13:45:46.473727 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:45:46.473727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:45:46.473727 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m13:45:46.489410 [info ] [MainThread]: 
[0m13:45:46.489410 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:45:46.491918 [info ] [MainThread]: 
[0m13:45:46.491918 [error] [MainThread]: [31mFailure in seed sales_data (seeds\sales_data.csv)[0m
[0m13:45:46.491918 [error] [MainThread]:   Database Error in seed sales_data (seeds\sales_data.csv)
  syntax error at or near "text"
  LINE 3: ...gres"."public_staging"."sales_data" (Reference ID text,Count...
                                                               ^
[0m13:45:46.494426 [info ] [MainThread]: 
[0m13:45:46.494426 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:45:46.496428 [debug] [MainThread]: Command `dbt seed` failed at 13:45:46.494426 after 6.46 seconds
[0m13:45:46.496932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C924BCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C93736500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C9491A020>]}
[0m13:45:46.496932 [debug] [MainThread]: Flushing usage events
[0m13:45:47.080791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:18.878502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F7710A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F88EB370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F88EBCA0>]}


============================== 13:48:18.883515 | 1fcc5df2-a788-4c80-9026-87a152a8970d ==============================
[0m13:48:18.883515 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:48:18.883515 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt seed --full-refresh', 'printer_width': '80', 'target_path': 'None'}
[0m13:48:19.131435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fcc5df2-a788-4c80-9026-87a152a8970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F8B6D510>]}
[0m13:48:19.225856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fcc5df2-a788-4c80-9026-87a152a8970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F8A7A800>]}
[0m13:48:19.225856 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:48:19.533522 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:48:19.740181 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:48:19.740181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fcc5df2-a788-4c80-9026-87a152a8970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F80FBE20>]}
[0m13:48:21.772372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fcc5df2-a788-4c80-9026-87a152a8970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FA219600>]}
[0m13:48:21.927491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:48:21.927491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:48:21.963952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fcc5df2-a788-4c80-9026-87a152a8970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FA285570>]}
[0m13:48:21.965954 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m13:48:21.965954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fcc5df2-a788-4c80-9026-87a152a8970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FA2160B0>]}
[0m13:48:21.965954 [info ] [MainThread]: 
[0m13:48:21.965954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:21.965954 [info ] [MainThread]: 
[0m13:48:21.971081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:48:21.971081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:48:22.053472 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:48:22.053472 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:48:22.053472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:22.210654 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.149 seconds
[0m13:48:22.211661 [debug] [ThreadPool]: On list_postgres: Close
[0m13:48:22.218828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m13:48:22.224474 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:48:22.224474 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m13:48:22.224474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:22.263515 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m13:48:22.263515 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:48:22.263515 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:48:22.271032 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:48:22.272071 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m13:48:22.272071 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m13:48:22.272071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m13:48:22.272071 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:48:22.272071 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m13:48:22.272071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:22.315792 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m13:48:22.315792 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:48:22.315792 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:48:22.323654 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:48:22.324655 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m13:48:22.325652 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m13:48:22.331696 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:22.331696 [debug] [MainThread]: On master: BEGIN
[0m13:48:22.332704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:22.369921 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m13:48:22.369921 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:22.369921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:48:22.377185 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:48:22.377185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fcc5df2-a788-4c80-9026-87a152a8970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FA05D300>]}
[0m13:48:22.377185 [debug] [MainThread]: On master: ROLLBACK
[0m13:48:22.381193 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:22.382233 [debug] [MainThread]: On master: BEGIN
[0m13:48:22.382233 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:48:22.382233 [debug] [MainThread]: On master: COMMIT
[0m13:48:22.382233 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:22.382233 [debug] [MainThread]: On master: COMMIT
[0m13:48:22.382233 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:48:22.382233 [debug] [MainThread]: On master: Close
[0m13:48:22.382233 [debug] [Thread-1 (]: Began running node seed.gyb_test_project.sales_data
[0m13:48:22.390965 [info ] [Thread-1 (]: 1 of 1 START seed file public_staging.sales_data ............................... [RUN]
[0m13:48:22.392389 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.gyb_test_project.sales_data'
[0m13:48:22.392892 [debug] [Thread-1 (]: Began compiling node seed.gyb_test_project.sales_data
[0m13:48:22.392892 [debug] [Thread-1 (]: Began executing node seed.gyb_test_project.sales_data
[0m13:48:22.490137 [debug] [Thread-1 (]: Using postgres connection "seed.gyb_test_project.sales_data"
[0m13:48:22.490137 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: BEGIN
[0m13:48:22.490137 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:48:22.644851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m13:48:22.644851 [debug] [Thread-1 (]: Using postgres connection "seed.gyb_test_project.sales_data"
[0m13:48:22.645849 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "seed.gyb_test_project.sales_data"} */

    create table "postgres"."public_staging"."sales_data" ("Reference ID" text,"Country" text,"Product Code" text,"Product Name" text,"Subscription Start Date" date,"Subscription Deactivation Date" date,"Subscription Duration Months" integer,"Order Date Kyiv" timestamp without time zone,"Return Date Kyiv" timestamp without time zone,"Last Rebill Date Kyiv" timestamp without time zone,"Has Chargeback" text,"Has Refund" text,"Sales Agent Name" text,"Source" text,"Campaign Name" text,"Total Amount ($)" float8,"Discount Amount ($)" float8,"Number Of Rebills" integer,"Original Amount ($)" float8,"Returned Amount ($)" float8,"Total Rebill Amount" float8)
  
[0m13:48:22.658967 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.012 seconds
[0m13:48:24.568545 [debug] [Thread-1 (]: Using postgres connection "seed.gyb_test_project.sales_data"
[0m13:48:24.568545 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: 
          insert into "postgres"."public_staging"."sales_data" ("Reference ID", "Country", "Product Code", "Product Name", "Subscription Start Date", "Subscription Deactivation Date", "Subscription Duration Months", "Order Date Kyiv", "Return Date Kyiv", "Last Rebill Date Kyiv", "Has Chargeback", "Has Refund", "Sales Agent Name", "Source", "Campaign Name", "Total Amount ($)", "Discount Amount ($)", "Number Of Rebills", "Original Amount ($)", "Returned Amount ($)", "Total Rebill Amount") values
          (%...
[0m13:48:24.608911 [debug] [Thread-1 (]: SQL status: INSERT 0 499 in 0.032 seconds
[0m13:48:24.615732 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.gyb_test_project.sales_data"
[0m13:48:24.630706 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: COMMIT
[0m13:48:24.630706 [debug] [Thread-1 (]: Using postgres connection "seed.gyb_test_project.sales_data"
[0m13:48:24.630706 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: COMMIT
[0m13:48:24.630706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:48:24.630706 [debug] [Thread-1 (]: On seed.gyb_test_project.sales_data: Close
[0m13:48:24.646386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fcc5df2-a788-4c80-9026-87a152a8970d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F9FCB6A0>]}
[0m13:48:24.646386 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_staging.sales_data ........................... [[32mCREATE 499[0m in 2.24s]
[0m13:48:24.649741 [debug] [Thread-1 (]: Finished running node seed.gyb_test_project.sales_data
[0m13:48:24.651902 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:24.651902 [debug] [MainThread]: On master: BEGIN
[0m13:48:24.651902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:24.688296 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m13:48:24.688296 [debug] [MainThread]: On master: COMMIT
[0m13:48:24.688296 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:24.688296 [debug] [MainThread]: On master: COMMIT
[0m13:48:24.688296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:48:24.688296 [debug] [MainThread]: On master: Close
[0m13:48:24.688296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:24.693553 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:48:24.693553 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m13:48:24.693553 [debug] [MainThread]: Connection 'seed.gyb_test_project.sales_data' was properly closed.
[0m13:48:24.694924 [info ] [MainThread]: 
[0m13:48:24.694924 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m13:48:24.696813 [debug] [MainThread]: Command end result
[0m13:48:24.729088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:48:24.732723 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:48:24.740438 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m13:48:24.740438 [info ] [MainThread]: 
[0m13:48:24.744220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:24.744220 [info ] [MainThread]: 
[0m13:48:24.744220 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:48:24.747658 [debug] [MainThread]: Command `dbt seed` succeeded at 13:48:24.745768 after 5.97 seconds
[0m13:48:24.747658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F7710A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F79E1570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FA17A470>]}
[0m13:48:24.747658 [debug] [MainThread]: Flushing usage events
[0m13:48:25.507597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:31.811363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E0E1CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E2031600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E20314B0>]}


============================== 13:50:31.814827 | eec70e45-0411-4644-814b-0c162a9efcdb ==============================
[0m13:50:31.814827 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:50:31.815865 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:50:32.051663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eec70e45-0411-4644-814b-0c162a9efcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DE33C400>]}
[0m13:50:32.130460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eec70e45-0411-4644-814b-0c162a9efcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E1192A40>]}
[0m13:50:32.130460 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:50:32.412697 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:50:32.708754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:32.708754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:32.807320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eec70e45-0411-4644-814b-0c162a9efcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E3745840>]}
[0m13:50:32.959139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:50:32.959139 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:50:32.999667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eec70e45-0411-4644-814b-0c162a9efcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E37749D0>]}
[0m13:50:33.000667 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m13:50:33.001668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec70e45-0411-4644-814b-0c162a9efcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E37748E0>]}
[0m13:50:33.037016 [info ] [MainThread]: 
[0m13:50:33.037016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:33.037016 [info ] [MainThread]: 
[0m13:50:33.037016 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:33.052151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:50:33.145767 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:50:33.145767 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:50:33.145767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:33.195827 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.045 seconds
[0m13:50:33.195827 [debug] [ThreadPool]: On list_postgres: Close
[0m13:50:33.198993 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:50:33.200996 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:50:33.201499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:33.240082 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.039 seconds
[0m13:50:33.242173 [debug] [ThreadPool]: On list_postgres: Close
[0m13:50:33.243176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_marts)
[0m13:50:33.243176 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_marts"
"
[0m13:50:33.249409 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts"
[0m13:50:33.250411 [debug] [ThreadPool]: On create_postgres_public_marts: BEGIN
[0m13:50:33.250411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:33.287070 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m13:50:33.287070 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts"
[0m13:50:33.287070 [debug] [ThreadPool]: On create_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "create_postgres_public_marts"} */
create schema if not exists "public_marts"
[0m13:50:33.287070 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m13:50:33.287070 [debug] [ThreadPool]: On create_postgres_public_marts: COMMIT
[0m13:50:33.287070 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_marts"
[0m13:50:33.287070 [debug] [ThreadPool]: On create_postgres_public_marts: COMMIT
[0m13:50:33.287070 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:50:33.295117 [debug] [ThreadPool]: On create_postgres_public_marts: Close
[0m13:50:33.296870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m13:50:33.302807 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:50:33.302807 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m13:50:33.302807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:33.345652 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m13:50:33.346659 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:50:33.347702 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:50:33.352875 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:50:33.354375 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m13:50:33.355375 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m13:50:33.355375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m13:50:33.358872 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:50:33.359375 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m13:50:33.359375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:33.396527 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m13:50:33.397223 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:50:33.397223 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:50:33.397223 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:50:33.397223 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m13:50:33.397223 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m13:50:33.397223 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:33.412334 [debug] [MainThread]: On master: BEGIN
[0m13:50:33.412334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:33.537598 [debug] [MainThread]: SQL status: BEGIN in 0.132 seconds
[0m13:50:33.537598 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:33.537598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:50:33.537598 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:50:33.537598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec70e45-0411-4644-814b-0c162a9efcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E10A0CD0>]}
[0m13:50:33.553538 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:33.554235 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:33.554235 [debug] [MainThread]: On master: BEGIN
[0m13:50:33.555397 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:50:33.555397 [debug] [MainThread]: On master: COMMIT
[0m13:50:33.555397 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:33.555397 [debug] [MainThread]: On master: COMMIT
[0m13:50:33.557370 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:33.557873 [debug] [MainThread]: On master: Close
[0m13:50:33.559924 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m13:50:33.559924 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_sales ........................... [RUN]
[0m13:50:33.563620 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m13:50:33.564123 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m13:50:33.574327 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m13:50:33.576370 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m13:50:33.616318 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m13:50:33.622408 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m13:50:33.622408 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m13:50:33.622408 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:33.656541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m13:50:33.656541 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m13:50:33.656541 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (

    select
        coalesce("ReferenceID"::text, 'N/A') as reference_id,
        coalesce("Country"::text, 'N/A') as country,
        coalesce("Product Code"::text, 'N/A') as product_code,
        coalesce("Product_Name"::text, 'N/A') as product_name,

        -- subscription fields kept as text/date where available
        coalesce(("Subscription_Start_Date")::text, 'N/A') as subscription_start_date,
        coalesce(("Subscription_Deactivation_Date")::text, 'N/A') as subscription_deactivation_date,
        ("Subscription_Duration_Months")::int as subscription_duration_months,

        -- Cast known timestamp-like columns (assume input is local Kyiv time)
        -- Store as timestamptz by attaching 'Europe/Kyiv' and converting to UTC internally
        case
            when "Order_Date_Kyiv" is null or "Order_Date_Kyiv"::text = '' then null
            else ("Order_Date_Kyiv"::timestamptz)
        end as order_date_kyiv_ts,

        case
            when "Return_Date_Kyiv" is null or "Return_Date_Kyiv"::text = '' then null
            else ("Return_Date_Kyiv"::timestamptz)
        end as return_date_kyiv_ts,

        case
            when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null
            else ("Last_Revill_Date_Kyiv"::timestamptz)
        end as last_rebill_date_kyiv_ts,

        -- flags
        coalesce(("Has_Chargeback")::boolean, false) as has_chargeback,
        coalesce(("Has_Refund")::boolean, false) as has_refund,

        coalesce("Sales_Agent_Name"::text, 'N/A') as sales_agent_name,
        coalesce("Source"::text, 'N/A') as source,
        coalesce("Campaign_Name"::text, 'N/A') as campaign_name,

        -- amounts
        coalesce(("Total_Amount")::numeric, 0) as total_amount,
        coalesce(("Discount_Amount")::numeric, 0) as discount_amount,
        coalesce(("Number Of Rebills")::int, 0) as number_of_rebills,
        coalesce(("Original Amount")::numeric, 0) as original_amount,
        coalesce(("Returned_Amount")::numeric, 0) as returned_amount,
        coalesce(("Total Rebill Amount")::numeric, 0) as total_rebill_amount

    from "postgres"."public_staging"."sales_data"
)

select * from raw;
  );
[0m13:50:33.656541 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 56: select * from raw;
                          ^

[0m13:50:33.656541 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m13:50:33.656541 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m13:50:33.663419 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 56: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m13:50:33.663419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec70e45-0411-4644-814b-0c162a9efcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E227F3D0>]}
[0m13:50:33.663419 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.10s]
[0m13:50:33.671209 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m13:50:33.671209 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 56: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m13:50:33.671209 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m13:50:33.671209 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.fct_sales .................................... [[33mSKIP[0m]
[0m13:50:33.671209 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m13:50:33.675399 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:33.676780 [debug] [MainThread]: On master: BEGIN
[0m13:50:33.676780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:33.711025 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:50:33.711025 [debug] [MainThread]: On master: COMMIT
[0m13:50:33.711025 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:33.711025 [debug] [MainThread]: On master: COMMIT
[0m13:50:33.711025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:33.711025 [debug] [MainThread]: On master: Close
[0m13:50:33.711025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:33.716132 [debug] [MainThread]: Connection 'create_postgres_public_marts' was properly closed.
[0m13:50:33.716132 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m13:50:33.716132 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m13:50:33.716132 [info ] [MainThread]: 
[0m13:50:33.718135 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m13:50:33.718135 [debug] [MainThread]: Command end result
[0m13:50:33.740734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:50:33.740734 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:50:33.756417 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m13:50:33.756417 [info ] [MainThread]: 
[0m13:50:33.756417 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:50:33.760541 [info ] [MainThread]: 
[0m13:50:33.760541 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m13:50:33.761849 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 56: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m13:50:33.761849 [info ] [MainThread]: 
[0m13:50:33.763361 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m13:50:33.763361 [info ] [MainThread]: 
[0m13:50:33.764584 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m13:50:33.765783 [debug] [MainThread]: Command `dbt run` failed at 13:50:33.765783 after 2.06 seconds
[0m13:50:33.765783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E0E1CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E218D060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E10C70A0>]}
[0m13:50:33.765783 [debug] [MainThread]: Flushing usage events
[0m13:50:34.365471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:51.221078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239430B0A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239442CBF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239442C88E0>]}


============================== 13:54:51.229774 | c096f324-b27e-4e15-a42a-3637615421cc ==============================
[0m13:54:51.229774 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:54:51.231777 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m13:54:51.744278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c096f324-b27e-4e15-a42a-3637615421cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239433802B0>]}
[0m13:54:51.915383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c096f324-b27e-4e15-a42a-3637615421cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239441808E0>]}
[0m13:54:51.919898 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:54:52.501515 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:54:53.084666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:53.087173 [debug] [MainThread]: Partial parsing: updated file: gyb_test_project://models\staging\stg_sales.sql
[0m13:54:54.356543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c096f324-b27e-4e15-a42a-3637615421cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023945B9E8F0>]}
[0m13:54:54.689967 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:54:54.695988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:54:54.752846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c096f324-b27e-4e15-a42a-3637615421cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023945B9E650>]}
[0m13:54:54.752846 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m13:54:54.755354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c096f324-b27e-4e15-a42a-3637615421cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023945B9E6E0>]}
[0m13:54:54.759866 [info ] [MainThread]: 
[0m13:54:54.761869 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:54.763874 [info ] [MainThread]: 
[0m13:54:54.763874 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:54.778417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:54:54.997805 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:54:54.997805 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:54:55.000312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:55.097854 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.098 seconds
[0m13:54:55.099865 [debug] [ThreadPool]: On list_postgres: Close
[0m13:54:55.107881 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:54:55.108386 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:54:55.110389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:55.202236 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.094 seconds
[0m13:54:55.206677 [debug] [ThreadPool]: On list_postgres: Close
[0m13:54:55.211445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m13:54:55.229966 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:54:55.230964 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m13:54:55.232470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:55.303263 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m13:54:55.305266 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:54:55.307270 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:54:55.320803 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m13:54:55.323732 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m13:54:55.323732 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m13:54:55.325736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m13:54:55.330249 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:54:55.332757 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m13:54:55.332757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:55.426663 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m13:54:55.428666 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:54:55.430670 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:54:55.441936 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m13:54:55.444443 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m13:54:55.446447 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m13:54:55.456476 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.458983 [debug] [MainThread]: On master: BEGIN
[0m13:54:55.458983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:55.540820 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m13:54:55.543326 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.543326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:54:55.558370 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m13:54:55.560877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c096f324-b27e-4e15-a42a-3637615421cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394479BA00>]}
[0m13:54:55.562879 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:55.563383 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.565387 [debug] [MainThread]: On master: BEGIN
[0m13:54:55.565387 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.567391 [debug] [MainThread]: On master: COMMIT
[0m13:54:55.567391 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.569638 [debug] [MainThread]: On master: COMMIT
[0m13:54:55.569638 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:55.571402 [debug] [MainThread]: On master: Close
[0m13:54:55.581412 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m13:54:55.582413 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_sales ........................... [RUN]
[0m13:54:55.585405 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m13:54:55.586910 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m13:54:55.609300 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m13:54:55.611304 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m13:54:55.706261 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m13:54:55.708256 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m13:54:55.709253 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m13:54:55.710744 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:54:55.791997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.081 seconds
[0m13:54:55.793498 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m13:54:55.795496 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (

    select
        /* базові текстові поля, заповнюємо 'N/A' */
        coalesce("ReferenceID"::varchar, 'N/A')          as reference_id,
        coalesce("Country"::varchar, 'N/A')              as country,
        coalesce("Product_Name"::varchar, 'N/A')         as product_name,
        coalesce("Sales_Agent_Name"::varchar, 'N/A')     as sales_agent_name,
        coalesce("Campaign_Name"::varchar, 'N/A')        as campaign_name,
        coalesce("Source"::varchar, 'N/A')               as source,

        /* числові поля */
        coalesce("Total_Amount"::numeric, 0)             as total_amount,
        coalesce("Discount_Amount"::numeric, 0)          as discount_amount,
        coalesce("Returned_Amount"::numeric, 0)          as returned_amount,
        coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
        coalesce("Original Amount"::numeric, 0)          as original_amount,
        coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,

        /* дати/час (якщо порожньо — NULL) */
        case when "Order_Date_Kyiv"  is null or "Order_Date_Kyiv" ::text = '' then null
             else "Order_Date_Kyiv"::timestamptz end       as order_date_kyiv_ts,

        case when "Return_Date_Kyiv" is null or "Return_Date_Kyiv"::text = '' then null
             else "Return_Date_Kyiv"::timestamptz end      as return_date_kyiv_ts,

        case when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null
             else "Last_Revill_Date_Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,

        /* прапорці */
        coalesce("Has_Chargeback"::boolean, false)        as has_chargeback,
        coalesce("Has_Refund"::boolean, false)            as has_refund

    from "postgres"."public_staging"."sales_data"
)

select * from raw;
  );
[0m13:54:55.798000 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 43: select * from raw;
                          ^

[0m13:54:55.799504 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m13:54:55.800501 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m13:54:55.808794 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 43: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m13:54:55.813795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c096f324-b27e-4e15-a42a-3637615421cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023941F19210>]}
[0m13:54:55.815790 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.22s]
[0m13:54:55.818095 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m13:54:55.820098 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 43: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m13:54:55.822103 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m13:54:55.824611 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.fct_sales .................................... [[33mSKIP[0m]
[0m13:54:55.824611 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m13:54:55.827119 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.829123 [debug] [MainThread]: On master: BEGIN
[0m13:54:55.829123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:55.905349 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m13:54:55.907353 [debug] [MainThread]: On master: COMMIT
[0m13:54:55.907353 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.909358 [debug] [MainThread]: On master: COMMIT
[0m13:54:55.909862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:55.911867 [debug] [MainThread]: On master: Close
[0m13:54:55.912371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:55.914380 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:54:55.915626 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m13:54:55.916623 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m13:54:55.917621 [info ] [MainThread]: 
[0m13:54:55.919126 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m13:54:55.920628 [debug] [MainThread]: Command end result
[0m13:54:55.974911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:54:55.982680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:54:55.995199 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m13:54:55.995703 [info ] [MainThread]: 
[0m13:54:55.995703 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:54:55.997526 [info ] [MainThread]: 
[0m13:54:55.998463 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m13:54:55.998463 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 43: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m13:54:55.998463 [info ] [MainThread]: 
[0m13:54:56.002492 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m13:54:56.003730 [info ] [MainThread]: 
[0m13:54:56.004723 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m13:54:56.006707 [debug] [MainThread]: Command `dbt run` failed at 13:54:56.004723 after 5.00 seconds
[0m13:54:56.006707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239430B0A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023945B9F6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023945B9E3E0>]}
[0m13:54:56.007984 [debug] [MainThread]: Flushing usage events
[0m13:54:56.584579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:16.701335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC7EB7CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC7FDA12A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC7FDA0E80>]}


============================== 13:56:16.712704 | ec8aa6f4-5a97-4d41-a756-3805815e16e0 ==============================
[0m13:56:16.712704 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:56:16.712704 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt clean', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:56:16.880248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec8aa6f4-5a97-4d41-a756-3805815e16e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC7FD6BF10>]}
[0m13:56:16.956562 [debug] [MainThread]: Command `dbt clean` succeeded at 13:56:16.956562 after 0.36 seconds
[0m13:56:16.956562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC7EB7CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC7FE31360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC7FE333A0>]}
[0m13:56:16.957566 [debug] [MainThread]: Flushing usage events
[0m13:56:17.702776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:22.380170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A7120AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A8333160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A83303D0>]}


============================== 13:56:22.380170 | f04f551c-2086-4b89-8544-3e6820e6ab62 ==============================
[0m13:56:22.380170 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:56:22.387123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt compile', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:56:22.615344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f04f551c-2086-4b89-8544-3e6820e6ab62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A73F5EA0>]}
[0m13:56:22.694541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f04f551c-2086-4b89-8544-3e6820e6ab62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A7ADFD30>]}
[0m13:56:22.694541 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:56:22.960025 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:56:22.960025 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:56:22.960025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f04f551c-2086-4b89-8544-3e6820e6ab62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A861E830>]}
[0m13:56:24.943884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f04f551c-2086-4b89-8544-3e6820e6ab62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A9C6BC70>]}
[0m13:56:25.099525 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:56:25.099525 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:56:25.133326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f04f551c-2086-4b89-8544-3e6820e6ab62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A9C486A0>]}
[0m13:56:25.133326 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m13:56:25.133326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04f551c-2086-4b89-8544-3e6820e6ab62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A9B709D0>]}
[0m13:56:25.141159 [info ] [MainThread]: 
[0m13:56:25.141159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:25.141159 [info ] [MainThread]: 
[0m13:56:25.141159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:25.148456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m13:56:25.208931 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:56:25.208931 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m13:56:25.208931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:25.357190 [debug] [ThreadPool]: SQL status: BEGIN in 0.137 seconds
[0m13:56:25.357190 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:56:25.357190 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:56:25.365727 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m13:56:25.365727 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m13:56:25.368895 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m13:56:25.368895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m13:56:25.368895 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:56:25.368895 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m13:56:25.368895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:25.404424 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m13:56:25.404424 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:56:25.405424 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:56:25.410582 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:56:25.411706 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m13:56:25.411706 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m13:56:25.411706 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:25.411706 [debug] [MainThread]: On master: BEGIN
[0m13:56:25.411706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:25.447226 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m13:56:25.447226 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:25.447226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:56:25.447226 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m13:56:25.459318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04f551c-2086-4b89-8544-3e6820e6ab62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A5A95750>]}
[0m13:56:25.459318 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:25.461320 [debug] [MainThread]: On master: Close
[0m13:56:25.461320 [debug] [Thread-1 (]: Began running node seed.gyb_test_project.sales_data
[0m13:56:25.461320 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.gyb_test_project.sales_data'
[0m13:56:25.461320 [debug] [Thread-1 (]: Began compiling node seed.gyb_test_project.sales_data
[0m13:56:25.461320 [debug] [Thread-1 (]: Began executing node seed.gyb_test_project.sales_data
[0m13:56:25.461320 [debug] [Thread-1 (]: Finished running node seed.gyb_test_project.sales_data
[0m13:56:25.475280 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m13:56:25.475280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.gyb_test_project.sales_data, now model.gyb_test_project.stg_sales)
[0m13:56:25.475280 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m13:56:25.475280 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m13:56:25.475280 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m13:56:25.475280 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m13:56:25.475280 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m13:56:25.475280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.gyb_test_project.stg_sales, now model.gyb_test_project.fct_sales)
[0m13:56:25.475280 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.fct_sales
[0m13:56:25.475280 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.fct_sales"
[0m13:56:25.475280 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.fct_sales
[0m13:56:25.475280 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m13:56:25.475280 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m13:56:25.491337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.gyb_test_project.fct_sales, now test.gyb_test_project.not_null_stg_sales_country.54818173bf)
[0m13:56:25.491337 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m13:56:25.491337 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_country.54818173bf"
[0m13:56:25.507231 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m13:56:25.508393 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m13:56:25.508393 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m13:56:25.509593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_country.54818173bf, now test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb)
[0m13:56:25.509593 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m13:56:25.515031 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb"
[0m13:56:25.516124 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m13:56:25.517163 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m13:56:25.517163 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m13:56:25.517163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb, now test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb)
[0m13:56:25.518639 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m13:56:25.520926 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb"
[0m13:56:25.525835 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m13:56:25.527576 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m13:56:25.527576 [debug] [Thread-1 (]: Began running node analysis.gyb_test_project.agent_performance
[0m13:56:25.527576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb, now analysis.gyb_test_project.agent_performance)
[0m13:56:25.527576 [debug] [Thread-1 (]: Began compiling node analysis.gyb_test_project.agent_performance
[0m13:56:25.532307 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.gyb_test_project.agent_performance"
[0m13:56:25.532307 [debug] [Thread-1 (]: Began executing node analysis.gyb_test_project.agent_performance
[0m13:56:25.534309 [debug] [Thread-1 (]: Finished running node analysis.gyb_test_project.agent_performance
[0m13:56:25.534309 [debug] [Thread-1 (]: Began running node analysis.gyb_test_project.discount_analysis
[0m13:56:25.534309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.gyb_test_project.agent_performance, now analysis.gyb_test_project.discount_analysis)
[0m13:56:25.534309 [debug] [Thread-1 (]: Began compiling node analysis.gyb_test_project.discount_analysis
[0m13:56:25.538722 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.gyb_test_project.discount_analysis"
[0m13:56:25.540724 [debug] [Thread-1 (]: Began executing node analysis.gyb_test_project.discount_analysis
[0m13:56:25.540724 [debug] [Thread-1 (]: Finished running node analysis.gyb_test_project.discount_analysis
[0m13:56:25.540724 [debug] [Thread-1 (]: Began running node analysis.gyb_test_project.revenue_growth
[0m13:56:25.542727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.gyb_test_project.discount_analysis, now analysis.gyb_test_project.revenue_growth)
[0m13:56:25.542727 [debug] [Thread-1 (]: Began compiling node analysis.gyb_test_project.revenue_growth
[0m13:56:25.546825 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.gyb_test_project.revenue_growth"
[0m13:56:25.546825 [debug] [Thread-1 (]: Began executing node analysis.gyb_test_project.revenue_growth
[0m13:56:25.546825 [debug] [Thread-1 (]: Finished running node analysis.gyb_test_project.revenue_growth
[0m13:56:25.549590 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312
[0m13:56:25.549590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.gyb_test_project.revenue_growth, now test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312)
[0m13:56:25.549590 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312
[0m13:56:25.555963 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312"
[0m13:56:25.557966 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312
[0m13:56:25.557966 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312
[0m13:56:25.557966 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34
[0m13:56:25.559968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312, now test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34)
[0m13:56:25.559968 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34
[0m13:56:25.564046 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34"
[0m13:56:25.566048 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34
[0m13:56:25.566048 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34
[0m13:56:25.567789 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m13:56:25.567789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34, now test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f)
[0m13:56:25.567789 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m13:56:25.572433 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m13:56:25.574435 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m13:56:25.574435 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m13:56:25.576438 [debug] [Thread-1 (]: Began running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m13:56:25.576438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f, now test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8)
[0m13:56:25.576438 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m13:56:25.584172 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m13:56:25.585207 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m13:56:25.586210 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m13:56:25.587630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:25.587630 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m13:56:25.588663 [debug] [MainThread]: Connection 'test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8' was properly closed.
[0m13:56:25.590733 [debug] [MainThread]: Command end result
[0m13:56:25.619212 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:56:25.622681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:56:25.630103 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m13:56:25.630103 [debug] [MainThread]: Command `dbt compile` succeeded at 13:56:25.630103 after 3.35 seconds
[0m13:56:25.630103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A73F5EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A9C493F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A9C4B0A0>]}
[0m13:56:25.630103 [debug] [MainThread]: Flushing usage events
[0m13:56:26.257448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:35.277045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05D3F0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F5D3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F5D1450>]}


============================== 13:56:35.281281 | bd269499-9f2a-408c-b053-9b6901225957 ==============================
[0m13:56:35.281281 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:56:35.281281 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m13:56:35.538365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd269499-9f2a-408c-b053-9b6901225957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05B8DC3D0>]}
[0m13:56:35.615883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd269499-9f2a-408c-b053-9b6901225957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F490910>]}
[0m13:56:35.615883 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:56:35.866423 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:56:36.130480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:36.130480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:36.240364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd269499-9f2a-408c-b053-9b6901225957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D060CE57E0>]}
[0m13:56:36.381496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:56:36.381496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:56:36.413781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd269499-9f2a-408c-b053-9b6901225957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D060D17250>]}
[0m13:56:36.415167 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m13:56:36.415167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd269499-9f2a-408c-b053-9b6901225957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D060D14AC0>]}
[0m13:56:36.443492 [info ] [MainThread]: 
[0m13:56:36.443492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:36.443492 [info ] [MainThread]: 
[0m13:56:36.443492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:36.459504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:56:36.542310 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:56:36.542310 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:56:36.543346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:36.568282 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.039 seconds
[0m13:56:36.584040 [debug] [ThreadPool]: On list_postgres: Close
[0m13:56:36.584040 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:56:36.584040 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:56:36.584040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:36.615490 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.033 seconds
[0m13:56:36.615490 [debug] [ThreadPool]: On list_postgres: Close
[0m13:56:36.615490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m13:56:36.615490 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:56:36.631300 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m13:56:36.631300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:36.661846 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m13:56:36.661846 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m13:56:36.661846 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:56:36.661846 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:56:36.661846 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m13:56:36.671973 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m13:56:36.671973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m13:56:36.671973 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:56:36.671973 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m13:56:36.671973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:36.705603 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m13:56:36.705603 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m13:56:36.705603 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:56:36.709586 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:56:36.709586 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m13:56:36.716835 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m13:56:36.716835 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:36.716835 [debug] [MainThread]: On master: BEGIN
[0m13:56:36.716835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:36.756962 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:56:36.756962 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:36.757996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:56:36.765280 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m13:56:36.766279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd269499-9f2a-408c-b053-9b6901225957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05B6A7D30>]}
[0m13:56:36.766279 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:36.767661 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:36.767661 [debug] [MainThread]: On master: BEGIN
[0m13:56:36.768789 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:56:36.768789 [debug] [MainThread]: On master: COMMIT
[0m13:56:36.769790 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:36.769790 [debug] [MainThread]: On master: COMMIT
[0m13:56:36.769790 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:36.771200 [debug] [MainThread]: On master: Close
[0m13:56:36.771200 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m13:56:36.771200 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_sales ........................... [RUN]
[0m13:56:36.771200 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m13:56:36.771200 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m13:56:36.785817 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m13:56:36.785817 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m13:56:36.828847 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m13:56:36.830850 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m13:56:36.830850 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m13:56:36.830850 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:56:36.868047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m13:56:36.868047 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m13:56:36.869049 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (
    select
        coalesce("ReferenceID"::varchar, 'N/A')          as reference_id,
        coalesce("Country"::varchar, 'N/A')              as country,
        coalesce("Product_Name"::varchar, 'N/A')         as product_name,
        coalesce("Sales_Agent_Name"::varchar, 'N/A')     as sales_agent_name,
        coalesce("Campaign_Name"::varchar, 'N/A')        as campaign_name,
        coalesce("Source"::varchar, 'N/A')               as source,
        coalesce("Total_Amount"::numeric, 0)             as total_amount,
        coalesce("Discount_Amount"::numeric, 0)          as discount_amount,
        coalesce("Returned_Amount"::numeric, 0)          as returned_amount,
        coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
        coalesce("Original Amount"::numeric, 0)          as original_amount,
        coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,
        case 
            when "Order_Date_Kyiv" is null or "Order_Date_Kyiv"::text = '' then null
            else "Order_Date_Kyiv"::timestamptz 
        end as order_date_kyiv_ts,
        case 
            when "Return_Date_Kyiv" is null or "Return_Date_Kyiv"::text = '' then null
            else "Return_Date_Kyiv"::timestamptz 
        end as return_date_kyiv_ts,
        case 
            when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null
            else "Last_Revill_Date_Kyiv"::timestamptz 
        end as last_rebill_date_kyiv_ts,
        coalesce("Has_Chargeback"::boolean, false)        as has_chargeback,
        coalesce("Has_Refund"::boolean, false)            as has_refund
    from "postgres"."public_staging"."sales_data"
)

select * from raw;
  );
[0m13:56:36.870051 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 38: select * from raw;
                          ^

[0m13:56:36.870051 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m13:56:36.871053 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m13:56:36.875358 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 38: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m13:56:36.877364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd269499-9f2a-408c-b053-9b6901225957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05ED5A860>]}
[0m13:56:36.878367 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.10s]
[0m13:56:36.879371 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m13:56:36.880374 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 38: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m13:56:36.880374 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m13:56:36.880374 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.fct_sales .................................... [[33mSKIP[0m]
[0m13:56:36.880374 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m13:56:36.880374 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:36.880374 [debug] [MainThread]: On master: BEGIN
[0m13:56:36.880374 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:37.027707 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m13:56:37.027707 [debug] [MainThread]: On master: COMMIT
[0m13:56:37.027707 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:37.027707 [debug] [MainThread]: On master: COMMIT
[0m13:56:37.027707 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:37.027707 [debug] [MainThread]: On master: Close
[0m13:56:37.027707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:37.027707 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:56:37.035963 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m13:56:37.035963 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m13:56:37.035963 [info ] [MainThread]: 
[0m13:56:37.035963 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m13:56:37.035963 [debug] [MainThread]: Command end result
[0m13:56:37.065134 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m13:56:37.067136 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m13:56:37.074884 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m13:56:37.076886 [info ] [MainThread]: 
[0m13:56:37.076886 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:56:37.076886 [info ] [MainThread]: 
[0m13:56:37.076886 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m13:56:37.076886 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 38: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m13:56:37.076886 [info ] [MainThread]: 
[0m13:56:37.076886 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m13:56:37.076886 [info ] [MainThread]: 
[0m13:56:37.076886 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m13:56:37.076886 [debug] [MainThread]: Command `dbt run` failed at 13:56:37.076886 after 1.91 seconds
[0m13:56:37.076886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05D3F0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D060CC9E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05E666110>]}
[0m13:56:37.084174 [debug] [MainThread]: Flushing usage events
[0m13:56:37.764318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:50.614702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4AB940A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ACB53610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ACB51270>]}


============================== 14:11:50.614702 | 48823971-20ea-4d37-998f-9f8268aac125 ==============================
[0m14:11:50.614702 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:11:50.614702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:11:50.835677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48823971-20ea-4d37-998f-9f8268aac125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ACBD3700>]}
[0m14:11:50.912931 [debug] [MainThread]: Command `dbt clean` succeeded at 14:11:50.911808 after 0.42 seconds
[0m14:11:50.912931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4AB940A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ACBD3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ACBE0AC0>]}
[0m14:11:50.913945 [debug] [MainThread]: Flushing usage events
[0m14:11:51.608466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:04.132628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24C5E0A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24E7CBF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24E7C88E0>]}


============================== 14:12:04.132628 | 6d7d61b7-b791-4535-947e-140a1f06a501 ==============================
[0m14:12:04.132628 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:12:04.143833 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:12:04.558592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d7d61b7-b791-4535-947e-140a1f06a501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24D8802B0>]}
[0m14:12:04.631440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d7d61b7-b791-4535-947e-140a1f06a501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24E6808E0>]}
[0m14:12:04.631440 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:12:05.086251 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:12:05.087441 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:12:05.087441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d7d61b7-b791-4535-947e-140a1f06a501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24EA3B880>]}
[0m14:12:08.329609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d7d61b7-b791-4535-947e-140a1f06a501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F250176C80>]}
[0m14:12:08.490446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:12:08.506323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:12:08.539226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d7d61b7-b791-4535-947e-140a1f06a501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2500BC280>]}
[0m14:12:08.540235 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:12:08.540235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d7d61b7-b791-4535-947e-140a1f06a501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25007F670>]}
[0m14:12:08.542287 [info ] [MainThread]: 
[0m14:12:08.543742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:08.543742 [info ] [MainThread]: 
[0m14:12:08.544891 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:08.551153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:12:11.814281 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:12:11.815283 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:12:11.816285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:11.865927 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m14:12:11.865927 [debug] [ThreadPool]: On list_postgres: Close
[0m14:12:11.865927 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:12:11.865927 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:12:11.865927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:11.918134 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m14:12:11.920387 [debug] [ThreadPool]: On list_postgres: Close
[0m14:12:11.922486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m14:12:11.929921 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:12:11.930915 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:12:11.930915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:12.069849 [debug] [ThreadPool]: SQL status: BEGIN in 0.150 seconds
[0m14:12:12.069849 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:12:12.069849 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:12:12.085562 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m14:12:12.085562 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:12:12.085562 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:12:12.085562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m14:12:12.085562 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:12:12.085562 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:12:12.085562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:12.146242 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m14:12:12.146242 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:12:12.146242 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:12:12.146242 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:12:12.146242 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:12:12.146242 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:12:12.163904 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:12.163904 [debug] [MainThread]: On master: BEGIN
[0m14:12:12.165906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:12.193438 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m14:12:12.193438 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:12.193438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:12:12.215095 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:12:12.217097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d7d61b7-b791-4535-947e-140a1f06a501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F250070A30>]}
[0m14:12:12.217097 [debug] [MainThread]: On master: ROLLBACK
[0m14:12:12.219101 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:12.219101 [debug] [MainThread]: On master: BEGIN
[0m14:12:12.219101 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:12:12.219101 [debug] [MainThread]: On master: COMMIT
[0m14:12:12.221103 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:12.221103 [debug] [MainThread]: On master: COMMIT
[0m14:12:12.221103 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:12:12.223105 [debug] [MainThread]: On master: Close
[0m14:12:12.224848 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:12:12.224848 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:12:12.224848 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:12:12.231114 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:12:12.243114 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:12:12.245109 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:12:12.272199 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:12:12.287833 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:12:12.287833 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:12:12.287833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:12.319983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m14:12:12.319983 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:12:12.319983 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (
    select
        coalesce("ReferenceID"::varchar, 'N/A')          as reference_id,
        coalesce("Country"::varchar, 'N/A')              as country,
        coalesce("Product_Name"::varchar, 'N/A')         as product_name,
        coalesce("Sales_Agent_Name"::varchar, 'N/A')     as sales_agent_name,
        coalesce("Campaign_Name"::varchar, 'N/A')        as campaign_name,
        coalesce("Source"::varchar, 'N/A')               as source,
        coalesce("Total_Amount"::numeric, 0)             as total_amount,
        coalesce("Discount_Amount"::numeric, 0)          as discount_amount,
        coalesce("Returned_Amount"::numeric, 0)          as returned_amount,
        coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
        coalesce("Original Amount"::numeric, 0)          as original_amount,
        coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,
        case 
            when "Order_Date_Kyiv" is null or "Order_Date_Kyiv"::text = '' then null
            else "Order_Date_Kyiv"::timestamptz 
        end as order_date_kyiv_ts,
        case 
            when "Return_Date_Kyiv" is null or "Return_Date_Kyiv"::text = '' then null
            else "Return_Date_Kyiv"::timestamptz 
        end as return_date_kyiv_ts,
        case 
            when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null
            else "Last_Revill_Date_Kyiv"::timestamptz 
        end as last_rebill_date_kyiv_ts,
        coalesce("Has_Chargeback"::boolean, false)        as has_chargeback,
        coalesce("Has_Refund"::boolean, false)            as has_refund
    from "postgres"."public_staging"."sales_data"
)

select * from raw;
  );
[0m14:12:12.319983 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 38: select * from raw;
                          ^

[0m14:12:12.319983 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:12:12.335851 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:12:12.474122 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 38: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:12:12.474122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d7d61b7-b791-4535-947e-140a1f06a501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24C419210>]}
[0m14:12:12.474122 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.25s]
[0m14:12:12.489812 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:12:12.489812 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 38: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:12:12.489812 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m14:12:12.489812 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.fct_sales .................................... [[33mSKIP[0m]
[0m14:12:12.489812 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m14:12:12.489812 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:12.489812 [debug] [MainThread]: On master: BEGIN
[0m14:12:12.489812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:12.536953 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m14:12:12.536953 [debug] [MainThread]: On master: COMMIT
[0m14:12:12.536953 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:12.536953 [debug] [MainThread]: On master: COMMIT
[0m14:12:12.536953 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:12:12.536953 [debug] [MainThread]: On master: Close
[0m14:12:12.536953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:12.536953 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:12:12.536953 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m14:12:12.536953 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:12:12.536953 [info ] [MainThread]: 
[0m14:12:12.536953 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m14:12:12.536953 [debug] [MainThread]: Command end result
[0m14:12:12.576253 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:12:12.579364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:12:12.583895 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:12:12.583895 [info ] [MainThread]: 
[0m14:12:12.583895 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:12:12.583895 [info ] [MainThread]: 
[0m14:12:12.583895 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:12:12.583895 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 38: select * from raw;
                            ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:12:12.583895 [info ] [MainThread]: 
[0m14:12:12.583895 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:12:12.583895 [info ] [MainThread]: 
[0m14:12:12.583895 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m14:12:12.583895 [debug] [MainThread]: Command `dbt run` failed at 14:12:12.583895 after 8.58 seconds
[0m14:12:12.583895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24C5E0A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F24D881570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F250298EB0>]}
[0m14:12:12.583895 [debug] [MainThread]: Flushing usage events
[0m14:12:13.271226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:48.317790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40E770A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40F981660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40F983E50>]}


============================== 14:14:48.317790 | c6001783-fcd7-4280-a6e8-cf09b70df46f ==============================
[0m14:14:48.317790 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:14:48.317790 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'printer_width': '80', 'write_json': 'True'}
[0m14:14:48.531175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6001783-fcd7-4280-a6e8-cf09b70df46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40FA06AD0>]}
[0m14:14:48.596336 [debug] [MainThread]: Command `dbt clean` succeeded at 14:14:48.596336 after 0.40 seconds
[0m14:14:48.596336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40E770A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40FA05A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40F9C5D50>]}
[0m14:14:48.596336 [debug] [MainThread]: Flushing usage events
[0m14:14:49.308564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:00.911936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD24DCB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD36F0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD36F1D50>]}


============================== 14:15:00.927619 | 8e9b0e83-0cec-44cd-939b-885ebe8261ef ==============================
[0m14:15:00.927619 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:15:00.927619 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s stg_sales', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:15:01.206452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e9b0e83-0cec-44cd-939b-885ebe8261ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD134A320>]}
[0m14:15:01.287573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e9b0e83-0cec-44cd-939b-885ebe8261ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD35B1030>]}
[0m14:15:01.287573 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:15:01.574650 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:15:01.584013 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:15:01.584013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e9b0e83-0cec-44cd-939b-885ebe8261ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD3A161D0>]}
[0m14:15:03.787933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e9b0e83-0cec-44cd-939b-885ebe8261ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD5161F30>]}
[0m14:15:03.959291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:15:03.959291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:15:03.992738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e9b0e83-0cec-44cd-939b-885ebe8261ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD4EE6FE0>]}
[0m14:15:03.994740 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:15:03.994740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e9b0e83-0cec-44cd-939b-885ebe8261ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD4EE48B0>]}
[0m14:15:03.994740 [info ] [MainThread]: 
[0m14:15:03.994740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:03.994740 [info ] [MainThread]: 
[0m14:15:03.994740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:03.994740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:15:04.100823 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:15:04.100823 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:15:04.100823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:04.164958 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m14:15:04.165992 [debug] [ThreadPool]: On list_postgres: Close
[0m14:15:04.172819 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m14:15:04.180319 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:15:04.181355 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:15:04.181355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:04.208610 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m14:15:04.208610 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:15:04.224717 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:15:04.224717 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:15:04.224717 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:15:04.224717 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:15:04.224717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m14:15:04.224717 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:15:04.224717 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:15:04.224717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:04.272374 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m14:15:04.272374 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:15:04.272374 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:15:04.288224 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:15:04.288224 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:15:04.288224 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:15:04.298344 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.298344 [debug] [MainThread]: On master: BEGIN
[0m14:15:04.298344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:04.335481 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m14:15:04.335481 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.335481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:15:04.351200 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:15:04.351200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e9b0e83-0cec-44cd-939b-885ebe8261ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD4FCCA60>]}
[0m14:15:04.359045 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:04.359045 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.359045 [debug] [MainThread]: On master: BEGIN
[0m14:15:04.359045 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:04.359045 [debug] [MainThread]: On master: COMMIT
[0m14:15:04.359045 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.359045 [debug] [MainThread]: On master: COMMIT
[0m14:15:04.363501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:04.363501 [debug] [MainThread]: On master: Close
[0m14:15:04.368913 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:15:04.370384 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:15:04.370384 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:15:04.371864 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:15:04.380839 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:15:04.380839 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:15:04.428400 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:15:04.428400 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:15:04.428400 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:15:04.428400 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:04.479185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m14:15:04.479185 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:15:04.480430 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    select
    coalesce("ReferenceID"::varchar, 'N/A')          as reference_id,
    coalesce("Country"::varchar, 'N/A')              as country,
    coalesce("Product_Name"::varchar, 'N/A')         as product_name,
    coalesce("Sales_Agent_Name"::varchar, 'N/A')     as sales_agent_name,
    coalesce("Campaign_Name"::varchar, 'N/A')        as campaign_name,
    coalesce("Source"::varchar, 'N/A')               as source,
    coalesce("Total_Amount"::numeric, 0)             as total_amount,
    coalesce("Discount_Amount"::numeric, 0)          as discount_amount,
    coalesce("Returned_Amount"::numeric, 0)          as returned_amount,
    coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
    coalesce("Original Amount"::numeric, 0)          as original_amount,
    coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,
    case when "Order_Date_Kyiv"       is null or "Order_Date_Kyiv"::text       = '' then null else "Order_Date_Kyiv"::timestamptz       end as order_date_kyiv_ts,
    case when "Return_Date_Kyiv"      is null or "Return_Date_Kyiv"::text      = '' then null else "Return_Date_Kyiv"::timestamptz      end as return_date_kyiv_ts,
    case when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null else "Last_Revill_Date_Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,
    coalesce("Has_Chargeback"::boolean, false)       as has_chargeback,
    coalesce("Has_Refund"::boolean, false)           as has_refund
from "postgres"."public_staging"."sales_data";
  );
[0m14:15:04.481515 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: from "postgres"."public_staging"."sales_data";
                                                      ^

[0m14:15:04.481515 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:15:04.482586 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:15:04.487116 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:15:04.489110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e9b0e83-0cec-44cd-939b-885ebe8261ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD502F100>]}
[0m14:15:04.489110 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.12s]
[0m14:15:04.489110 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:15:04.489110 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:15:04.489110 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.489110 [debug] [MainThread]: On master: BEGIN
[0m14:15:04.489110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:04.536474 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m14:15:04.536474 [debug] [MainThread]: On master: COMMIT
[0m14:15:04.536474 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.540467 [debug] [MainThread]: On master: COMMIT
[0m14:15:04.540467 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:04.540467 [debug] [MainThread]: On master: Close
[0m14:15:04.540467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:04.542809 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:15:04.542809 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m14:15:04.542809 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:15:04.542809 [info ] [MainThread]: 
[0m14:15:04.542809 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m14:15:04.542809 [debug] [MainThread]: Command end result
[0m14:15:04.579264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:15:04.582292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:15:04.591354 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:15:04.592359 [info ] [MainThread]: 
[0m14:15:04.593363 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:15:04.593363 [info ] [MainThread]: 
[0m14:15:04.594368 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:15:04.595372 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:15:04.596376 [info ] [MainThread]: 
[0m14:15:04.597384 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:15:04.597384 [info ] [MainThread]: 
[0m14:15:04.598388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:15:04.599392 [debug] [MainThread]: Command `dbt run` failed at 14:15:04.599392 after 3.79 seconds
[0m14:15:04.599392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD4F92170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD27B3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD3D7BCD0>]}
[0m14:15:04.599392 [debug] [MainThread]: Flushing usage events
[0m14:15:05.246541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:28.434257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133CCC00A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133CDE11660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133CDE13E50>]}


============================== 14:17:28.438425 | 993d492a-c27a-4f54-9f29-bd150fd3f7d2 ==============================
[0m14:17:28.438425 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:28.439465 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:17:28.649846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '993d492a-c27a-4f54-9f29-bd150fd3f7d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133CDE96AD0>]}
[0m14:17:28.709215 [debug] [MainThread]: Command `dbt clean` succeeded at 14:17:28.709215 after 0.40 seconds
[0m14:17:28.709215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133CCC00A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133CDE95A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133CDE61D50>]}
[0m14:17:28.709215 [debug] [MainThread]: Flushing usage events
[0m14:17:29.295473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:33.498165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F88E398B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8905801F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F890580880>]}


============================== 14:17:33.498165 | 90706763-6179-402f-ad2e-465ef4aaefb8 ==============================
[0m14:17:33.498165 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:17:33.505574 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt run -s stg_sales', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:17:33.942744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90706763-6179-402f-ad2e-465ef4aaefb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F88C87C4F0>]}
[0m14:17:34.020779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90706763-6179-402f-ad2e-465ef4aaefb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F88FD87A00>]}
[0m14:17:34.036517 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:17:34.476134 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:17:34.478137 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:17:34.478137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90706763-6179-402f-ad2e-465ef4aaefb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8907F7010>]}
[0m14:17:37.007832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90706763-6179-402f-ad2e-465ef4aaefb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8920431C0>]}
[0m14:17:37.191357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:17:37.197118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:17:37.228224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90706763-6179-402f-ad2e-465ef4aaefb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F891F9DCF0>]}
[0m14:17:37.228224 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:17:37.230227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90706763-6179-402f-ad2e-465ef4aaefb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F891F9C070>]}
[0m14:17:37.230227 [info ] [MainThread]: 
[0m14:17:37.230227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:37.230227 [info ] [MainThread]: 
[0m14:17:37.230227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:17:37.230227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:17:38.365597 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:17:38.365597 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:17:38.365597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:38.411895 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m14:17:38.411895 [debug] [ThreadPool]: On list_postgres: Close
[0m14:17:38.429611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m14:17:38.429611 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:17:38.429611 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:17:38.429611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:38.482774 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m14:17:38.482774 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:17:38.482774 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:17:38.493752 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:17:38.495918 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:17:38.496919 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:17:38.498030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m14:17:38.501512 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:17:38.502516 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:17:38.502516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:38.536716 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m14:17:38.536716 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:17:38.536716 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:17:38.559245 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:17:38.561247 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:17:38.561247 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:17:38.567193 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:38.568198 [debug] [MainThread]: On master: BEGIN
[0m14:17:38.568198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:38.611252 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m14:17:38.611252 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:38.612287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:17:38.620307 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m14:17:38.622545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90706763-6179-402f-ad2e-465ef4aaefb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F891E55570>]}
[0m14:17:38.622545 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:38.623580 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:38.624583 [debug] [MainThread]: On master: BEGIN
[0m14:17:38.625603 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:17:38.625603 [debug] [MainThread]: On master: COMMIT
[0m14:17:38.626662 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:38.626662 [debug] [MainThread]: On master: COMMIT
[0m14:17:38.627697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:38.627697 [debug] [MainThread]: On master: Close
[0m14:17:38.633032 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:17:38.634152 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:17:38.635190 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:17:38.635190 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:17:38.646161 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:17:38.648268 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:17:38.694969 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:17:38.698543 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:17:38.698543 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:17:38.699546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:38.740062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m14:17:38.740062 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:17:38.740062 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    select
    coalesce("ReferenceID"::varchar, 'N/A')          as reference_id,
    coalesce("Country"::varchar, 'N/A')              as country,
    coalesce("Product_Name"::varchar, 'N/A')         as product_name,
    coalesce("Sales_Agent_Name"::varchar, 'N/A')     as sales_agent_name,
    coalesce("Campaign_Name"::varchar, 'N/A')        as campaign_name,
    coalesce("Source"::varchar, 'N/A')               as source,
    coalesce("Total_Amount"::numeric, 0)             as total_amount,
    coalesce("Discount_Amount"::numeric, 0)          as discount_amount,
    coalesce("Returned_Amount"::numeric, 0)          as returned_amount,
    coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
    coalesce("Original Amount"::numeric, 0)          as original_amount,
    coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,
    case when "Order_Date_Kyiv"       is null or "Order_Date_Kyiv"::text       = '' then null else "Order_Date_Kyiv"::timestamptz       end as order_date_kyiv_ts,
    case when "Return_Date_Kyiv"      is null or "Return_Date_Kyiv"::text      = '' then null else "Return_Date_Kyiv"::timestamptz      end as return_date_kyiv_ts,
    case when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null else "Last_Revill_Date_Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,
    coalesce("Has_Chargeback"::boolean, false)       as has_chargeback,
    coalesce("Has_Refund"::boolean, false)           as has_refund
from "postgres"."public_staging"."sales_data";
  );
[0m14:17:38.740062 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: from "postgres"."public_staging"."sales_data";
                                                      ^

[0m14:17:38.740062 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:17:38.740062 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:17:38.864783 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:17:38.864783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90706763-6179-402f-ad2e-465ef4aaefb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F88E1D9CC0>]}
[0m14:17:38.864783 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.23s]
[0m14:17:38.864783 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:17:38.864783 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:17:38.864783 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:38.864783 [debug] [MainThread]: On master: BEGIN
[0m14:17:38.864783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:38.916488 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m14:17:38.916488 [debug] [MainThread]: On master: COMMIT
[0m14:17:38.917744 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:38.917744 [debug] [MainThread]: On master: COMMIT
[0m14:17:38.918781 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:38.918781 [debug] [MainThread]: On master: Close
[0m14:17:38.920002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:38.920002 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:17:38.921370 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m14:17:38.921370 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:17:38.921370 [info ] [MainThread]: 
[0m14:17:38.922725 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m14:17:38.923729 [debug] [MainThread]: Command end result
[0m14:17:38.954617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:17:38.958623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:17:38.967640 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:17:38.967640 [info ] [MainThread]: 
[0m14:17:38.967640 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:17:38.967640 [info ] [MainThread]: 
[0m14:17:38.967640 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:17:38.967640 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:17:38.967640 [info ] [MainThread]: 
[0m14:17:38.967640 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:17:38.967640 [info ] [MainThread]: 
[0m14:17:38.967640 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:17:38.975582 [debug] [MainThread]: Command `dbt run` failed at 14:17:38.975582 after 5.58 seconds
[0m14:17:38.975582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F88E398B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F891FD1F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F891D21720>]}
[0m14:17:38.975582 [debug] [MainThread]: Flushing usage events
[0m14:17:39.505427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:27.181761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E63EE0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E660D17B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E660D0E50>]}


============================== 14:24:27.185435 | ffd3f70e-d4a0-4086-bd36-9ad65a765c57 ==============================
[0m14:24:27.185435 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:24:27.186914 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'log_format': 'default', 'invocation_command': 'dbt clean', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:24:27.349972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffd3f70e-d4a0-4086-bd36-9ad65a765c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6615DE10>]}
[0m14:24:27.411569 [debug] [MainThread]: Command `dbt clean` succeeded at 14:24:27.411569 after 0.33 seconds
[0m14:24:27.411569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E63EE0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6615EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E6615E200>]}
[0m14:24:27.411569 [debug] [MainThread]: Flushing usage events
[0m14:24:28.022854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:31.741137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BF33CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C1522170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C1520BB0>]}


============================== 14:24:31.741137 | 654738d4-3b01-4af3-ab37-f560e1817d8f ==============================
[0m14:24:31.741137 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:24:31.746019 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt run -s stg_sales', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:24:31.959624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '654738d4-3b01-4af3-ab37-f560e1817d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C05E7A90>]}
[0m14:24:32.037051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '654738d4-3b01-4af3-ab37-f560e1817d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C13E0FD0>]}
[0m14:24:32.037051 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:24:32.271060 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:24:32.271060 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:24:32.271060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '654738d4-3b01-4af3-ab37-f560e1817d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C1845AE0>]}
[0m14:24:34.131101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '654738d4-3b01-4af3-ab37-f560e1817d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C2E5F4C0>]}
[0m14:24:34.255764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:24:34.281632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:24:34.301555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '654738d4-3b01-4af3-ab37-f560e1817d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C2D12D40>]}
[0m14:24:34.301555 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:24:34.301555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '654738d4-3b01-4af3-ab37-f560e1817d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C2E572E0>]}
[0m14:24:34.312109 [info ] [MainThread]: 
[0m14:24:34.312109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:34.312109 [info ] [MainThread]: 
[0m14:24:34.312109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:34.312109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:24:34.381255 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:24:34.381255 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:24:34.381255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:34.431959 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m14:24:34.433955 [debug] [ThreadPool]: On list_postgres: Close
[0m14:24:34.439232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m14:24:34.445347 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:24:34.445347 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:24:34.446494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:34.481280 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:24:34.482282 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:24:34.482282 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:24:34.489389 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:24:34.490388 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:24:34.490388 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:24:34.491770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m14:24:34.494975 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:24:34.494975 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:24:34.494975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:34.521809 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:24:34.521809 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:24:34.532470 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:24:34.538885 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:24:34.539934 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:24:34.539934 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:24:34.539934 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:34.539934 [debug] [MainThread]: On master: BEGIN
[0m14:24:34.539934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:34.677940 [debug] [MainThread]: SQL status: BEGIN in 0.141 seconds
[0m14:24:34.677940 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:34.677940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:24:34.693711 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:24:34.693711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '654738d4-3b01-4af3-ab37-f560e1817d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C2D13430>]}
[0m14:24:34.693711 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:34.693711 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:34.693711 [debug] [MainThread]: On master: BEGIN
[0m14:24:34.693711 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:24:34.693711 [debug] [MainThread]: On master: COMMIT
[0m14:24:34.693711 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:34.693711 [debug] [MainThread]: On master: COMMIT
[0m14:24:34.693711 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:34.693711 [debug] [MainThread]: On master: Close
[0m14:24:34.693711 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:24:34.693711 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:24:34.693711 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:24:34.693711 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:24:34.709474 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:24:34.709474 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:24:34.740616 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:24:34.756324 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:24:34.756324 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:24:34.756324 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:24:34.881034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.134 seconds
[0m14:24:34.881034 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:24:34.881034 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    select
    coalesce("ReferenceID"::varchar, 'N/A')          as reference_id,
    coalesce("Country"::varchar, 'N/A')              as country,
    coalesce("Product_Name"::varchar, 'N/A')         as product_name,
    coalesce("Sales_Agent_Name"::varchar, 'N/A')     as sales_agent_name,
    coalesce("Campaign_Name"::varchar, 'N/A')        as campaign_name,
    coalesce("Source"::varchar, 'N/A')               as source,
    coalesce("Total_Amount"::numeric, 0)             as total_amount,
    coalesce("Discount_Amount"::numeric, 0)          as discount_amount,
    coalesce("Returned_Amount"::numeric, 0)          as returned_amount,
    coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
    coalesce("Original Amount"::numeric, 0)          as original_amount,
    coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,
    case when "Order_Date_Kyiv"       is null or "Order_Date_Kyiv"::text       = '' then null else "Order_Date_Kyiv"::timestamptz       end as order_date_kyiv_ts,
    case when "Return_Date_Kyiv"      is null or "Return_Date_Kyiv"::text      = '' then null else "Return_Date_Kyiv"::timestamptz      end as return_date_kyiv_ts,
    case when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null else "Last_Revill_Date_Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,
    coalesce("Has_Chargeback"::boolean, false)       as has_chargeback,
    coalesce("Has_Refund"::boolean, false)           as has_refund
from "postgres"."public_staging"."sales_data";
  );
[0m14:24:34.881034 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: from "postgres"."public_staging"."sales_data";
                                                      ^

[0m14:24:34.881034 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:24:34.881034 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:24:34.898864 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:24:34.898864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '654738d4-3b01-4af3-ab37-f560e1817d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BF179540>]}
[0m14:24:34.898864 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.21s]
[0m14:24:34.898864 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:24:34.898864 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:24:34.898864 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:34.898864 [debug] [MainThread]: On master: BEGIN
[0m14:24:34.898864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:34.942036 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:24:34.943036 [debug] [MainThread]: On master: COMMIT
[0m14:24:34.943036 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:34.943036 [debug] [MainThread]: On master: COMMIT
[0m14:24:34.944838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:34.944838 [debug] [MainThread]: On master: Close
[0m14:24:34.945838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:34.945838 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:24:34.945838 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m14:24:34.946835 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:24:34.946835 [info ] [MainThread]: 
[0m14:24:34.947832 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m14:24:34.948847 [debug] [MainThread]: Command end result
[0m14:24:34.973915 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:24:34.976144 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:24:34.983982 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:24:34.983982 [info ] [MainThread]: 
[0m14:24:34.985098 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:24:34.986250 [info ] [MainThread]: 
[0m14:24:34.986250 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:24:34.987402 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 25: from "postgres"."public_staging"."sales_data";
                                                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:24:34.987402 [info ] [MainThread]: 
[0m14:24:34.988622 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:24:34.988622 [info ] [MainThread]: 
[0m14:24:34.989727 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:24:34.989727 [debug] [MainThread]: Command `dbt run` failed at 14:24:34.989727 after 3.34 seconds
[0m14:24:34.989727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C2D09CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BF35FD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148C05B4310>]}
[0m14:24:34.989727 [debug] [MainThread]: Flushing usage events
[0m14:24:35.520097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:45.630876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CCD0CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CEEF2170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CEEF08B0>]}


============================== 14:24:45.630876 | 46eae238-9fa7-45cc-b071-453b7cfb990d ==============================
[0m14:24:45.630876 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:24:45.637999 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'printer_width': '80', 'target_path': 'None'}
[0m14:24:45.786386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46eae238-9fa7-45cc-b071-453b7cfb990d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CEF73EE0>]}
[0m14:24:45.847279 [debug] [MainThread]: Command `dbt clean` succeeded at 14:24:45.847279 after 0.30 seconds
[0m14:24:45.848524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CCD0CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CEF72800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CEF81E40>]}
[0m14:24:45.849522 [debug] [MainThread]: Flushing usage events
[0m14:24:46.379888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:50.023431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA4666CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA47881660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA47881510>]}


============================== 14:24:50.037061 | e67f83df-bfec-4842-a2f3-51badf039a47 ==============================
[0m14:24:50.037061 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:24:50.037061 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s stg_sales', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:24:50.256053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e67f83df-bfec-4842-a2f3-51badf039a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA43B7C400>]}
[0m14:24:50.331507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e67f83df-bfec-4842-a2f3-51badf039a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA469232E0>]}
[0m14:24:50.333814 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:24:50.568700 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:24:50.568700 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:24:50.568700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e67f83df-bfec-4842-a2f3-51badf039a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA47AF50F0>]}
[0m14:24:52.431985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e67f83df-bfec-4842-a2f3-51badf039a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA490760B0>]}
[0m14:24:52.568699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:24:52.583471 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:24:52.610097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e67f83df-bfec-4842-a2f3-51badf039a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA4919DB10>]}
[0m14:24:52.612100 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:24:52.612100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e67f83df-bfec-4842-a2f3-51badf039a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA4919DB40>]}
[0m14:24:52.612100 [info ] [MainThread]: 
[0m14:24:52.612100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:52.616072 [info ] [MainThread]: 
[0m14:24:52.617209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:52.618163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:24:52.690827 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:24:52.690827 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:24:52.691863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:52.733758 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.042 seconds
[0m14:24:52.734758 [debug] [ThreadPool]: On list_postgres: Close
[0m14:24:52.739821 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m14:24:52.739821 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:24:52.739821 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:24:52.739821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:52.771172 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m14:24:52.771172 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:24:52.771172 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:24:52.787022 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:24:52.787022 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:24:52.787022 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:24:52.787022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m14:24:52.787022 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:24:52.787022 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:24:52.787022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:52.828731 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:24:52.828731 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:24:52.828731 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:24:52.839299 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:24:52.840299 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:24:52.841195 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:24:52.845491 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:52.845491 [debug] [MainThread]: On master: BEGIN
[0m14:24:52.846707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:52.880119 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:24:52.880119 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:52.880119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:24:52.880119 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:24:52.880119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e67f83df-bfec-4842-a2f3-51badf039a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA47FF46D0>]}
[0m14:24:52.880119 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:52.880119 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:52.880119 [debug] [MainThread]: On master: BEGIN
[0m14:24:52.880119 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:24:52.880119 [debug] [MainThread]: On master: COMMIT
[0m14:24:52.880119 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:52.880119 [debug] [MainThread]: On master: COMMIT
[0m14:24:52.880119 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:52.896270 [debug] [MainThread]: On master: Close
[0m14:24:52.897275 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:24:52.897275 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:24:52.897275 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:24:52.897275 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:24:52.910129 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:24:52.911870 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:24:52.950857 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:24:52.952905 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:24:52.953965 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:24:52.953965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:24:52.986036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m14:24:52.990445 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:24:52.990445 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    select
    coalesce("ReferenceID"::varchar, 'N/A')          as reference_id,
    coalesce("Country"::varchar, 'N/A')              as country,
    coalesce("Product_Name"::varchar, 'N/A')         as product_name,
    coalesce("Sales_Agent_Name"::varchar, 'N/A')     as sales_agent_name,
    coalesce("Campaign_Name"::varchar, 'N/A')        as campaign_name,
    coalesce("Source"::varchar, 'N/A')               as source,
    coalesce("Total_Amount"::numeric, 0)             as total_amount,
    coalesce("Discount_Amount"::numeric, 0)          as discount_amount,
    coalesce("Returned_Amount"::numeric, 0)          as returned_amount,
    coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
    coalesce("Original Amount"::numeric, 0)          as original_amount,
    coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,
    case when "Order_Date_Kyiv"       is null or "Order_Date_Kyiv"::text       = '' then null else "Order_Date_Kyiv"::timestamptz       end as order_date_kyiv_ts,
    case when "Return_Date_Kyiv"      is null or "Return_Date_Kyiv"::text      = '' then null else "Return_Date_Kyiv"::timestamptz      end as return_date_kyiv_ts,
    case when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null else "Last_Revill_Date_Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,
    coalesce("Has_Chargeback"::boolean, false)       as has_chargeback,
    coalesce("Has_Refund"::boolean, false)           as has_refund
from "postgres"."public_staging"."sales_data"
  );
[0m14:24:52.992997 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "ReferenceID" does not exist
LINE 8:     coalesce("ReferenceID"::varchar, 'N/A')          as refe...
                     ^
HINT:  Perhaps you meant to reference the column "sales_data.Reference ID".

[0m14:24:52.992997 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:24:52.992997 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:24:52.992997 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "ReferenceID" does not exist
  LINE 8:     coalesce("ReferenceID"::varchar, 'N/A')          as refe...
                       ^
  HINT:  Perhaps you meant to reference the column "sales_data.Reference ID".
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:24:52.992997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e67f83df-bfec-4842-a2f3-51badf039a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA47FF7DF0>]}
[0m14:24:53.006174 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.10s]
[0m14:24:53.006174 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:24:53.006174 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "ReferenceID" does not exist
  LINE 8:     coalesce("ReferenceID"::varchar, 'N/A')          as refe...
                       ^
  HINT:  Perhaps you meant to reference the column "sales_data.Reference ID".
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:24:53.006174 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:53.006174 [debug] [MainThread]: On master: BEGIN
[0m14:24:53.006174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:53.046250 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:24:53.046250 [debug] [MainThread]: On master: COMMIT
[0m14:24:53.046250 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:53.046250 [debug] [MainThread]: On master: COMMIT
[0m14:24:53.046250 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:53.046250 [debug] [MainThread]: On master: Close
[0m14:24:53.046250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:53.046250 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:24:53.050258 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m14:24:53.050258 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:24:53.050258 [info ] [MainThread]: 
[0m14:24:53.050258 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m14:24:53.050258 [debug] [MainThread]: Command end result
[0m14:24:53.067889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:24:53.067889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:24:53.083852 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:24:53.083852 [info ] [MainThread]: 
[0m14:24:53.083852 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:24:53.083852 [info ] [MainThread]: 
[0m14:24:53.083852 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:24:53.083852 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "ReferenceID" does not exist
  LINE 8:     coalesce("ReferenceID"::varchar, 'N/A')          as refe...
                       ^
  HINT:  Perhaps you meant to reference the column "sales_data.Reference ID".
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:24:53.083852 [info ] [MainThread]: 
[0m14:24:53.083852 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:24:53.083852 [info ] [MainThread]: 
[0m14:24:53.083852 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:24:53.083852 [debug] [MainThread]: Command `dbt run` failed at 14:24:53.083852 after 3.15 seconds
[0m14:24:53.083852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA44FEACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA46943CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA47F067D0>]}
[0m14:24:53.083852 [debug] [MainThread]: Flushing usage events
[0m14:24:53.615834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:44.271580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF65FB0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF68191660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF68193E50>]}


============================== 14:28:44.271580 | e37de52e-b755-4d74-b081-94bb37f800d2 ==============================
[0m14:28:44.271580 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:28:44.271580 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt clean', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:28:44.428440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e37de52e-b755-4d74-b081-94bb37f800d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF68216AD0>]}
[0m14:28:44.513488 [debug] [MainThread]: Command `dbt clean` succeeded at 14:28:44.513488 after 0.32 seconds
[0m14:28:44.514489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF65FB0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF68215A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF681DEC50>]}
[0m14:28:44.514489 [debug] [MainThread]: Flushing usage events
[0m14:28:45.103613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:49.176984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024610BFCAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024611E13910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024611E11630>]}


============================== 14:28:49.193077 | 234bfd0f-e8a9-45b6-81b4-bfd6b619c881 ==============================
[0m14:28:49.193077 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:28:49.193077 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run -s stg_sales', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:28:49.411986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '234bfd0f-e8a9-45b6-81b4-bfd6b619c881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024611FAAA10>]}
[0m14:28:49.486591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '234bfd0f-e8a9-45b6-81b4-bfd6b619c881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246115C2E30>]}
[0m14:28:49.488207 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:28:49.722774 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:28:49.723809 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:28:49.724843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '234bfd0f-e8a9-45b6-81b4-bfd6b619c881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024612137BB0>]}
[0m14:28:51.489814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '234bfd0f-e8a9-45b6-81b4-bfd6b619c881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024613745330>]}
[0m14:28:51.615702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:28:51.632821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:28:51.660501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '234bfd0f-e8a9-45b6-81b4-bfd6b619c881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002461382EEF0>]}
[0m14:28:51.660501 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:28:51.660501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '234bfd0f-e8a9-45b6-81b4-bfd6b619c881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002461373DE40>]}
[0m14:28:51.663230 [info ] [MainThread]: 
[0m14:28:51.663230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:51.663230 [info ] [MainThread]: 
[0m14:28:51.663230 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:51.663230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:28:51.724791 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:28:51.724791 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:28:51.724791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:51.772073 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.041 seconds
[0m14:28:51.772073 [debug] [ThreadPool]: On list_postgres: Close
[0m14:28:51.772073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m14:28:51.793584 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:28:51.793584 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:28:51.794622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:51.818773 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m14:28:51.818773 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:28:51.818773 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:28:51.834666 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:28:51.834666 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:28:51.834666 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:28:51.834666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m14:28:51.834666 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:28:51.834666 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:28:51.834666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:51.866827 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:28:51.866827 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:28:51.866827 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:28:51.887269 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:28:51.888268 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:28:51.889158 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:28:51.893471 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:51.893471 [debug] [MainThread]: On master: BEGIN
[0m14:28:51.894506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:51.927952 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:28:51.927952 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:51.927952 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:28:51.927952 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:28:51.927952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '234bfd0f-e8a9-45b6-81b4-bfd6b619c881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002461382DE10>]}
[0m14:28:51.927952 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:51.927952 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:51.927952 [debug] [MainThread]: On master: BEGIN
[0m14:28:51.927952 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:28:51.927952 [debug] [MainThread]: On master: COMMIT
[0m14:28:51.927952 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:51.927952 [debug] [MainThread]: On master: COMMIT
[0m14:28:51.943954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:51.943954 [debug] [MainThread]: On master: Close
[0m14:28:51.943954 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:28:51.943954 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:28:51.943954 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:28:51.943954 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:28:51.957104 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:28:51.959106 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:28:51.998710 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:28:52.000713 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:28:52.000713 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:28:52.000713 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:52.036614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m14:28:52.036614 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:28:52.036614 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    select
    coalesce("Reference ID"::varchar, 'N/A')          as reference_id,
    coalesce("Country"::varchar, 'N/A')              as country,
    coalesce("Product_Name"::varchar, 'N/A')         as product_name,
    coalesce("Sales_Agent_Name"::varchar, 'N/A')     as sales_agent_name,
    coalesce("Campaign_Name"::varchar, 'N/A')        as campaign_name,
    coalesce("Source"::varchar, 'N/A')               as source,
    coalesce("Total_Amount"::numeric, 0)             as total_amount,
    coalesce("Discount_Amount"::numeric, 0)          as discount_amount,
    coalesce("Returned_Amount"::numeric, 0)          as returned_amount,
    coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
    coalesce("Original Amount"::numeric, 0)          as original_amount,
    coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,
    case when "Order_Date_Kyiv"       is null or "Order_Date_Kyiv"::text       = '' then null else "Order_Date_Kyiv"::timestamptz       end as order_date_kyiv_ts,
    case when "Return_Date_Kyiv"      is null or "Return_Date_Kyiv"::text      = '' then null else "Return_Date_Kyiv"::timestamptz      end as return_date_kyiv_ts,
    case when "Last_Revill_Date_Kyiv" is null or "Last_Revill_Date_Kyiv"::text = '' then null else "Last_Revill_Date_Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,
    coalesce("Has_Chargeback"::boolean, false)       as has_chargeback,
    coalesce("Has_Refund"::boolean, false)           as has_refund
from "postgres"."public_staging"."sales_data"
  );
[0m14:28:52.036614 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Product_Name" does not exist
LINE 10:     coalesce("Product_Name"::varchar, 'N/A')         as prod...
                      ^
HINT:  Perhaps you meant to reference the column "sales_data.Product Name".

[0m14:28:52.036614 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:28:52.036614 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:28:52.052364 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Product_Name" does not exist
  LINE 10:     coalesce("Product_Name"::varchar, 'N/A')         as prod...
                        ^
  HINT:  Perhaps you meant to reference the column "sales_data.Product Name".
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:28:52.052364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '234bfd0f-e8a9-45b6-81b4-bfd6b619c881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024613881CC0>]}
[0m14:28:52.052364 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.11s]
[0m14:28:52.052364 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:28:52.052364 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Product_Name" does not exist
  LINE 10:     coalesce("Product_Name"::varchar, 'N/A')         as prod...
                        ^
  HINT:  Perhaps you meant to reference the column "sales_data.Product Name".
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:28:52.052364 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:52.052364 [debug] [MainThread]: On master: BEGIN
[0m14:28:52.052364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:52.099137 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m14:28:52.099137 [debug] [MainThread]: On master: COMMIT
[0m14:28:52.099137 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:52.099137 [debug] [MainThread]: On master: COMMIT
[0m14:28:52.099137 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:52.099137 [debug] [MainThread]: On master: Close
[0m14:28:52.099137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:52.099137 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:28:52.099137 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m14:28:52.099137 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:28:52.114956 [info ] [MainThread]: 
[0m14:28:52.114956 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m14:28:52.114956 [debug] [MainThread]: Command end result
[0m14:28:52.130764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:28:52.130764 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:28:52.146513 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:28:52.152025 [info ] [MainThread]: 
[0m14:28:52.152025 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:28:52.153033 [info ] [MainThread]: 
[0m14:28:52.153033 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:28:52.153033 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Product_Name" does not exist
  LINE 10:     coalesce("Product_Name"::varchar, 'N/A')         as prod...
                        ^
  HINT:  Perhaps you meant to reference the column "sales_data.Product Name".
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:28:52.153033 [info ] [MainThread]: 
[0m14:28:52.153033 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:28:52.153033 [info ] [MainThread]: 
[0m14:28:52.153033 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:28:52.153033 [debug] [MainThread]: Command `dbt run` failed at 14:28:52.153033 after 3.05 seconds
[0m14:28:52.153033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246136D6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024610ED3CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024612490F10>]}
[0m14:28:52.153033 [debug] [MainThread]: Flushing usage events
[0m14:28:52.676613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:12.470154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0F554CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0F6762EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0F6762C80>]}


============================== 14:43:12.475184 | 6b82295d-7314-4462-9668-347a16f1f926 ==============================
[0m14:43:12.475184 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:43:12.475184 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt clean', 'printer_width': '80', 'write_json': 'True'}
[0m14:43:12.632482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b82295d-7314-4462-9668-347a16f1f926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0F67630D0>]}
[0m14:43:12.712502 [debug] [MainThread]: Command `dbt clean` succeeded at 14:43:12.712502 after 0.33 seconds
[0m14:43:12.713540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0F554CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0F67630D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0F67E0DC0>]}
[0m14:43:12.713540 [debug] [MainThread]: Flushing usage events
[0m14:43:13.334887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:14.576299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C138AD0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13ACB15D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13ACB3250>]}


============================== 14:44:14.585827 | cf5e6a29-6eb4-4ede-b42e-f3bd6618070a ==============================
[0m14:44:14.585827 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:44:14.587568 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -s stg_sales', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:44:14.804100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf5e6a29-6eb4-4ede-b42e-f3bd6618070a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13AD155D0>]}
[0m14:44:14.864621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf5e6a29-6eb4-4ede-b42e-f3bd6618070a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13AAAFDF0>]}
[0m14:44:14.864621 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:44:15.098776 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:44:15.098776 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:44:15.098776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf5e6a29-6eb4-4ede-b42e-f3bd6618070a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13AFD94E0>]}
[0m14:44:16.872641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf5e6a29-6eb4-4ede-b42e-f3bd6618070a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13C574280>]}
[0m14:44:17.008551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:44:17.014082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:44:17.041475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf5e6a29-6eb4-4ede-b42e-f3bd6618070a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13B428CD0>]}
[0m14:44:17.041475 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:44:17.041475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf5e6a29-6eb4-4ede-b42e-f3bd6618070a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13C5CE530>]}
[0m14:44:17.041475 [info ] [MainThread]: 
[0m14:44:17.041475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:17.041475 [info ] [MainThread]: 
[0m14:44:17.041475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:17.041475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:44:17.115371 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:44:17.115371 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:44:17.115371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:17.255701 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.148 seconds
[0m14:44:17.271456 [debug] [ThreadPool]: On list_postgres: Close
[0m14:44:17.271456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m14:44:17.271456 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:44:17.271456 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:44:17.271456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:17.318991 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:44:17.318991 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:44:17.318991 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:44:17.318991 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:44:17.318991 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:44:17.318991 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:44:17.318991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m14:44:17.318991 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:44:17.318991 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:44:17.318991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:17.365545 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m14:44:17.365545 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:44:17.365545 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:44:17.365545 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:44:17.365545 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:44:17.376908 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:44:17.381253 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:17.381253 [debug] [MainThread]: On master: BEGIN
[0m14:44:17.381253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:17.417140 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:44:17.417140 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:17.417140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:44:17.417140 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:44:17.417140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf5e6a29-6eb4-4ede-b42e-f3bd6618070a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13885C610>]}
[0m14:44:17.417140 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:17.417140 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:17.428559 [debug] [MainThread]: On master: BEGIN
[0m14:44:17.428559 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:44:17.428559 [debug] [MainThread]: On master: COMMIT
[0m14:44:17.428559 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:17.428559 [debug] [MainThread]: On master: COMMIT
[0m14:44:17.431358 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:17.431358 [debug] [MainThread]: On master: Close
[0m14:44:17.431358 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:44:17.431358 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:44:17.431358 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:44:17.431358 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:44:17.444650 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:44:17.444650 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:44:17.484579 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:44:17.485883 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:44:17.486900 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:44:17.486900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:17.625308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m14:44:17.625308 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:44:17.625308 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    select
    coalesce("Reference ID"::varchar, 'N/A')          as reference_id,
    coalesce("Country"::varchar, 'N/A')              as country,
    coalesce("Product Name"::varchar, 'N/A')         as product_name,
    coalesce("Sales Agent Name"::varchar, 'N/A')     as sales_agent_name,
    coalesce("Campaign Name"::varchar, 'N/A')        as campaign_name,
    coalesce("Source"::varchar, 'N/A')               as source,
    coalesce("Total Amount"::numeric, 0)             as total_amount,
    coalesce("Discount Amount"::numeric, 0)          as discount_amount,
    coalesce("Returned Amount"::numeric, 0)          as returned_amount,
    coalesce("Number Of Rebills"::int, 0)            as number_of_rebills,
    coalesce("Original Amount"::numeric, 0)          as original_amount,
    coalesce("Total Rebill Amount"::numeric, 0)      as total_rebill_amount,
    case when "Order Date Kyiv"       is null or "Order Date Kyiv"::text       = '' then null else "Order Date Kyiv"::timestamptz       end as order_date_kyiv_ts,
    case when "Return Date Kyiv"      is null or "Return Date Kyiv"::text      = '' then null else "Return Date Kyiv"::timestamptz      end as return_date_kyiv_ts,
    case when "Last Revill Date Kyiv" is null or "Last Revill Date Kyiv"::text = '' then null else "Last Revill Date Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,
    coalesce("Has Chargeback"::boolean, false)       as has_chargeback,
    coalesce("Has Refund"::boolean, false)           as has_refund
from "postgres"."public_staging"."sales_data"
  );
[0m14:44:17.630150 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Total Amount" does not exist
LINE 14:     coalesce("Total Amount"::numeric, 0)             as tota...
                      ^

[0m14:44:17.630150 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:44:17.631888 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:44:17.635924 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Total Amount" does not exist
  LINE 14:     coalesce("Total Amount"::numeric, 0)             as tota...
                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:44:17.637926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5e6a29-6eb4-4ede-b42e-f3bd6618070a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13C582F80>]}
[0m14:44:17.637926 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.20s]
[0m14:44:17.637926 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:44:17.637926 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Total Amount" does not exist
  LINE 14:     coalesce("Total Amount"::numeric, 0)             as tota...
                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:44:17.637926 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:17.637926 [debug] [MainThread]: On master: BEGIN
[0m14:44:17.637926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:17.679786 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m14:44:17.680818 [debug] [MainThread]: On master: COMMIT
[0m14:44:17.680818 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:17.681816 [debug] [MainThread]: On master: COMMIT
[0m14:44:17.681816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:17.683181 [debug] [MainThread]: On master: Close
[0m14:44:17.683181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:17.684244 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:44:17.684244 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m14:44:17.685264 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:44:17.685264 [info ] [MainThread]: 
[0m14:44:17.686337 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m14:44:17.686337 [debug] [MainThread]: Command end result
[0m14:44:17.709310 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:44:17.709310 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:44:17.709310 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:44:17.709310 [info ] [MainThread]: 
[0m14:44:17.709310 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:44:17.709310 [info ] [MainThread]: 
[0m14:44:17.709310 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:44:17.709310 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Total Amount" does not exist
  LINE 14:     coalesce("Total Amount"::numeric, 0)             as tota...
                        ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:44:17.724977 [info ] [MainThread]: 
[0m14:44:17.724977 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:44:17.724977 [info ] [MainThread]: 
[0m14:44:17.724977 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:44:17.724977 [debug] [MainThread]: Command `dbt run` failed at 14:44:17.724977 after 3.23 seconds
[0m14:44:17.724977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C139D721A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13C49E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13B342E00>]}
[0m14:44:17.724977 [debug] [MainThread]: Flushing usage events
[0m14:44:18.311834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:09.428451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E544230A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E545441660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E545443E50>]}


============================== 14:50:09.444302 | fe84bb05-c8bb-42cb-b0c8-a3e766d09893 ==============================
[0m14:50:09.444302 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:50:09.444302 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt clean', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:50:09.598838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe84bb05-c8bb-42cb-b0c8-a3e766d09893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5454C2AD0>]}
[0m14:50:09.660619 [debug] [MainThread]: Command `dbt clean` succeeded at 14:50:09.660619 after 0.31 seconds
[0m14:50:09.660619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E544230A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5454C1A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E54548CC10>]}
[0m14:50:09.661664 [debug] [MainThread]: Flushing usage events
[0m14:50:10.224653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:21.560657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBE4ECB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC06D0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC06D1D50>]}


============================== 14:50:21.564374 | c1e34848-339b-4454-8c21-dac5acded872 ==============================
[0m14:50:21.564374 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:50:21.564374 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run -s stg_sales', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:50:21.780766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1e34848-339b-4454-8c21-dac5acded872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBE32A320>]}
[0m14:50:21.850323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1e34848-339b-4454-8c21-dac5acded872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC0591030>]}
[0m14:50:21.850323 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:50:22.100149 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:50:22.101224 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:22.102247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1e34848-339b-4454-8c21-dac5acded872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC09F61D0>]}
[0m14:50:23.956261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1e34848-339b-4454-8c21-dac5acded872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC2004D30>]}
[0m14:50:24.083777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:50:24.108817 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:50:24.136456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1e34848-339b-4454-8c21-dac5acded872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC1EBEB00>]}
[0m14:50:24.136456 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:50:24.136456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e34848-339b-4454-8c21-dac5acded872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC1EBC520>]}
[0m14:50:24.136456 [info ] [MainThread]: 
[0m14:50:24.136456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:24.136456 [info ] [MainThread]: 
[0m14:50:24.136456 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:24.136456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:50:24.211053 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:50:24.211053 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:50:24.211053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:24.255775 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m14:50:24.255775 [debug] [ThreadPool]: On list_postgres: Close
[0m14:50:24.255775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m14:50:24.271456 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:50:24.271456 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:50:24.271456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:24.312110 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m14:50:24.312110 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:50:24.313121 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:50:24.319833 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m14:50:24.320875 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:50:24.321988 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:50:24.322994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m14:50:24.325039 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:50:24.326362 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:50:24.326362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:24.351673 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m14:50:24.351673 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:50:24.351673 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:50:24.365436 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:50:24.365436 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:50:24.365436 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:50:24.365436 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:24.365436 [debug] [MainThread]: On master: BEGIN
[0m14:50:24.365436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:24.518013 [debug] [MainThread]: SQL status: BEGIN in 0.139 seconds
[0m14:50:24.518013 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:24.519013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:50:24.520325 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:50:24.520325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e34848-339b-4454-8c21-dac5acded872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC1DE52D0>]}
[0m14:50:24.520325 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:24.520325 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:24.520325 [debug] [MainThread]: On master: BEGIN
[0m14:50:24.520325 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:50:24.520325 [debug] [MainThread]: On master: COMMIT
[0m14:50:24.520325 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:24.520325 [debug] [MainThread]: On master: COMMIT
[0m14:50:24.520325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:24.520325 [debug] [MainThread]: On master: Close
[0m14:50:24.536264 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:50:24.536264 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:50:24.536264 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:50:24.536264 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:50:24.545749 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:50:24.547750 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:50:24.585264 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:50:24.587266 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:50:24.587266 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:50:24.587266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:24.626506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m14:50:24.626506 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:50:24.627541 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    -- models/staging/stg_sales.sql
select
    coalesce("Reference ID"::varchar, 'N/A')              as reference_id,
    coalesce("Country"::varchar, 'N/A')                   as country,
    coalesce("Product Code"::varchar, 'N/A')              as product_code,
    coalesce("Product Name"::varchar, 'N/A')              as product_name,
    coalesce("Sales Agent Name"::varchar, 'N/A')          as sales_agent_name,
    coalesce("Campaign Name"::varchar, 'N/A')             as campaign_name,
    coalesce("Source"::varchar, 'N/A')                    as source,

    coalesce("Total Amount ($)"::numeric, 0)              as total_amount,
    coalesce("Discount Amount ($)"::numeric, 0)           as discount_amount,
    coalesce("Returned Amount"::numeric, 0)               as returned_amount,
    coalesce("Number Of Rebills"::int, 0)                 as number_of_rebills,
    coalesce("Original Amount"::numeric, 0)               as original_amount,
    coalesce("Total Rebill Amount"::numeric, 0)           as total_rebill_amount,

    case when "Order Date Kyiv"  is null then null else "Order Date Kyiv"::timestamptz  end as order_date_kyiv_ts,
    case when "Return Date Kyiv" is null then null else "Return Date Kyiv"::timestamptz end as return_date_kyiv_ts,
    case when "Rebill Date Kyiv" is null then null else "Rebill Date Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,

    (lower(coalesce("Has Chargeback",'no')) = 'yes')      as has_chargeback,
    (lower(coalesce("Has Refund",'no')) = 'yes')          as has_refund
from "public_staging"."sales_data";
  );
[0m14:50:24.628558 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: from "public_staging"."sales_data";
                                           ^

[0m14:50:24.628558 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:50:24.628558 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:50:24.630025 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 30: from "public_staging"."sales_data";
                                             ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:50:24.630025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1e34848-339b-4454-8c21-dac5acded872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBE32BB50>]}
[0m14:50:24.630025 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.09s]
[0m14:50:24.630025 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:50:24.630025 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 30: from "public_staging"."sales_data";
                                             ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:50:24.630025 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:24.630025 [debug] [MainThread]: On master: BEGIN
[0m14:50:24.630025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:24.661615 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m14:50:24.661615 [debug] [MainThread]: On master: COMMIT
[0m14:50:24.661615 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:24.677527 [debug] [MainThread]: On master: COMMIT
[0m14:50:24.677527 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:24.677527 [debug] [MainThread]: On master: Close
[0m14:50:24.677527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:24.677527 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:50:24.677527 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m14:50:24.677527 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:50:24.677527 [info ] [MainThread]: 
[0m14:50:24.677527 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m14:50:24.677527 [debug] [MainThread]: Command end result
[0m14:50:24.693239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:50:24.710165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:50:24.717190 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:50:24.718193 [info ] [MainThread]: 
[0m14:50:24.718193 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:50:24.719367 [info ] [MainThread]: 
[0m14:50:24.719843 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:50:24.719843 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 30: from "public_staging"."sales_data";
                                             ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:50:24.720843 [info ] [MainThread]: 
[0m14:50:24.720843 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:50:24.721911 [info ] [MainThread]: 
[0m14:50:24.721911 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:50:24.723172 [debug] [MainThread]: Command `dbt run` failed at 14:50:24.723172 after 3.25 seconds
[0m14:50:24.724399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC1F70CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBF793CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEC0D5B160>]}
[0m14:50:24.724399 [debug] [MainThread]: Flushing usage events
[0m14:50:25.240604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:29.883759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04926CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04A483F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04A481F00>]}


============================== 14:55:29.888313 | 571e9ba9-b430-4c6b-8763-0028b4e0d818 ==============================
[0m14:55:29.888313 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:55:29.889192 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'printer_width': '80', 'target_path': 'None'}
[0m14:55:30.037748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '571e9ba9-b430-4c6b-8763-0028b4e0d818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A046778490>]}
[0m14:55:30.085593 [debug] [MainThread]: Command `dbt clean` succeeded at 14:55:30.085593 after 0.30 seconds
[0m14:55:30.085593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04926CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04A482C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04A513FA0>]}
[0m14:55:30.085593 [debug] [MainThread]: Flushing usage events
[0m14:55:30.677306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:36.428687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012853ACCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012854CE2E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012854CE0700>]}


============================== 14:55:36.428687 | 5d8efed7-e30a-4f78-b460-9c66d218f311 ==============================
[0m14:55:36.428687 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:55:36.435601 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s stg_sales', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:55:36.646513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d8efed7-e30a-4f78-b460-9c66d218f311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128544B9990>]}
[0m14:55:36.707873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d8efed7-e30a-4f78-b460-9c66d218f311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012854D6DF30>]}
[0m14:55:36.724639 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:55:36.959576 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:55:36.959576 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:55:36.959576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d8efed7-e30a-4f78-b460-9c66d218f311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285500B700>]}
[0m14:55:38.693564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d8efed7-e30a-4f78-b460-9c66d218f311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128564D4610>]}
[0m14:55:38.819821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:55:38.846375 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:55:38.873488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d8efed7-e30a-4f78-b460-9c66d218f311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128565FD3C0>]}
[0m14:55:38.873488 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m14:55:38.874694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8efed7-e30a-4f78-b460-9c66d218f311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128564D30A0>]}
[0m14:55:38.875782 [info ] [MainThread]: 
[0m14:55:38.875782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:38.877165 [info ] [MainThread]: 
[0m14:55:38.877165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:38.879657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:55:38.944394 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:55:38.944394 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:55:38.944394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:38.989575 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.041 seconds
[0m14:55:38.989575 [debug] [ThreadPool]: On list_postgres: Close
[0m14:55:38.994976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m14:55:39.005519 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:55:39.005519 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m14:55:39.005519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:39.037188 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m14:55:39.037188 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m14:55:39.037188 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:55:39.037188 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:55:39.037188 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m14:55:39.037188 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m14:55:39.037188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m14:55:39.053123 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:55:39.053123 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:55:39.053123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:39.092367 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m14:55:39.092367 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:55:39.093403 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:55:39.099206 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:55:39.101458 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:55:39.101458 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:55:39.106003 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.107000 [debug] [MainThread]: On master: BEGIN
[0m14:55:39.107000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:39.130414 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m14:55:39.130414 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.130414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:55:39.148504 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:55:39.148504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8efed7-e30a-4f78-b460-9c66d218f311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128565FC400>]}
[0m14:55:39.148504 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:39.148504 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.148504 [debug] [MainThread]: On master: BEGIN
[0m14:55:39.148504 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:55:39.148504 [debug] [MainThread]: On master: COMMIT
[0m14:55:39.148504 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.148504 [debug] [MainThread]: On master: COMMIT
[0m14:55:39.155584 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:39.155584 [debug] [MainThread]: On master: Close
[0m14:55:39.155584 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m14:55:39.155584 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m14:55:39.155584 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m14:55:39.155584 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m14:55:39.162518 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m14:55:39.162518 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m14:55:39.208126 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m14:55:39.209162 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:55:39.209162 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m14:55:39.209162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:39.240695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m14:55:39.240695 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m14:55:39.240695 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    

with raw as (

  select
      coalesce("Reference ID"::varchar, 'N/A')              as reference_id,
      coalesce("Country"::varchar, 'N/A')                   as country,
      coalesce("Product Code"::varchar, 'N/A')              as product_code,
      coalesce("Product Name"::varchar, 'N/A')              as product_name,
      coalesce("Sales Agent Name"::varchar, 'N/A')          as sales_agent_name,
      coalesce("Campaign Name"::varchar, 'N/A')             as campaign_name,
      coalesce("Source"::varchar, 'N/A')                    as source,

      /* числові */
      coalesce("Total Amount ($)"::numeric, 0)              as total_amount,
      coalesce("Discount Amount ($)"::numeric, 0)           as discount_amount,
      coalesce("Returned Amount"::numeric, 0)               as returned_amount,
      coalesce("Number Of Rebills"::int, 0)                 as number_of_rebills,
      coalesce("Original Amount"::numeric, 0)               as original_amount,
      coalesce("Total Rebill Amount"::numeric, 0)           as total_rebill_amount,

      /* дати (у seed — без TZ) => приводимо до timestamptz */
      case when "Order Date Kyiv"  is null then null else "Order Date Kyiv"::timestamptz  end as order_date_kyiv_ts,
      case when "Return Date Kyiv" is null then null else "Return Date Kyiv"::timestamptz end as return_date_kyiv_ts,
      case when "Rebill Date Kyiv" is null then null else "Rebill Date Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,

      /* текст Yes/No -> boolean */
      (lower(coalesce("Has Chargeback",'no')) = 'yes')      as has_chargeback,
      (lower(coalesce("Has Refund",'no')) = 'yes')          as has_refund

  from "postgres"."public_staging"."sales_data"

)

select * from raw
  );
[0m14:55:39.240695 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Returned Amount" does not exist
LINE 23:       coalesce("Returned Amount"::numeric, 0)               ...
                        ^

[0m14:55:39.240695 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m14:55:39.240695 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m14:55:39.240695 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Returned Amount" does not exist
  LINE 23:       coalesce("Returned Amount"::numeric, 0)               ...
                          ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:55:39.256515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8efed7-e30a-4f78-b460-9c66d218f311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128567B1360>]}
[0m14:55:39.256515 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.09s]
[0m14:55:39.256515 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m14:55:39.256515 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Returned Amount" does not exist
  LINE 23:       coalesce("Returned Amount"::numeric, 0)               ...
                          ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m14:55:39.256515 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.256515 [debug] [MainThread]: On master: BEGIN
[0m14:55:39.256515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:39.296467 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:55:39.296467 [debug] [MainThread]: On master: COMMIT
[0m14:55:39.296467 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:39.296467 [debug] [MainThread]: On master: COMMIT
[0m14:55:39.296467 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:39.296467 [debug] [MainThread]: On master: Close
[0m14:55:39.296467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:39.296467 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:55:39.296467 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m14:55:39.296467 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m14:55:39.296467 [info ] [MainThread]: 
[0m14:55:39.296467 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m14:55:39.296467 [debug] [MainThread]: Command end result
[0m14:55:39.318526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m14:55:39.318526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m14:55:39.334644 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m14:55:39.334644 [info ] [MainThread]: 
[0m14:55:39.334644 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:55:39.334644 [info ] [MainThread]: 
[0m14:55:39.334644 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m14:55:39.334644 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Returned Amount" does not exist
  LINE 23:       coalesce("Returned Amount"::numeric, 0)               ...
                          ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m14:55:39.334644 [info ] [MainThread]: 
[0m14:55:39.334644 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m14:55:39.334644 [info ] [MainThread]: 
[0m14:55:39.334644 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:55:39.334644 [debug] [MainThread]: Command `dbt run` failed at 14:55:39.334644 after 3.00 seconds
[0m14:55:39.334644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012853ACCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128553685B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285536B880>]}
[0m14:55:39.334644 [debug] [MainThread]: Flushing usage events
[0m14:55:39.864335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:43.415930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029904710A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299068F2F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299068F0880>]}


============================== 15:00:43.432072 | 94d9d624-6037-4c84-ba2d-7a4da0f92d21 ==============================
[0m15:00:43.432072 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:00:43.432072 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt clean', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:00:43.598886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94d9d624-6037-4c84-ba2d-7a4da0f92d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029906976230>]}
[0m15:00:43.656158 [debug] [MainThread]: Command `dbt clean` succeeded at 15:00:43.656158 after 0.32 seconds
[0m15:00:43.657160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029904710A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029906974070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029906980AF0>]}
[0m15:00:43.657160 [debug] [MainThread]: Flushing usage events
[0m15:00:44.240448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:48.522203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771ACDCAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771BEF3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771BEF1630>]}


============================== 15:00:48.522203 | 258ca7bc-230b-449c-aca7-1718840ef3f4 ==============================
[0m15:00:48.522203 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:00:48.526499 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt run -s stg_sales', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:00:48.741782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '258ca7bc-230b-449c-aca7-1718840ef3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771C08AA10>]}
[0m15:00:48.819292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '258ca7bc-230b-449c-aca7-1718840ef3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771B6A2E30>]}
[0m15:00:48.821269 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:00:49.068623 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:00:49.068623 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:00:49.068623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '258ca7bc-230b-449c-aca7-1718840ef3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771C21BBB0>]}
[0m15:00:50.944471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '258ca7bc-230b-449c-aca7-1718840ef3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771D825330>]}
[0m15:00:51.084473 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:00:51.088796 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:00:51.114100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '258ca7bc-230b-449c-aca7-1718840ef3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771D81B700>]}
[0m15:00:51.114100 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m15:00:51.114100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258ca7bc-230b-449c-aca7-1718840ef3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771D818D90>]}
[0m15:00:51.118049 [info ] [MainThread]: 
[0m15:00:51.118049 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:51.118049 [info ] [MainThread]: 
[0m15:00:51.118049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:51.118049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:00:51.197237 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:00:51.198241 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:00:51.198241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:51.239840 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.042 seconds
[0m15:00:51.239840 [debug] [ThreadPool]: On list_postgres: Close
[0m15:00:51.247043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m15:00:51.247043 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:00:51.247043 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:00:51.247043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:51.287428 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:00:51.287428 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:00:51.287428 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:00:51.287428 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:00:51.287428 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:00:51.287428 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:00:51.287428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m15:00:51.287428 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:00:51.287428 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:00:51.287428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:51.436655 [debug] [ThreadPool]: SQL status: BEGIN in 0.136 seconds
[0m15:00:51.436655 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:00:51.436655 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:00:51.444292 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:00:51.444292 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:00:51.448580 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:00:51.448580 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:51.448580 [debug] [MainThread]: On master: BEGIN
[0m15:00:51.448580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:51.475449 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m15:00:51.475449 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:51.475449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:00:51.491442 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m15:00:51.491442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258ca7bc-230b-449c-aca7-1718840ef3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771D946230>]}
[0m15:00:51.491442 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:51.491442 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:51.491442 [debug] [MainThread]: On master: BEGIN
[0m15:00:51.491442 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:00:51.491442 [debug] [MainThread]: On master: COMMIT
[0m15:00:51.491442 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:51.491442 [debug] [MainThread]: On master: COMMIT
[0m15:00:51.491442 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:00:51.491442 [debug] [MainThread]: On master: Close
[0m15:00:51.491442 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m15:00:51.507323 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m15:00:51.507323 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m15:00:51.507323 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m15:00:51.507323 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m15:00:51.507323 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m15:00:51.552481 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m15:00:51.552481 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:00:51.552481 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m15:00:51.552481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:51.693067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m15:00:51.693067 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:00:51.693067 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    

with raw as (

  select
      coalesce("Reference ID"::varchar, 'N/A')              as reference_id,
      coalesce("Country"::varchar, 'N/A')                   as country,
      coalesce("Product Code"::varchar, 'N/A')              as product_code,
      coalesce("Product Name"::varchar, 'N/A')              as product_name,
      coalesce("Sales Agent Name"::varchar, 'N/A')          as sales_agent_name,
      coalesce("Campaign Name"::varchar, 'N/A')             as campaign_name,
      coalesce("Source"::varchar, 'N/A')                    as source,

      /* числові */
      coalesce("Total Amount ($)"::numeric, 0)              as total_amount,
      coalesce("Discount Amount ($)"::numeric, 0)           as discount_amount,
      coalesce("Returned Amount ($)"::numeric, 0)               as returned_amount,
      coalesce("Number Of Rebills"::int, 0)                 as number_of_rebills,
      coalesce("Original Amount"::numeric, 0)               as original_amount,
      coalesce("Total Rebill Amount"::numeric, 0)           as total_rebill_amount,

      /* дати (у seed — без TZ) => приводимо до timestamptz */
      case when "Order Date Kyiv"  is null then null else "Order Date Kyiv"::timestamptz  end as order_date_kyiv_ts,
      case when "Return Date Kyiv" is null then null else "Return Date Kyiv"::timestamptz end as return_date_kyiv_ts,
      case when "Rebill Date Kyiv" is null then null else "Rebill Date Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,

      /* текст Yes/No -> boolean */
      (lower(coalesce("Has Chargeback",'no')) = 'yes')      as has_chargeback,
      (lower(coalesce("Has Refund",'no')) = 'yes')          as has_refund

  from "postgres"."public_staging"."sales_data"

)

select * from raw
  );
[0m15:00:51.693067 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Original Amount" does not exist
LINE 25:       coalesce("Original Amount"::numeric, 0)               ...
                        ^

[0m15:00:51.693067 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m15:00:51.693067 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m15:00:51.709064 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Original Amount" does not exist
  LINE 25:       coalesce("Original Amount"::numeric, 0)               ...
                          ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m15:00:51.709064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258ca7bc-230b-449c-aca7-1718840ef3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771C63F1C0>]}
[0m15:00:51.709064 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.20s]
[0m15:00:51.709064 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m15:00:51.709064 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Original Amount" does not exist
  LINE 25:       coalesce("Original Amount"::numeric, 0)               ...
                          ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m15:00:51.709064 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:51.709064 [debug] [MainThread]: On master: BEGIN
[0m15:00:51.709064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:51.754760 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m15:00:51.754760 [debug] [MainThread]: On master: COMMIT
[0m15:00:51.754760 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:51.754760 [debug] [MainThread]: On master: COMMIT
[0m15:00:51.758614 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:00:51.758614 [debug] [MainThread]: On master: Close
[0m15:00:51.758614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:51.758614 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:00:51.758614 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m15:00:51.758614 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m15:00:51.761545 [info ] [MainThread]: 
[0m15:00:51.761545 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m15:00:51.761545 [debug] [MainThread]: Command end result
[0m15:00:51.786416 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:00:51.786416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:00:51.786416 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:00:51.786416 [info ] [MainThread]: 
[0m15:00:51.786416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:00:51.786416 [info ] [MainThread]: 
[0m15:00:51.802143 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m15:00:51.802143 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Original Amount" does not exist
  LINE 25:       coalesce("Original Amount"::numeric, 0)               ...
                          ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m15:00:51.802143 [info ] [MainThread]: 
[0m15:00:51.802143 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m15:00:51.802143 [info ] [MainThread]: 
[0m15:00:51.802143 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:00:51.802143 [debug] [MainThread]: Command `dbt run` failed at 15:00:51.802143 after 3.38 seconds
[0m15:00:51.802143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771ACDCAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027718B5E140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002771AFB3CA0>]}
[0m15:00:51.808018 [debug] [MainThread]: Flushing usage events
[0m15:00:52.342761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:49.791591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0CD00A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DF132E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DF11630>]}


============================== 15:01:49.803568 | cf271946-b479-454b-b8d0-e06a9eeac1fd ==============================
[0m15:01:49.803568 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:01:49.804730 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'printer_width': '80', 'target_path': 'None'}
[0m15:01:49.959730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf271946-b479-454b-b8d0-e06a9eeac1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DFA2F80>]}
[0m15:01:50.024842 [debug] [MainThread]: Command `dbt clean` succeeded at 15:01:50.024842 after 0.32 seconds
[0m15:01:50.024842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0CD00A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DFA1C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0DFA2440>]}
[0m15:01:50.025842 [debug] [MainThread]: Flushing usage events
[0m15:01:50.599755 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:55.358957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDC300A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDD5126B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDD5114E0>]}


============================== 15:01:55.358957 | 5e0c309f-159b-4b8e-8f56-ed23fe1d4e25 ==============================
[0m15:01:55.358957 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:01:55.364139 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s stg_sales', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:01:55.584793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0c309f-159b-4b8e-8f56-ed23fe1d4e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDD5755D0>]}
[0m15:01:55.646820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e0c309f-159b-4b8e-8f56-ed23fe1d4e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDCCBD4B0>]}
[0m15:01:55.646820 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:01:55.896378 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:01:55.896378 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:01:55.896378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e0c309f-159b-4b8e-8f56-ed23fe1d4e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDD8020E0>]}
[0m15:01:57.678472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e0c309f-159b-4b8e-8f56-ed23fe1d4e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDEE4D5D0>]}
[0m15:01:57.801924 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:01:57.825558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:01:57.852357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e0c309f-159b-4b8e-8f56-ed23fe1d4e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDEE2E320>]}
[0m15:01:57.853377 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m15:01:57.853377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0c309f-159b-4b8e-8f56-ed23fe1d4e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDEE2C910>]}
[0m15:01:57.854770 [info ] [MainThread]: 
[0m15:01:57.855977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:57.856666 [info ] [MainThread]: 
[0m15:01:57.857229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:57.858553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:01:57.927820 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:01:57.927820 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:01:57.927820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:57.965882 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.042 seconds
[0m15:01:57.975568 [debug] [ThreadPool]: On list_postgres: Close
[0m15:01:57.975568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m15:01:57.975568 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:01:57.975568 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:01:57.975568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:58.021081 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:01:58.021081 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:01:58.021081 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:01:58.021081 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:01:58.021081 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:01:58.032563 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:01:58.032563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m15:01:58.036058 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:01:58.036058 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:01:58.037062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:58.068830 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:01:58.068830 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:01:58.068830 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:01:58.068830 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:01:58.068830 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:01:58.082391 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:01:58.084519 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:58.084519 [debug] [MainThread]: On master: BEGIN
[0m15:01:58.084519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:58.123114 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m15:01:58.123114 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:58.124498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:01:58.130569 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m15:01:58.130569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0c309f-159b-4b8e-8f56-ed23fe1d4e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDEE2F5B0>]}
[0m15:01:58.130569 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:58.130569 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:58.130569 [debug] [MainThread]: On master: BEGIN
[0m15:01:58.130569 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:01:58.130569 [debug] [MainThread]: On master: COMMIT
[0m15:01:58.130569 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:58.130569 [debug] [MainThread]: On master: COMMIT
[0m15:01:58.130569 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:58.130569 [debug] [MainThread]: On master: Close
[0m15:01:58.130569 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m15:01:58.130569 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m15:01:58.130569 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m15:01:58.130569 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m15:01:58.146701 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m15:01:58.146701 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m15:01:58.178378 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m15:01:58.194038 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:01:58.194038 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m15:01:58.194038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:58.319997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.134 seconds
[0m15:01:58.319997 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:01:58.319997 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    

with raw as (

  select
      coalesce("Reference ID"::varchar, 'N/A')              as reference_id,
      coalesce("Country"::varchar, 'N/A')                   as country,
      coalesce("Product Code"::varchar, 'N/A')              as product_code,
      coalesce("Product Name"::varchar, 'N/A')              as product_name,
      coalesce("Sales Agent Name"::varchar, 'N/A')          as sales_agent_name,
      coalesce("Campaign Name"::varchar, 'N/A')             as campaign_name,
      coalesce("Source"::varchar, 'N/A')                    as source,

      /* числові */
      coalesce("Total Amount ($)"::numeric, 0)              as total_amount,
      coalesce("Discount Amount ($)"::numeric, 0)           as discount_amount,
      coalesce("Returned Amount ($)"::numeric, 0)               as returned_amount,
      coalesce("Number Of Rebills"::int, 0)                 as number_of_rebills,
      coalesce("Original Amount ($)"::numeric, 0)               as original_amount,
      coalesce("Total Rebill Amount"::numeric, 0)           as total_rebill_amount,

      /* дати (у seed — без TZ) => приводимо до timestamptz */
      case when "Order Date Kyiv"  is null then null else "Order Date Kyiv"::timestamptz  end as order_date_kyiv_ts,
      case when "Return Date Kyiv" is null then null else "Return Date Kyiv"::timestamptz end as return_date_kyiv_ts,
      case when "Rebill Date Kyiv" is null then null else "Rebill Date Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,

      /* текст Yes/No -> boolean */
      (lower(coalesce("Has Chargeback",'no')) = 'yes')      as has_chargeback,
      (lower(coalesce("Has Refund",'no')) = 'yes')          as has_refund

  from "postgres"."public_staging"."sales_data"

)

select * from raw
  );
[0m15:01:58.341113 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Rebill Date Kyiv" does not exist
LINE 31:       case when "Rebill Date Kyiv" is null then null else "R...
                         ^

[0m15:01:58.342150 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: ROLLBACK
[0m15:01:58.342998 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m15:01:58.347654 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Rebill Date Kyiv" does not exist
  LINE 31:       case when "Rebill Date Kyiv" is null then null else "R...
                           ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m15:01:58.349724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0c309f-159b-4b8e-8f56-ed23fe1d4e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDEE2F580>]}
[0m15:01:58.350824 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_sales .................. [[31mERROR[0m in 0.22s]
[0m15:01:58.352050 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m15:01:58.352050 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Rebill Date Kyiv" does not exist
  LINE 31:       case when "Rebill Date Kyiv" is null then null else "R...
                           ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql.
[0m15:01:58.354242 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:58.354242 [debug] [MainThread]: On master: BEGIN
[0m15:01:58.355405 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:58.381562 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m15:01:58.381562 [debug] [MainThread]: On master: COMMIT
[0m15:01:58.381562 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:58.381562 [debug] [MainThread]: On master: COMMIT
[0m15:01:58.381562 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:58.381562 [debug] [MainThread]: On master: Close
[0m15:01:58.381562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:58.381562 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:01:58.381562 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m15:01:58.381562 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m15:01:58.381562 [info ] [MainThread]: 
[0m15:01:58.381562 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m15:01:58.381562 [debug] [MainThread]: Command end result
[0m15:01:58.414920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:01:58.414920 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:01:58.429076 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:01:58.429076 [info ] [MainThread]: 
[0m15:01:58.429076 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:01:58.429076 [info ] [MainThread]: 
[0m15:01:58.429076 [error] [MainThread]: [31mFailure in model stg_sales (models\staging\stg_sales.sql)[0m
[0m15:01:58.429076 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  column "Rebill Date Kyiv" does not exist
  LINE 31:       case when "Rebill Date Kyiv" is null then null else "R...
                           ^
  compiled code at target\run\gyb_test_project\models\staging\stg_sales.sql
[0m15:01:58.429076 [info ] [MainThread]: 
[0m15:01:58.429076 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\staging\stg_sales.sql
[0m15:01:58.429076 [info ] [MainThread]: 
[0m15:01:58.429076 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:01:58.429076 [debug] [MainThread]: Command `dbt run` failed at 15:01:58.429076 after 3.17 seconds
[0m15:01:58.429076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDC300A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDEDB3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCDC5A6110>]}
[0m15:01:58.429076 [debug] [MainThread]: Flushing usage events
[0m15:01:58.975848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:12.990214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B92FCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BA513F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BA511F00>]}


============================== 15:05:12.990214 | fc8f9b56-a3bc-4d28-b1b1-065cea10b149 ==============================
[0m15:05:12.990214 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:05:13.001140 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt clean', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:05:13.162728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc8f9b56-a3bc-4d28-b1b1-065cea10b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B688C490>]}
[0m15:05:13.208468 [debug] [MainThread]: Command `dbt clean` succeeded at 15:05:13.208468 after 0.32 seconds
[0m15:05:13.208468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B92FCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BA512C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9BA59E470>]}
[0m15:05:13.208468 [debug] [MainThread]: Flushing usage events
[0m15:05:13.809502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:17.427789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7F1FCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B004D2E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B004D0700>]}


============================== 15:05:17.427789 | 5bc77cff-ad3a-4a05-bbea-c5ab4b445a38 ==============================
[0m15:05:17.427789 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:05:17.427789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run -s stg_sales', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:05:17.662841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bc77cff-ad3a-4a05-bbea-c5ab4b445a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7FBE9990>]}
[0m15:05:17.725051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bc77cff-ad3a-4a05-bbea-c5ab4b445a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0055DF30>]}
[0m15:05:17.740913 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:05:17.958860 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:05:17.958860 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:05:17.958860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5bc77cff-ad3a-4a05-bbea-c5ab4b445a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B007FB700>]}
[0m15:05:19.770973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bc77cff-ad3a-4a05-bbea-c5ab4b445a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B01CD0A90>]}
[0m15:05:19.912054 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:05:19.918034 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:05:19.927878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bc77cff-ad3a-4a05-bbea-c5ab4b445a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B01CC2A40>]}
[0m15:05:19.927878 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m15:05:19.927878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc77cff-ad3a-4a05-bbea-c5ab4b445a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B01CC0AC0>]}
[0m15:05:19.943958 [info ] [MainThread]: 
[0m15:05:19.943958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:05:19.943958 [info ] [MainThread]: 
[0m15:05:19.943958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:19.943958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:05:20.005489 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:05:20.005489 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:05:20.021467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:20.163205 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.156 seconds
[0m15:05:20.163205 [debug] [ThreadPool]: On list_postgres: Close
[0m15:05:20.182944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m15:05:20.189522 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:05:20.190519 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:05:20.190519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:20.225776 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:05:20.225776 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:05:20.226815 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:05:20.226815 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:05:20.226815 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:05:20.235320 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:05:20.235320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m15:05:20.238885 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:05:20.238885 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:05:20.238885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:20.272090 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m15:05:20.272090 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:05:20.272090 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:05:20.283306 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:05:20.283306 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:05:20.283306 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:05:20.292327 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:20.292327 [debug] [MainThread]: On master: BEGIN
[0m15:05:20.292327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:20.333825 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m15:05:20.333825 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:20.333825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:05:20.349704 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m15:05:20.349704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc77cff-ad3a-4a05-bbea-c5ab4b445a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B01CC22F0>]}
[0m15:05:20.349704 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:20.349704 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:20.349704 [debug] [MainThread]: On master: BEGIN
[0m15:05:20.349704 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:05:20.349704 [debug] [MainThread]: On master: COMMIT
[0m15:05:20.349704 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:20.349704 [debug] [MainThread]: On master: COMMIT
[0m15:05:20.349704 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:20.349704 [debug] [MainThread]: On master: Close
[0m15:05:20.349704 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m15:05:20.349704 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_sales ........................... [RUN]
[0m15:05:20.349704 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m15:05:20.349704 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m15:05:20.365833 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m15:05:20.365833 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m15:05:20.412621 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m15:05:20.414837 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:05:20.414837 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m15:05:20.414837 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:20.444794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m15:05:20.444794 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:05:20.444794 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    

with raw as (

  select
      coalesce("Reference ID"::varchar, 'N/A')              as reference_id,
      coalesce("Country"::varchar, 'N/A')                   as country,
      coalesce("Product Code"::varchar, 'N/A')              as product_code,
      coalesce("Product Name"::varchar, 'N/A')              as product_name,
      coalesce("Sales Agent Name"::varchar, 'N/A')          as sales_agent_name,
      coalesce("Campaign Name"::varchar, 'N/A')             as campaign_name,
      coalesce("Source"::varchar, 'N/A')                    as source,

      /* числові */
      coalesce("Total Amount ($)"::numeric, 0)              as total_amount,
      coalesce("Discount Amount ($)"::numeric, 0)           as discount_amount,
      coalesce("Returned Amount ($)"::numeric, 0)               as returned_amount,
      coalesce("Number Of Rebills"::int, 0)                 as number_of_rebills,
      coalesce("Original Amount ($)"::numeric, 0)               as original_amount,
      coalesce("Total Rebill Amount"::numeric, 0)           as total_rebill_amount,

      /* дати (у seed — без TZ) => приводимо до timestamptz */
      case when "Order Date Kyiv"  is null then null else "Order Date Kyiv"::timestamptz  end as order_date_kyiv_ts,
      case when "Return Date Kyiv" is null then null else "Return Date Kyiv"::timestamptz end as return_date_kyiv_ts,
      case when "Last Rebill Date Kyiv" is null then null else "Last Rebill Date Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,

      /* текст Yes/No -> boolean */
      (lower(coalesce("Has Chargeback",'no')) = 'yes')      as has_chargeback,
      (lower(coalesce("Has Refund",'no')) = 'yes')          as has_refund

  from "postgres"."public_staging"."sales_data"

)

select * from raw
  );
[0m15:05:20.474279 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m15:05:20.474279 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:05:20.474279 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */
alter table "postgres"."public_staging"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m15:05:20.474279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:05:20.490311 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: COMMIT
[0m15:05:20.490311 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:05:20.490311 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: COMMIT
[0m15:05:20.506591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:05:20.512336 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_staging"."stg_sales__dbt_backup"
[0m15:05:20.516340 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:05:20.518342 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */
drop view if exists "postgres"."public_staging"."stg_sales__dbt_backup" cascade
[0m15:05:20.518342 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:05:20.523264 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m15:05:20.525728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc77cff-ad3a-4a05-bbea-c5ab4b445a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B00B44100>]}
[0m15:05:20.526728 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_sales ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m15:05:20.526728 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m15:05:20.528445 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:20.528445 [debug] [MainThread]: On master: BEGIN
[0m15:05:20.529444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:20.677600 [debug] [MainThread]: SQL status: BEGIN in 0.159 seconds
[0m15:05:20.677600 [debug] [MainThread]: On master: COMMIT
[0m15:05:20.677600 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:20.677600 [debug] [MainThread]: On master: COMMIT
[0m15:05:20.677600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:20.677600 [debug] [MainThread]: On master: Close
[0m15:05:20.677600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:20.677600 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:05:20.677600 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m15:05:20.677600 [debug] [MainThread]: Connection 'model.gyb_test_project.stg_sales' was properly closed.
[0m15:05:20.677600 [info ] [MainThread]: 
[0m15:05:20.693597 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m15:05:20.694276 [debug] [MainThread]: Command end result
[0m15:05:20.719542 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:05:20.721544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:05:20.728562 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:05:20.729565 [info ] [MainThread]: 
[0m15:05:20.730569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:20.730569 [info ] [MainThread]: 
[0m15:05:20.731337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:05:20.731885 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:20.731885 after 3.39 seconds
[0m15:05:20.732884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B01D707F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B01E0D330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B00B1ECB0>]}
[0m15:05:20.732884 [debug] [MainThread]: Flushing usage events
[0m15:05:21.388286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:07.054488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3FF3CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A41152C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A41153040>]}


============================== 15:18:07.060886 | efc78c51-3d05-44e7-81a8-8644ae444216 ==============================
[0m15:18:07.060886 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:18:07.061887 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt run -s fct_sales', 'printer_width': '80', 'target_path': 'None'}
[0m15:18:07.301805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efc78c51-3d05-44e7-81a8-8644ae444216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A401EEB00>]}
[0m15:18:07.372353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efc78c51-3d05-44e7-81a8-8644ae444216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A40213070>]}
[0m15:18:07.372353 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:18:07.653845 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:18:07.926417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:07.926417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:08.019108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efc78c51-3d05-44e7-81a8-8644ae444216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A428658D0>]}
[0m15:18:08.164258 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:18:08.167392 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:18:08.232234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efc78c51-3d05-44e7-81a8-8644ae444216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A417B15A0>]}
[0m15:18:08.232752 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m15:18:08.233852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc78c51-3d05-44e7-81a8-8644ae444216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3ED16110>]}
[0m15:18:08.235814 [info ] [MainThread]: 
[0m15:18:08.235814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:08.235814 [info ] [MainThread]: 
[0m15:18:08.237299 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:08.238543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:18:08.333166 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:18:08.333166 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:18:08.333166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:08.383923 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m15:18:08.385025 [debug] [ThreadPool]: On list_postgres: Close
[0m15:18:08.390084 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m15:18:08.392770 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:18:08.392770 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:18:08.392770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:08.436497 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m15:18:08.437746 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:18:08.437746 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:18:08.446216 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m15:18:08.447416 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:18:08.448461 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:18:08.449511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m15:18:08.452516 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:18:08.452516 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:18:08.452516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:08.491931 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m15:18:08.492965 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:18:08.492965 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:18:08.501537 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m15:18:08.502809 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:18:08.503862 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:18:08.507554 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:08.507554 [debug] [MainThread]: On master: BEGIN
[0m15:18:08.507554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:08.548864 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:18:08.548864 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:08.548864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:18:08.552738 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m15:18:08.552738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc78c51-3d05-44e7-81a8-8644ae444216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A408DA560>]}
[0m15:18:08.552738 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:08.562762 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:08.562762 [debug] [MainThread]: On master: BEGIN
[0m15:18:08.563782 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:18:08.563782 [debug] [MainThread]: On master: COMMIT
[0m15:18:08.565031 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:08.565031 [debug] [MainThread]: On master: COMMIT
[0m15:18:08.566352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:18:08.566352 [debug] [MainThread]: On master: Close
[0m15:18:08.573133 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m15:18:08.574133 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.fct_sales ............................. [RUN]
[0m15:18:08.574568 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.fct_sales'
[0m15:18:08.575571 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.fct_sales
[0m15:18:08.583619 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.fct_sales"
[0m15:18:08.583619 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.fct_sales
[0m15:18:08.628855 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.fct_sales"
[0m15:18:08.629860 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:18:08.630865 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: BEGIN
[0m15:18:08.630865 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:08.787985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m15:18:08.787985 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:18:08.789044 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */

  create view "postgres"."public_marts"."fct_sales__dbt_tmp"
    
    
  as (
    with base as (
    select
        reference_id,
        product_name,

        -- One sale can have multiple agents in the raw; aggregate names
        string_agg(distinct sales_agent_name, ', ' order by sales_agent_name) as agent_names,

        country,
        campaign_name,
        source,

        -- Revenue including rebills and refunds
        (coalesce(total_amount, 0) + coalesce(total_rebill_amount, 0) - coalesce(returned_amount, 0))::numeric as company_revenue,

        coalesce(total_rebill_amount, 0)::numeric as rebill_revenue,
        number_of_rebills,
        discount_amount,
        returned_amount,

        -- Dates and time zones
        order_date_kyiv_ts at time zone 'Europe/Kyiv' as order_datetime_kyiv,
        (order_date_kyiv_ts at time zone 'UTC') as order_datetime_utc,
        (order_date_kyiv_ts at time zone 'America/New_York') as order_datetime_ny,

        return_date_kyiv_ts at time zone 'Europe/Kyiv' as refund_datetime_kyiv,
        (return_date_kyiv_ts at time zone 'UTC') as refund_datetime_utc,
        (return_date_kyiv_ts at time zone 'America/New_York') as refund_datetime_ny,

        case
            when return_date_kyiv_ts is not null and order_date_kyiv_ts is not null
            then (date_trunc('day', return_date_kyiv_ts) - date_trunc('day', order_date_kyiv_ts))::int
            else null
        end as refund_days_diff

    from "postgres"."public_staging"."stg_sales"
    group by
        reference_id, product_name, country, campaign_name, source,
        total_amount, total_rebill_amount, returned_amount,
        number_of_rebills, discount_amount,
        order_date_kyiv_ts, return_date_kyiv_ts
)

select * from base;
  );
[0m15:18:08.792967 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 50: select * from base;
                           ^

[0m15:18:08.792967 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: ROLLBACK
[0m15:18:08.794007 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: Close
[0m15:18:08.797597 [debug] [Thread-1 (]: Database Error in model fct_sales (models\marts\fct_sales.sql)
  syntax error at or near ";"
  LINE 50: select * from base;
                             ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql
[0m15:18:08.800485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efc78c51-3d05-44e7-81a8-8644ae444216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A4287FA60>]}
[0m15:18:08.800485 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_marts.fct_sales .................... [[31mERROR[0m in 0.22s]
[0m15:18:08.801485 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m15:18:08.802730 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.fct_sales' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales (models\marts\fct_sales.sql)
  syntax error at or near ";"
  LINE 50: select * from base;
                             ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql.
[0m15:18:08.803767 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:08.803767 [debug] [MainThread]: On master: BEGIN
[0m15:18:08.803767 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:08.841601 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:18:08.841601 [debug] [MainThread]: On master: COMMIT
[0m15:18:08.842740 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:08.842740 [debug] [MainThread]: On master: COMMIT
[0m15:18:08.843919 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:18:08.843919 [debug] [MainThread]: On master: Close
[0m15:18:08.844918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:08.844918 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:18:08.844918 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m15:18:08.845916 [debug] [MainThread]: Connection 'model.gyb_test_project.fct_sales' was properly closed.
[0m15:18:08.845916 [info ] [MainThread]: 
[0m15:18:08.846913 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m15:18:08.847974 [debug] [MainThread]: Command end result
[0m15:18:08.868395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:18:08.868395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:18:08.887453 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:18:08.887453 [info ] [MainThread]: 
[0m15:18:08.888750 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:18:08.889748 [info ] [MainThread]: 
[0m15:18:08.890745 [error] [MainThread]: [31mFailure in model fct_sales (models\marts\fct_sales.sql)[0m
[0m15:18:08.890745 [error] [MainThread]:   Database Error in model fct_sales (models\marts\fct_sales.sql)
  syntax error at or near ";"
  LINE 50: select * from base;
                             ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql
[0m15:18:08.892149 [info ] [MainThread]: 
[0m15:18:08.892149 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\marts\fct_sales.sql
[0m15:18:08.893313 [info ] [MainThread]: 
[0m15:18:08.893313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:18:08.894444 [debug] [MainThread]: Command `dbt run` failed at 15:18:08.894444 after 1.94 seconds
[0m15:18:08.895684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3FF3CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3D4CC4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A411E85E0>]}
[0m15:18:08.895684 [debug] [MainThread]: Flushing usage events
[0m15:18:09.668835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:29.867380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194100DCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194112F2170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194112F08B0>]}


============================== 15:18:29.880898 | c9b2ae7c-886d-4c65-ab47-a5cb067116b4 ==============================
[0m15:18:29.880898 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:18:29.883342 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt clean', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:18:30.037714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9b2ae7c-886d-4c65-ab47-a5cb067116b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019411373EE0>]}
[0m15:18:30.115423 [debug] [MainThread]: Command `dbt clean` succeeded at 15:18:30.115423 after 0.33 seconds
[0m15:18:30.115423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194100DCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019411372800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019411381E40>]}
[0m15:18:30.115423 [debug] [MainThread]: Flushing usage events
[0m15:18:31.043057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:35.276366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024313D5CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024315F41660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024315F41510>]}


============================== 15:18:35.279901 | 16666732-909d-47b9-8842-d18b5088f17c ==============================
[0m15:18:35.279901 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:18:35.281386 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s fct_sales', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:18:35.508265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16666732-909d-47b9-8842-d18b5088f17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002431224C400>]}
[0m15:18:35.584194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16666732-909d-47b9-8842-d18b5088f17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024314FE32E0>]}
[0m15:18:35.584194 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:18:35.817650 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:18:35.817650 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:18:35.817650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '16666732-909d-47b9-8842-d18b5088f17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243161B50F0>]}
[0m15:18:37.704856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16666732-909d-47b9-8842-d18b5088f17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024317739990>]}
[0m15:18:37.841783 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:18:37.846219 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:18:37.865284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16666732-909d-47b9-8842-d18b5088f17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024317862470>]}
[0m15:18:37.865284 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m15:18:37.865284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16666732-909d-47b9-8842-d18b5088f17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243178624A0>]}
[0m15:18:37.865284 [info ] [MainThread]: 
[0m15:18:37.865284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:37.865284 [info ] [MainThread]: 
[0m15:18:37.865284 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:37.865284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:18:37.942837 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:18:37.942837 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:18:37.942837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:37.990888 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.041 seconds
[0m15:18:37.990888 [debug] [ThreadPool]: On list_postgres: Close
[0m15:18:37.990888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m15:18:38.006563 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:18:38.006563 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:18:38.006563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:38.044301 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:18:38.044301 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:18:38.045302 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:18:38.051128 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:18:38.052370 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:18:38.052370 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:18:38.052370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m15:18:38.052370 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:18:38.052370 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:18:38.052370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:38.083837 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m15:18:38.083837 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:18:38.083837 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:18:38.099484 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:18:38.099484 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:18:38.099484 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:18:38.107138 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:38.107138 [debug] [MainThread]: On master: BEGIN
[0m15:18:38.107138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:38.142402 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:18:38.142402 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:38.147168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:18:38.154261 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m15:18:38.155260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16666732-909d-47b9-8842-d18b5088f17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243166B8D90>]}
[0m15:18:38.156257 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:38.156857 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:38.156857 [debug] [MainThread]: On master: BEGIN
[0m15:18:38.157987 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:18:38.157987 [debug] [MainThread]: On master: COMMIT
[0m15:18:38.157987 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:38.159020 [debug] [MainThread]: On master: COMMIT
[0m15:18:38.159866 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:18:38.159866 [debug] [MainThread]: On master: Close
[0m15:18:38.161959 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m15:18:38.161959 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.fct_sales ............................. [RUN]
[0m15:18:38.161959 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.fct_sales'
[0m15:18:38.161959 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.fct_sales
[0m15:18:38.173162 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.fct_sales"
[0m15:18:38.175164 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.fct_sales
[0m15:18:38.215464 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.fct_sales"
[0m15:18:38.217466 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:18:38.217466 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: BEGIN
[0m15:18:38.217466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:38.256265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:18:38.257359 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:18:38.257359 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */

  create view "postgres"."public_marts"."fct_sales__dbt_tmp"
    
    
  as (
    with base as (
    select
        reference_id,
        product_name,

        -- One sale can have multiple agents in the raw; aggregate names
        string_agg(distinct sales_agent_name, ', ' order by sales_agent_name) as agent_names,

        country,
        campaign_name,
        source,

        -- Revenue including rebills and refunds
        (coalesce(total_amount, 0) + coalesce(total_rebill_amount, 0) - coalesce(returned_amount, 0))::numeric as company_revenue,

        coalesce(total_rebill_amount, 0)::numeric as rebill_revenue,
        number_of_rebills,
        discount_amount,
        returned_amount,

        -- Dates and time zones
        order_date_kyiv_ts at time zone 'Europe/Kyiv' as order_datetime_kyiv,
        (order_date_kyiv_ts at time zone 'UTC') as order_datetime_utc,
        (order_date_kyiv_ts at time zone 'America/New_York') as order_datetime_ny,

        return_date_kyiv_ts at time zone 'Europe/Kyiv' as refund_datetime_kyiv,
        (return_date_kyiv_ts at time zone 'UTC') as refund_datetime_utc,
        (return_date_kyiv_ts at time zone 'America/New_York') as refund_datetime_ny,

        case
            when return_date_kyiv_ts is not null and order_date_kyiv_ts is not null
            then (date_trunc('day', return_date_kyiv_ts) - date_trunc('day', order_date_kyiv_ts))::int
            else null
        end as refund_days_diff

    from "postgres"."public_staging"."stg_sales"
    group by
        reference_id, product_name, country, campaign_name, source,
        total_amount, total_rebill_amount, returned_amount,
        number_of_rebills, discount_amount,
        order_date_kyiv_ts, return_date_kyiv_ts
)

select * from base
  );
[0m15:18:38.264176 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cannot cast type interval to integer
LINE 38: ..._date_kyiv_ts) - date_trunc('day', order_date_kyiv_ts))::int
                                                                   ^

[0m15:18:38.265213 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: ROLLBACK
[0m15:18:38.265213 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: Close
[0m15:18:38.268464 [debug] [Thread-1 (]: Database Error in model fct_sales (models\marts\fct_sales.sql)
  cannot cast type interval to integer
  LINE 38: ..._date_kyiv_ts) - date_trunc('day', order_date_kyiv_ts))::int
                                                                     ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql
[0m15:18:38.270552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16666732-909d-47b9-8842-d18b5088f17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243178637C0>]}
[0m15:18:38.270552 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_marts.fct_sales .................... [[31mERROR[0m in 0.11s]
[0m15:18:38.270552 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m15:18:38.270552 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.fct_sales' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales (models\marts\fct_sales.sql)
  cannot cast type interval to integer
  LINE 38: ..._date_kyiv_ts) - date_trunc('day', order_date_kyiv_ts))::int
                                                                     ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql.
[0m15:18:38.270552 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:38.270552 [debug] [MainThread]: On master: BEGIN
[0m15:18:38.270552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:38.313679 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m15:18:38.313679 [debug] [MainThread]: On master: COMMIT
[0m15:18:38.314747 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:38.315066 [debug] [MainThread]: On master: COMMIT
[0m15:18:38.315519 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:18:38.315519 [debug] [MainThread]: On master: Close
[0m15:18:38.315519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:38.315519 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:18:38.315519 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m15:18:38.318776 [debug] [MainThread]: Connection 'model.gyb_test_project.fct_sales' was properly closed.
[0m15:18:38.318776 [info ] [MainThread]: 
[0m15:18:38.319847 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:18:38.319847 [debug] [MainThread]: Command end result
[0m15:18:38.339286 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:18:38.339286 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:18:38.356140 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:18:38.357297 [info ] [MainThread]: 
[0m15:18:38.357297 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:18:38.358299 [info ] [MainThread]: 
[0m15:18:38.358299 [error] [MainThread]: [31mFailure in model fct_sales (models\marts\fct_sales.sql)[0m
[0m15:18:38.359780 [error] [MainThread]:   Database Error in model fct_sales (models\marts\fct_sales.sql)
  cannot cast type interval to integer
  LINE 38: ..._date_kyiv_ts) - date_trunc('day', order_date_kyiv_ts))::int
                                                                     ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql
[0m15:18:38.359780 [info ] [MainThread]: 
[0m15:18:38.360782 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\marts\fct_sales.sql
[0m15:18:38.361637 [info ] [MainThread]: 
[0m15:18:38.362154 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:18:38.362680 [debug] [MainThread]: Command `dbt run` failed at 15:18:38.362680 after 3.18 seconds
[0m15:18:38.363686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243136AECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024315003CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243165C02B0>]}
[0m15:18:38.363686 [debug] [MainThread]: Flushing usage events
[0m15:18:39.062710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:24.412258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5DE20A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F0317B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F030E50>]}


============================== 15:19:24.412258 | e536ef27-198f-446d-a527-1981cc2348f4 ==============================
[0m15:19:24.412258 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:19:24.424126 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt clean', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:19:24.592232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e536ef27-198f-446d-a527-1981cc2348f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F0BDE10>]}
[0m15:19:24.646828 [debug] [MainThread]: Command `dbt clean` succeeded at 15:19:24.646828 after 0.32 seconds
[0m15:19:24.646828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5DE20A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F0BEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E5F0BE200>]}
[0m15:19:24.646828 [debug] [MainThread]: Flushing usage events
[0m15:19:25.326255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:29.614805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE0E94A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE303BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE303B340>]}


============================== 15:19:29.614805 | 5f02e330-97d0-4610-8732-d585c5b2ee20 ==============================
[0m15:19:29.614805 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:19:29.624965 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'write_json': 'True', 'invocation_command': 'dbt run -s fct_sales', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:19:29.832986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f02e330-97d0-4610-8732-d585c5b2ee20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE21302B0>]}
[0m15:19:29.921861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f02e330-97d0-4610-8732-d585c5b2ee20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE30FB730>]}
[0m15:19:29.924150 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:19:30.161619 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:19:30.161619 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:19:30.161619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f02e330-97d0-4610-8732-d585c5b2ee20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE3360D30>]}
[0m15:19:32.019074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f02e330-97d0-4610-8732-d585c5b2ee20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE49A8700>]}
[0m15:19:32.158816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:19:32.163301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:19:32.178245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f02e330-97d0-4610-8732-d585c5b2ee20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE49AD960>]}
[0m15:19:32.178245 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m15:19:32.178245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f02e330-97d0-4610-8732-d585c5b2ee20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE498DCC0>]}
[0m15:19:32.178245 [info ] [MainThread]: 
[0m15:19:32.178245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:32.178245 [info ] [MainThread]: 
[0m15:19:32.193904 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:19:32.193904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:19:32.265412 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:19:32.265412 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:19:32.265412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:32.302154 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.042 seconds
[0m15:19:32.302154 [debug] [ThreadPool]: On list_postgres: Close
[0m15:19:32.302154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m15:19:32.323442 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:19:32.323442 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:19:32.323442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:32.349169 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:19:32.349169 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:19:32.349169 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:19:32.365049 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:19:32.365049 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:19:32.365049 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:19:32.365049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m15:19:32.365049 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:19:32.365049 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:19:32.365049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:32.397241 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m15:19:32.397241 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:19:32.397241 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:19:32.413159 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m15:19:32.413159 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:19:32.413159 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:19:32.413159 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:32.413159 [debug] [MainThread]: On master: BEGIN
[0m15:19:32.413159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:32.458973 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m15:19:32.458973 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:32.458973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:19:32.458973 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m15:19:32.458973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f02e330-97d0-4610-8732-d585c5b2ee20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE499A050>]}
[0m15:19:32.458973 [debug] [MainThread]: On master: ROLLBACK
[0m15:19:32.458973 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:32.458973 [debug] [MainThread]: On master: BEGIN
[0m15:19:32.458973 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:19:32.474780 [debug] [MainThread]: On master: COMMIT
[0m15:19:32.474780 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:32.474780 [debug] [MainThread]: On master: COMMIT
[0m15:19:32.474780 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:19:32.474780 [debug] [MainThread]: On master: Close
[0m15:19:32.474780 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m15:19:32.474780 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.fct_sales ............................. [RUN]
[0m15:19:32.474780 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.fct_sales'
[0m15:19:32.474780 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.fct_sales
[0m15:19:32.490521 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.fct_sales"
[0m15:19:32.490521 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.fct_sales
[0m15:19:32.522354 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.fct_sales"
[0m15:19:32.522354 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:19:32.522354 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: BEGIN
[0m15:19:32.522354 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:19:32.569510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m15:19:32.569510 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:19:32.569510 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */

  create view "postgres"."public_marts"."fct_sales__dbt_tmp"
    
    
  as (
    

with s as (
    select * from "postgres"."public_staging"."stg_sales"
),

fct as (
    select
        reference_id,
        country,
        product_name,
        sales_agent_name,
        campaign_name,
        source,

        total_amount,
        discount_amount,
        returned_amount,
        total_rebill_amount,
        number_of_rebills,
        original_amount,

        (coalesce(total_amount, 0)
         + coalesce(total_rebill_amount, 0)
         - coalesce(returned_amount, 0)) as total_revenue,

        coalesce(total_rebill_amount, 0) as rebill_revenue,

        order_date_kyiv_ts,
        (order_date_kyiv_ts at time zone 'UTC') as order_date_utc,
        (order_date_kyiv_ts at time zone 'America/New_York') as order_date_ny,

        return_date_kyiv_ts,
        (return_date_kyiv_ts at time zone 'UTC') as return_date_utc,
        (return_date_kyiv_ts at time zone 'America/New_York') as return_date_ny,

        case 
            when return_date_kyiv_ts is not null and order_date_kyiv_ts is not null
            then date_part('day', return_date_kyiv_ts - order_date_kyiv_ts)
            else null
        end as refund_delay_days,

        has_chargeback,
        has_refund
    from s
)

select * from fct
  );
[0m15:19:32.587769 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m15:19:32.593513 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:19:32.593513 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */
alter table "postgres"."public_marts"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m15:19:32.595515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:19:32.612690 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: COMMIT
[0m15:19:32.612690 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:19:32.613695 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: COMMIT
[0m15:19:32.615442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:19:32.621725 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_marts"."fct_sales__dbt_backup"
[0m15:19:32.626282 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:19:32.627318 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */
drop view if exists "postgres"."public_marts"."fct_sales__dbt_backup" cascade
[0m15:19:32.627318 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:19:32.630865 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: Close
[0m15:19:32.633530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f02e330-97d0-4610-8732-d585c5b2ee20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDF359420>]}
[0m15:19:32.634529 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_marts.fct_sales ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m15:19:32.634529 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m15:19:32.635814 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:32.636849 [debug] [MainThread]: On master: BEGIN
[0m15:19:32.636849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:32.670918 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:19:32.670918 [debug] [MainThread]: On master: COMMIT
[0m15:19:32.670918 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:32.670918 [debug] [MainThread]: On master: COMMIT
[0m15:19:32.670918 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:19:32.670918 [debug] [MainThread]: On master: Close
[0m15:19:32.670918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:32.670918 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:19:32.670918 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m15:19:32.670918 [debug] [MainThread]: Connection 'model.gyb_test_project.fct_sales' was properly closed.
[0m15:19:32.670918 [info ] [MainThread]: 
[0m15:19:32.670918 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:19:32.670918 [debug] [MainThread]: Command end result
[0m15:19:32.708605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:19:32.710607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:19:32.718354 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:19:32.720357 [info ] [MainThread]: 
[0m15:19:32.720357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:32.720357 [info ] [MainThread]: 
[0m15:19:32.720357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:19:32.720357 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:32.720357 after 3.19 seconds
[0m15:19:32.720357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE0E94A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE2106A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DE21302B0>]}
[0m15:19:32.720357 [debug] [MainThread]: Flushing usage events
[0m15:19:34.583884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:23.299914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6DF650A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6E08617B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6E0860E50>]}


============================== 15:23:23.303868 | 5c620cc7-ada5-4c83-9206-8f3996584dbc ==============================
[0m15:23:23.303868 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:23:23.303868 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt clean', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:23:23.473687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c620cc7-ada5-4c83-9206-8f3996584dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6E08F1E10>]}
[0m15:23:23.534098 [debug] [MainThread]: Command `dbt clean` succeeded at 15:23:23.534098 after 0.34 seconds
[0m15:23:23.534098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6DF650A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6E08F0AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6E08F2200>]}
[0m15:23:23.534098 [debug] [MainThread]: Flushing usage events
[0m15:23:24.110452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:30.524736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224AE970A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B0B5BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B0B588E0>]}


============================== 15:23:30.538408 | 5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f ==============================
[0m15:23:30.538408 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:23:30.538408 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m15:23:30.773305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224AFC102B0>]}
[0m15:23:30.851375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B0A108E0>]}
[0m15:23:30.851375 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:23:31.110853 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:23:31.111887 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:23:31.111887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B0DCB880>]}
[0m15:23:32.996979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B250AC80>]}
[0m15:23:33.140000 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:23:33.144003 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:23:33.162302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B2450640>]}
[0m15:23:33.170619 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m15:23:33.170619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B240E680>]}
[0m15:23:33.170619 [info ] [MainThread]: 
[0m15:23:33.170619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:33.170619 [info ] [MainThread]: 
[0m15:23:33.170619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:33.180276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:23:33.240082 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:23:33.240082 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:23:33.255775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:33.296795 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.041 seconds
[0m15:23:33.297794 [debug] [ThreadPool]: On list_postgres: Close
[0m15:23:33.300786 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:23:33.300786 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:23:33.301852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:33.333771 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.036 seconds
[0m15:23:33.333771 [debug] [ThreadPool]: On list_postgres: Close
[0m15:23:33.339996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m15:23:33.339996 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:23:33.339996 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:23:33.339996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:33.476109 [debug] [ThreadPool]: SQL status: BEGIN in 0.139 seconds
[0m15:23:33.476109 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:23:33.476109 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:23:33.494520 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:23:33.494520 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:23:33.496529 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:23:33.496529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m15:23:33.496529 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:23:33.496529 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:23:33.496529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:33.521034 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m15:23:33.521034 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:23:33.521034 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:23:33.536793 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:23:33.536793 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:23:33.536793 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:23:33.536793 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.536793 [debug] [MainThread]: On master: BEGIN
[0m15:23:33.536793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:33.585566 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m15:23:33.586582 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.586582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:23:33.594710 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m15:23:33.595710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B24505E0>]}
[0m15:23:33.596707 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:33.597641 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.597641 [debug] [MainThread]: On master: BEGIN
[0m15:23:33.598786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:23:33.598786 [debug] [MainThread]: On master: COMMIT
[0m15:23:33.598786 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.599819 [debug] [MainThread]: On master: COMMIT
[0m15:23:33.600655 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:33.600655 [debug] [MainThread]: On master: Close
[0m15:23:33.605023 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m15:23:33.605023 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_sales ........................... [RUN]
[0m15:23:33.606022 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.stg_sales'
[0m15:23:33.607233 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m15:23:33.616860 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m15:23:33.617994 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m15:23:33.645886 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.stg_sales"
[0m15:23:33.645886 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:23:33.645886 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: BEGIN
[0m15:23:33.645886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:33.693374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:23:33.693374 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:23:33.693374 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */

  create view "postgres"."public_staging"."stg_sales__dbt_tmp"
    
    
  as (
    

with raw as (

  select
      coalesce("Reference ID"::varchar, 'N/A')              as reference_id,
      coalesce("Country"::varchar, 'N/A')                   as country,
      coalesce("Product Code"::varchar, 'N/A')              as product_code,
      coalesce("Product Name"::varchar, 'N/A')              as product_name,
      coalesce("Sales Agent Name"::varchar, 'N/A')          as sales_agent_name,
      coalesce("Campaign Name"::varchar, 'N/A')             as campaign_name,
      coalesce("Source"::varchar, 'N/A')                    as source,

      /* числові */
      coalesce("Total Amount ($)"::numeric, 0)              as total_amount,
      coalesce("Discount Amount ($)"::numeric, 0)           as discount_amount,
      coalesce("Returned Amount ($)"::numeric, 0)               as returned_amount,
      coalesce("Number Of Rebills"::int, 0)                 as number_of_rebills,
      coalesce("Original Amount ($)"::numeric, 0)               as original_amount,
      coalesce("Total Rebill Amount"::numeric, 0)           as total_rebill_amount,

      /* дати (у seed — без TZ) => приводимо до timestamptz */
      case when "Order Date Kyiv"  is null then null else "Order Date Kyiv"::timestamptz  end as order_date_kyiv_ts,
      case when "Return Date Kyiv" is null then null else "Return Date Kyiv"::timestamptz end as return_date_kyiv_ts,
      case when "Last Rebill Date Kyiv" is null then null else "Last Rebill Date Kyiv"::timestamptz end as last_rebill_date_kyiv_ts,

      /* текст Yes/No -> boolean */
      (lower(coalesce("Has Chargeback",'no')) = 'yes')      as has_chargeback,
      (lower(coalesce("Has Refund",'no')) = 'yes')          as has_refund

  from "postgres"."public_staging"."sales_data"

)

select * from raw
  );
[0m15:23:33.701452 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m15:23:33.709221 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:23:33.709221 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */
alter table "postgres"."public_staging"."stg_sales" rename to "stg_sales__dbt_backup"
[0m15:23:33.711222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:33.713585 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:23:33.715587 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */
alter table "postgres"."public_staging"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m15:23:33.715587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:23:33.732338 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: COMMIT
[0m15:23:33.733733 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:23:33.733733 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: COMMIT
[0m15:23:33.735954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:23:33.739945 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_staging"."stg_sales__dbt_backup"
[0m15:23:33.739945 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.stg_sales"
[0m15:23:33.739945 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.stg_sales"} */
drop view if exists "postgres"."public_staging"."stg_sales__dbt_backup" cascade
[0m15:23:33.757933 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m15:23:33.757933 [debug] [Thread-1 (]: On model.gyb_test_project.stg_sales: Close
[0m15:23:33.757933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B124D7E0>]}
[0m15:23:33.757933 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.stg_sales ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m15:23:33.757933 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m15:23:33.757933 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m15:23:33.757933 [info ] [Thread-1 (]: 2 of 2 START sql view model public_marts.fct_sales ............................. [RUN]
[0m15:23:33.757933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.gyb_test_project.stg_sales, now model.gyb_test_project.fct_sales)
[0m15:23:33.757933 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.fct_sales
[0m15:23:33.771583 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.fct_sales"
[0m15:23:33.773586 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.fct_sales
[0m15:23:33.777591 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.fct_sales"
[0m15:23:33.779593 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:23:33.779593 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: BEGIN
[0m15:23:33.779593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:33.802839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:23:33.802839 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:23:33.802839 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */

  create view "postgres"."public_marts"."fct_sales__dbt_tmp"
    
    
  as (
    

with s as (
    select * from "postgres"."public_staging"."stg_sales"
),

fct as (
    select
        reference_id,
        country,
        product_name,
        sales_agent_name,
        campaign_name,
        source,

        total_amount,
        discount_amount,
        returned_amount,
        total_rebill_amount,
        number_of_rebills,
        original_amount,

        (coalesce(total_amount, 0)
         + coalesce(total_rebill_amount, 0)
         - coalesce(returned_amount, 0)) as total_revenue,

        coalesce(total_rebill_amount, 0) as rebill_revenue,

        order_date_kyiv_ts,
        (order_date_kyiv_ts at time zone 'UTC') as order_date_utc,
        (order_date_kyiv_ts at time zone 'America/New_York') as order_date_ny,

        return_date_kyiv_ts,
        (return_date_kyiv_ts at time zone 'UTC') as return_date_utc,
        (return_date_kyiv_ts at time zone 'America/New_York') as return_date_ny,

        case 
            when return_date_kyiv_ts is not null and order_date_kyiv_ts is not null
            then date_part('day', return_date_kyiv_ts - order_date_kyiv_ts)
            else null
        end as refund_delay_days,

        has_chargeback,
        has_refund
    from s
)

select * from fct
  );
[0m15:23:33.825295 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:23:33.828289 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:23:33.829286 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */
alter table "postgres"."public_marts"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m15:23:33.830256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:23:33.831255 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: COMMIT
[0m15:23:33.832252 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:23:33.832252 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: COMMIT
[0m15:23:33.833340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:23:33.837022 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_marts"."fct_sales__dbt_backup"
[0m15:23:33.837022 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:23:33.838311 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */
drop view if exists "postgres"."public_marts"."fct_sales__dbt_backup" cascade
[0m15:23:33.838311 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:23:33.840575 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: Close
[0m15:23:33.841572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f4e6f3f-e9d4-44a8-95f8-a75d6914da6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B0BAC9A0>]}
[0m15:23:33.841572 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public_marts.fct_sales ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:23:33.842569 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m15:23:33.843937 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.844957 [debug] [MainThread]: On master: BEGIN
[0m15:23:33.844957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:33.865484 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m15:23:33.865484 [debug] [MainThread]: On master: COMMIT
[0m15:23:33.881336 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.881336 [debug] [MainThread]: On master: COMMIT
[0m15:23:33.881336 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:33.881336 [debug] [MainThread]: On master: Close
[0m15:23:33.881336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:33.881336 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:23:33.881336 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m15:23:33.881336 [debug] [MainThread]: Connection 'model.gyb_test_project.fct_sales' was properly closed.
[0m15:23:33.881336 [info ] [MainThread]: 
[0m15:23:33.881336 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m15:23:33.881336 [debug] [MainThread]: Command end result
[0m15:23:33.913095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:23:33.913095 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:23:33.913095 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:23:33.913095 [info ] [MainThread]: 
[0m15:23:33.913095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:33.928953 [info ] [MainThread]: 
[0m15:23:33.928953 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:23:33.928953 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:33.928953 after 3.49 seconds
[0m15:23:33.928953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224AE970A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224B25D5E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224AE2B9F60>]}
[0m15:23:33.928953 [debug] [MainThread]: Flushing usage events
[0m15:23:34.443319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:50.976153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CB4F0A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CC70B100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CC70A560>]}


============================== 15:23:50.976153 | 704bc5f1-6879-4aef-b6b4-b04d730f575f ==============================
[0m15:23:50.976153 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:23:50.976153 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m15:23:51.200348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '704bc5f1-6879-4aef-b6b4-b04d730f575f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CB7C02B0>]}
[0m15:23:51.271657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '704bc5f1-6879-4aef-b6b4-b04d730f575f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CC04C0A0>]}
[0m15:23:51.275766 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:23:51.521126 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:23:51.769426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:51.769426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:51.848985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '704bc5f1-6879-4aef-b6b4-b04d730f575f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CDE0D8A0>]}
[0m15:23:51.992351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:23:51.994676 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:23:52.073042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '704bc5f1-6879-4aef-b6b4-b04d730f575f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CC709630>]}
[0m15:23:52.073042 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 7 data tests, 447 macros
[0m15:23:52.073042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '704bc5f1-6879-4aef-b6b4-b04d730f575f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CBE8B310>]}
[0m15:23:52.073042 [info ] [MainThread]: 
[0m15:23:52.073042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:52.073042 [info ] [MainThread]: 
[0m15:23:52.073042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:52.084803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m15:23:52.146823 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:23:52.146823 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:23:52.146823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:52.201200 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m15:23:52.201200 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:23:52.202233 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:23:52.208313 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:23:52.209620 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:23:52.211517 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:23:52.212556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m15:23:52.215802 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:23:52.216805 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:23:52.216805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:52.249601 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:23:52.249601 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:23:52.249601 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:23:52.256056 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:23:52.256056 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:23:52.256056 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:23:52.256056 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:52.256056 [debug] [MainThread]: On master: BEGIN
[0m15:23:52.256056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:52.300075 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m15:23:52.300075 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:52.303791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:23:52.303791 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m15:23:52.313066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '704bc5f1-6879-4aef-b6b4-b04d730f575f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CDE0CF40>]}
[0m15:23:52.313066 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:52.313066 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:52.313066 [debug] [MainThread]: On master: BEGIN
[0m15:23:52.313066 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:23:52.313066 [debug] [MainThread]: On master: COMMIT
[0m15:23:52.313066 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:52.313066 [debug] [MainThread]: On master: COMMIT
[0m15:23:52.313066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:52.313066 [debug] [MainThread]: On master: Close
[0m15:23:52.321642 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312
[0m15:23:52.321642 [info ] [Thread-1 (]: 1 of 7 START test not_null_fct_sales_company_revenue ........................... [RUN]
[0m15:23:52.322642 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312'
[0m15:23:52.323710 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312
[0m15:23:52.333558 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312"
[0m15:23:52.333558 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312
[0m15:23:52.349511 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312"
[0m15:23:52.349511 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312"
[0m15:23:52.349511 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312: BEGIN
[0m15:23:52.349511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:52.396630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:23:52.396630 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312"
[0m15:23:52.396630 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select company_revenue
from "postgres"."public_marts"."fct_sales"
where company_revenue is null



  
  
      
    ) dbt_internal_test
[0m15:23:52.396630 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "company_revenue" does not exist
LINE 16: select company_revenue
                ^

[0m15:23:52.396630 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312: ROLLBACK
[0m15:23:52.396630 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312: Close
[0m15:23:52.412342 [debug] [Thread-1 (]: Database Error in test not_null_fct_sales_company_revenue (tests\schema.yml)
  column "company_revenue" does not exist
  LINE 16: select company_revenue
                  ^
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_company_revenue.sql
[0m15:23:52.412342 [error] [Thread-1 (]: 1 of 7 ERROR not_null_fct_sales_company_revenue ................................ [[31mERROR[0m in 0.09s]
[0m15:23:52.412342 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312
[0m15:23:52.412342 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34
[0m15:23:52.412342 [debug] [Thread-4 (]: Marking all children of 'test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_sales_company_revenue (tests\schema.yml)
  column "company_revenue" does not exist
  LINE 16: select company_revenue
                  ^
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_company_revenue.sql.
[0m15:23:52.412342 [info ] [Thread-1 (]: 2 of 7 START test not_null_fct_sales_order_datetime_kyiv ....................... [RUN]
[0m15:23:52.412342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_company_revenue.b1c2f83312, now test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34)
[0m15:23:52.412342 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34
[0m15:23:52.429487 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34"
[0m15:23:52.430523 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34
[0m15:23:52.434002 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34"
[0m15:23:52.435005 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34"
[0m15:23:52.435005 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34: BEGIN
[0m15:23:52.436064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:52.458738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:23:52.458738 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34"
[0m15:23:52.458738 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_datetime_kyiv
from "postgres"."public_marts"."fct_sales"
where order_datetime_kyiv is null



  
  
      
    ) dbt_internal_test
[0m15:23:52.458738 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_datetime_kyiv" does not exist
LINE 16: select order_datetime_kyiv
                ^

[0m15:23:52.458738 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34: ROLLBACK
[0m15:23:52.474437 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34: Close
[0m15:23:52.474437 [debug] [Thread-1 (]: Database Error in test not_null_fct_sales_order_datetime_kyiv (tests\schema.yml)
  column "order_datetime_kyiv" does not exist
  LINE 16: select order_datetime_kyiv
                  ^
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_order_datetime_kyiv.sql
[0m15:23:52.474437 [error] [Thread-1 (]: 2 of 7 ERROR not_null_fct_sales_order_datetime_kyiv ............................ [[31mERROR[0m in 0.06s]
[0m15:23:52.474437 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34
[0m15:23:52.474437 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m15:23:52.474437 [debug] [Thread-4 (]: Marking all children of 'test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_sales_order_datetime_kyiv (tests\schema.yml)
  column "order_datetime_kyiv" does not exist
  LINE 16: select order_datetime_kyiv
                  ^
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_order_datetime_kyiv.sql.
[0m15:23:52.474437 [info ] [Thread-1 (]: 3 of 7 START test not_null_fct_sales_reference_id .............................. [RUN]
[0m15:23:52.474437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_order_datetime_kyiv.6a6033ca34, now test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f)
[0m15:23:52.474437 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m15:23:52.474437 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m15:23:52.474437 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m15:23:52.490300 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m15:23:52.491470 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m15:23:52.491470 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: BEGIN
[0m15:23:52.492470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:52.617537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.136 seconds
[0m15:23:52.617537 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m15:23:52.617537 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reference_id
from "postgres"."public_marts"."fct_sales"
where reference_id is null



  
  
      
    ) dbt_internal_test
[0m15:23:52.633191 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:23:52.633191 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: ROLLBACK
[0m15:23:52.633191 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: Close
[0m15:23:52.633191 [info ] [Thread-1 (]: 3 of 7 PASS not_null_fct_sales_reference_id .................................... [[32mPASS[0m in 0.16s]
[0m15:23:52.633191 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m15:23:52.633191 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m15:23:52.633191 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_sales_country ................................... [RUN]
[0m15:23:52.633191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f, now test.gyb_test_project.not_null_stg_sales_country.54818173bf)
[0m15:23:52.633191 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m15:23:52.633191 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_country.54818173bf"
[0m15:23:52.648914 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m15:23:52.652753 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_stg_sales_country.54818173bf"
[0m15:23:52.653896 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_stg_sales_country.54818173bf"
[0m15:23:52.655108 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_country.54818173bf: BEGIN
[0m15:23:52.656197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:52.693373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m15:23:52.693373 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_stg_sales_country.54818173bf"
[0m15:23:52.693373 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_country.54818173bf: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_stg_sales_country.54818173bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from "postgres"."public_staging"."stg_sales"
where country is null



  
  
      
    ) dbt_internal_test
[0m15:23:52.693373 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:23:52.693373 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_country.54818173bf: ROLLBACK
[0m15:23:52.693373 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_country.54818173bf: Close
[0m15:23:52.693373 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_sales_country ......................................... [[32mPASS[0m in 0.06s]
[0m15:23:52.693373 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m15:23:52.693373 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m15:23:52.693373 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_sales_product_name .............................. [RUN]
[0m15:23:52.693373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_country.54818173bf, now test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb)
[0m15:23:52.693373 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m15:23:52.693373 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb"
[0m15:23:52.693373 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m15:23:52.709138 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb"
[0m15:23:52.709138 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb"
[0m15:23:52.709138 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb: BEGIN
[0m15:23:52.709138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:52.750826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m15:23:52.750826 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb"
[0m15:23:52.750826 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."public_staging"."stg_sales"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m15:23:52.750826 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:23:52.756678 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb: ROLLBACK
[0m15:23:52.758275 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb: Close
[0m15:23:52.758275 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_sales_product_name .................................... [[32mPASS[0m in 0.06s]
[0m15:23:52.759275 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m15:23:52.760505 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m15:23:52.761548 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_sales_reference_id .............................. [RUN]
[0m15:23:52.761548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb, now test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb)
[0m15:23:52.762552 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m15:23:52.766869 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb"
[0m15:23:52.768136 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m15:23:52.770335 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb"
[0m15:23:52.771373 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb"
[0m15:23:52.771373 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb: BEGIN
[0m15:23:52.771373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:52.805141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:23:52.805141 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb"
[0m15:23:52.805141 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reference_id
from "postgres"."public_staging"."stg_sales"
where reference_id is null



  
  
      
    ) dbt_internal_test
[0m15:23:52.805141 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:23:52.805141 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb: ROLLBACK
[0m15:23:52.813635 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb: Close
[0m15:23:52.813635 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_sales_reference_id .................................... [[32mPASS[0m in 0.05s]
[0m15:23:52.813635 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m15:23:52.813635 [debug] [Thread-1 (]: Began running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m15:23:52.813635 [info ] [Thread-1 (]: 7 of 7 START test unique_fct_sales_reference_id ................................ [RUN]
[0m15:23:52.813635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb, now test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8)
[0m15:23:52.813635 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m15:23:52.819148 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m15:23:52.819148 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m15:23:52.819148 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m15:23:52.819148 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m15:23:52.819148 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: BEGIN
[0m15:23:52.819148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:52.867562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:23:52.867562 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m15:23:52.868594 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reference_id as unique_field,
    count(*) as n_records

from "postgres"."public_marts"."fct_sales"
where reference_id is not null
group by reference_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:52.872007 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:23:52.873007 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: ROLLBACK
[0m15:23:52.874150 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: Close
[0m15:23:52.875151 [error] [Thread-1 (]: 7 of 7 FAIL 4 unique_fct_sales_reference_id .................................... [[31mFAIL 4[0m in 0.06s]
[0m15:23:52.875151 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m15:23:52.876213 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:52.877704 [debug] [MainThread]: On master: BEGIN
[0m15:23:52.877704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:52.911300 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m15:23:52.911300 [debug] [MainThread]: On master: COMMIT
[0m15:23:52.911300 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:52.911300 [debug] [MainThread]: On master: COMMIT
[0m15:23:52.911300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:52.911300 [debug] [MainThread]: On master: Close
[0m15:23:52.911300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:52.911300 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m15:23:52.911300 [debug] [MainThread]: Connection 'test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8' was properly closed.
[0m15:23:52.911300 [info ] [MainThread]: 
[0m15:23:52.911300 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m15:23:52.911300 [debug] [MainThread]: Command end result
[0m15:23:52.944869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:23:52.944869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:23:52.958628 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:23:52.958628 [info ] [MainThread]: 
[0m15:23:52.958628 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:23:52.958628 [info ] [MainThread]: 
[0m15:23:52.958628 [error] [MainThread]: [31mFailure in test not_null_fct_sales_company_revenue (tests\schema.yml)[0m
[0m15:23:52.958628 [error] [MainThread]:   Database Error in test not_null_fct_sales_company_revenue (tests\schema.yml)
  column "company_revenue" does not exist
  LINE 16: select company_revenue
                  ^
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_company_revenue.sql
[0m15:23:52.958628 [info ] [MainThread]: 
[0m15:23:52.958628 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\tests\schema.yml\not_null_fct_sales_company_revenue.sql
[0m15:23:52.958628 [info ] [MainThread]: 
[0m15:23:52.958628 [error] [MainThread]: [31mFailure in test not_null_fct_sales_order_datetime_kyiv (tests\schema.yml)[0m
[0m15:23:52.958628 [error] [MainThread]:   Database Error in test not_null_fct_sales_order_datetime_kyiv (tests\schema.yml)
  column "order_datetime_kyiv" does not exist
  LINE 16: select order_datetime_kyiv
                  ^
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_order_datetime_kyiv.sql
[0m15:23:52.974478 [info ] [MainThread]: 
[0m15:23:52.974478 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\tests\schema.yml\not_null_fct_sales_order_datetime_kyiv.sql
[0m15:23:52.975568 [info ] [MainThread]: 
[0m15:23:52.976637 [error] [MainThread]: [31mFailure in test unique_fct_sales_reference_id (tests\schema.yml)[0m
[0m15:23:52.976637 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m15:23:52.977898 [info ] [MainThread]: 
[0m15:23:52.977898 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\tests\schema.yml\unique_fct_sales_reference_id.sql
[0m15:23:52.979311 [info ] [MainThread]: 
[0m15:23:52.979311 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=7
[0m15:23:52.980604 [debug] [MainThread]: Command `dbt test` failed at 15:23:52.980604 after 2.10 seconds
[0m15:23:52.981601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CB4F0A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CC04C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8CB796A40>]}
[0m15:23:52.981601 [debug] [MainThread]: Flushing usage events
[0m15:23:53.506893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:55.764209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C889310A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88A5315D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88A533250>]}


============================== 15:56:55.768487 | 4a5569d5-947b-482f-a8fc-129b2b62a0dc ==============================
[0m15:56:55.768487 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:56:55.769954 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt run -s fct_sales', 'printer_width': '80', 'write_json': 'True'}
[0m15:56:56.004567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a5569d5-947b-482f-a8fc-129b2b62a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88A5955D0>]}
[0m15:56:56.080962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a5569d5-947b-482f-a8fc-129b2b62a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88A32FDF0>]}
[0m15:56:56.083135 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:56:56.328002 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:56:56.586200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:56:56.586940 [debug] [MainThread]: Partial parsing: updated file: gyb_test_project://tests\schema.yml
[0m15:56:56.586940 [debug] [MainThread]: Partial parsing: updated file: gyb_test_project://models\marts\fct_sales.sql
[0m15:56:57.134339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5569d5-947b-482f-a8fc-129b2b62a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88BEF8130>]}
[0m15:56:57.272315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:56:57.275863 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:56:57.300555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5569d5-947b-482f-a8fc-129b2b62a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88BF22110>]}
[0m15:56:57.301811 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 6 data tests, 447 macros
[0m15:56:57.301811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5569d5-947b-482f-a8fc-129b2b62a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88BF203D0>]}
[0m15:56:57.303806 [info ] [MainThread]: 
[0m15:56:57.303806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:57.305237 [info ] [MainThread]: 
[0m15:56:57.305237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:57.307611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:56:57.402131 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:56:57.402131 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:56:57.403135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:57.446214 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m15:56:57.447074 [debug] [ThreadPool]: On list_postgres: Close
[0m15:56:57.452979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m15:56:57.459366 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:56:57.459366 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:56:57.460660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:57.495506 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:56:57.495506 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:56:57.496901 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:56:57.503502 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:56:57.504502 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:56:57.505433 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:56:57.505433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m15:56:57.508317 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:56:57.509486 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:56:57.509486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:57.547228 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m15:56:57.547228 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:56:57.548419 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:56:57.555212 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m15:56:57.557183 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:56:57.558357 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:56:57.563227 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:57.563227 [debug] [MainThread]: On master: BEGIN
[0m15:56:57.564264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:57.598649 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m15:56:57.599742 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:57.599742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:56:57.607127 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m15:56:57.609227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5569d5-947b-482f-a8fc-129b2b62a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88BEF8550>]}
[0m15:56:57.610224 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:57.610224 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:57.610224 [debug] [MainThread]: On master: BEGIN
[0m15:56:57.611682 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:56:57.611682 [debug] [MainThread]: On master: COMMIT
[0m15:56:57.612785 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:57.612785 [debug] [MainThread]: On master: COMMIT
[0m15:56:57.612785 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:57.614138 [debug] [MainThread]: On master: Close
[0m15:56:57.618874 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m15:56:57.618874 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.fct_sales ............................. [RUN]
[0m15:56:57.619873 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.fct_sales'
[0m15:56:57.621068 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.fct_sales
[0m15:56:57.630218 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.fct_sales"
[0m15:56:57.631254 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.fct_sales
[0m15:56:57.670282 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.fct_sales"
[0m15:56:57.671318 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:56:57.672661 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: BEGIN
[0m15:56:57.672661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:56:57.813799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m15:56:57.814799 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:56:57.814799 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */

  create view "postgres"."public_marts"."fct_sales__dbt_tmp"
    
    
  as (
    

with fct as (
  select
      reference_id,
      country,
      product_name,
      sales_agent_name,
      campaign_name,
      source,
      total_amount,
      discount_amount,
      returned_amount,
      total_rebill_amount,
      number_of_rebills,
      original_amount,
      (coalesce(total_amount, 0)
       + coalesce(total_rebill_amount, 0)
       - coalesce(returned_amount, 0)) as total_revenue,
      coalesce(total_rebill_amount, 0) as rebill_revenue,
      order_date_kyiv_ts,
      (order_date_kyiv_ts at time zone 'UTC') as order_date_utc,
      (order_date_kyiv_ts at time zone 'America/New_York') as order_date_ny,
      return_date_kyiv_ts,
      (return_date_kyiv_ts at time zone 'UTC') as return_date_utc,
      (return_date_kyiv_ts at time zone 'America/New_York') as return_date_ny,
      case
        when return_date_kyiv_ts is not null and order_date_kyiv_ts is not null
          then date_part('day', return_date_kyiv_ts - order_date_kyiv_ts)
        else null
      end as refund_delay_days,
      has_chargeback,
      has_refund
  from "postgres"."public_staging"."stg_sales"
)

-- прибираємо дублікати за reference_id
select *
from (
  select *,
         row_number() over (
           partition by reference_id
           order by order_date_kyiv_ts desc nulls last
         ) as rn
  from fct
) deduped
where rn = 1;
  );
[0m15:56:57.816875 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 53: where rn = 1;
                     ^

[0m15:56:57.816875 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: ROLLBACK
[0m15:56:57.818118 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: Close
[0m15:56:57.821440 [debug] [Thread-1 (]: Database Error in model fct_sales (models\marts\fct_sales.sql)
  syntax error at or near ";"
  LINE 53: where rn = 1;
                       ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql
[0m15:56:57.824712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5569d5-947b-482f-a8fc-129b2b62a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88817BBB0>]}
[0m15:56:57.825773 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_marts.fct_sales .................... [[31mERROR[0m in 0.20s]
[0m15:56:57.827235 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m15:56:57.827735 [debug] [Thread-4 (]: Marking all children of 'model.gyb_test_project.fct_sales' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales (models\marts\fct_sales.sql)
  syntax error at or near ";"
  LINE 53: where rn = 1;
                       ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql.
[0m15:56:57.828735 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:57.830210 [debug] [MainThread]: On master: BEGIN
[0m15:56:57.830210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:57.867501 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m15:56:57.867501 [debug] [MainThread]: On master: COMMIT
[0m15:56:57.868762 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:57.868762 [debug] [MainThread]: On master: COMMIT
[0m15:56:57.869934 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:57.869934 [debug] [MainThread]: On master: Close
[0m15:56:57.870933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:57.870933 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:56:57.871931 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m15:56:57.871931 [debug] [MainThread]: Connection 'model.gyb_test_project.fct_sales' was properly closed.
[0m15:56:57.871931 [info ] [MainThread]: 
[0m15:56:57.872928 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m15:56:57.874147 [debug] [MainThread]: Command end result
[0m15:56:57.900853 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:56:57.902968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:56:57.910307 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:56:57.911342 [info ] [MainThread]: 
[0m15:56:57.911342 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:56:57.911342 [info ] [MainThread]: 
[0m15:56:57.912701 [error] [MainThread]: [31mFailure in model fct_sales (models\marts\fct_sales.sql)[0m
[0m15:56:57.913740 [error] [MainThread]:   Database Error in model fct_sales (models\marts\fct_sales.sql)
  syntax error at or near ";"
  LINE 53: where rn = 1;
                       ^
  compiled code at target\run\gyb_test_project\models\marts\fct_sales.sql
[0m15:56:57.913740 [info ] [MainThread]: 
[0m15:56:57.914659 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\models\marts\fct_sales.sql
[0m15:56:57.914659 [info ] [MainThread]: 
[0m15:56:57.915730 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:56:57.916740 [debug] [MainThread]: Command `dbt run` failed at 15:56:57.916740 after 2.25 seconds
[0m15:56:57.917746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C889310A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88A32FDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88BEDAFB0>]}
[0m15:56:57.917746 [debug] [MainThread]: Flushing usage events
[0m15:56:58.533908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:11.116853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B03A90AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B04CA2E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B04CA0700>]}


============================== 15:57:11.120730 | a0732fef-ec73-45d0-bf65-b38a31696f21 ==============================
[0m15:57:11.120730 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:57:11.120730 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run -s fct_sales', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:57:11.339620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0732fef-ec73-45d0-bf65-b38a31696f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B04479990>]}
[0m15:57:11.414481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0732fef-ec73-45d0-bf65-b38a31696f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B04D2DF30>]}
[0m15:57:11.416169 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:57:11.671873 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:57:11.925034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:11.925034 [debug] [MainThread]: Partial parsing: updated file: gyb_test_project://models\marts\fct_sales.sql
[0m15:57:12.483771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0732fef-ec73-45d0-bf65-b38a31696f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B06664130>]}
[0m15:57:12.619672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:57:12.623051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:57:12.647812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0732fef-ec73-45d0-bf65-b38a31696f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B06690640>]}
[0m15:57:12.647812 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 6 data tests, 447 macros
[0m15:57:12.649549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0732fef-ec73-45d0-bf65-b38a31696f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B06692050>]}
[0m15:57:12.651033 [info ] [MainThread]: 
[0m15:57:12.651033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:12.652344 [info ] [MainThread]: 
[0m15:57:12.653409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:12.654619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:57:12.727690 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:57:12.727690 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:57:12.728726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:12.771016 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m15:57:12.773156 [debug] [ThreadPool]: On list_postgres: Close
[0m15:57:12.778488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m15:57:12.784149 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:57:12.785184 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:57:12.785184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:12.821289 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:57:12.821289 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:57:12.822324 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:57:12.828940 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:57:12.829982 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:57:12.831021 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:57:12.831021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m15:57:12.834104 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:57:12.834104 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:57:12.835101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:12.870028 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:57:12.871061 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:57:12.871061 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:57:12.878250 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:57:12.879643 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:57:12.879993 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:57:12.885196 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:12.885196 [debug] [MainThread]: On master: BEGIN
[0m15:57:12.886201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:12.921687 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:57:12.921687 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:12.922688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:57:12.930061 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m15:57:12.931126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0732fef-ec73-45d0-bf65-b38a31696f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B066645E0>]}
[0m15:57:12.932160 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:12.932160 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:12.933434 [debug] [MainThread]: On master: BEGIN
[0m15:57:12.934182 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:57:12.934182 [debug] [MainThread]: On master: COMMIT
[0m15:57:12.935208 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:12.935208 [debug] [MainThread]: On master: COMMIT
[0m15:57:12.936144 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:12.936144 [debug] [MainThread]: On master: Close
[0m15:57:12.941252 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m15:57:12.941252 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.fct_sales ............................. [RUN]
[0m15:57:12.942251 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.gyb_test_project.fct_sales'
[0m15:57:12.943437 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.fct_sales
[0m15:57:12.952358 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.fct_sales"
[0m15:57:12.953396 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.fct_sales
[0m15:57:12.993100 [debug] [Thread-1 (]: Writing runtime sql for node "model.gyb_test_project.fct_sales"
[0m15:57:12.994235 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:57:12.994235 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: BEGIN
[0m15:57:12.995322 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:13.031592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:57:13.031592 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:57:13.032823 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */

  create view "postgres"."public_marts"."fct_sales__dbt_tmp"
    
    
  as (
    

with fct as (
  select
      reference_id,
      country,
      product_name,
      sales_agent_name,
      campaign_name,
      source,
      total_amount,
      discount_amount,
      returned_amount,
      total_rebill_amount,
      number_of_rebills,
      original_amount,
      (coalesce(total_amount, 0)
       + coalesce(total_rebill_amount, 0)
       - coalesce(returned_amount, 0)) as total_revenue,
      coalesce(total_rebill_amount, 0) as rebill_revenue,
      order_date_kyiv_ts,
      (order_date_kyiv_ts at time zone 'UTC') as order_date_utc,
      (order_date_kyiv_ts at time zone 'America/New_York') as order_date_ny,
      return_date_kyiv_ts,
      (return_date_kyiv_ts at time zone 'UTC') as return_date_utc,
      (return_date_kyiv_ts at time zone 'America/New_York') as return_date_ny,
      case
        when return_date_kyiv_ts is not null and order_date_kyiv_ts is not null
          then date_part('day', return_date_kyiv_ts - order_date_kyiv_ts)
        else null
      end as refund_delay_days,
      has_chargeback,
      has_refund
  from "postgres"."public_staging"."stg_sales"
)

-- прибираємо дублікати за reference_id
select *
from (
  select *,
         row_number() over (
           partition by reference_id
           order by order_date_kyiv_ts desc nulls last
         ) as rn
  from fct
) deduped
where rn = 1
  );
[0m15:57:13.044753 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m15:57:13.052113 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:57:13.052113 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */
alter table "postgres"."public_marts"."fct_sales" rename to "fct_sales__dbt_backup"
[0m15:57:13.053262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:57:13.057378 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:57:13.057378 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */
alter table "postgres"."public_marts"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m15:57:13.058687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:57:13.076249 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: COMMIT
[0m15:57:13.077285 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:57:13.077285 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: COMMIT
[0m15:57:13.079674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:57:13.087342 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_marts"."fct_sales__dbt_backup"
[0m15:57:13.091751 [debug] [Thread-1 (]: Using postgres connection "model.gyb_test_project.fct_sales"
[0m15:57:13.091751 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "model.gyb_test_project.fct_sales"} */
drop view if exists "postgres"."public_marts"."fct_sales__dbt_backup" cascade
[0m15:57:13.094053 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:57:13.096050 [debug] [Thread-1 (]: On model.gyb_test_project.fct_sales: Close
[0m15:57:13.099276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0732fef-ec73-45d0-bf65-b38a31696f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B017800A0>]}
[0m15:57:13.100276 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_marts.fct_sales ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m15:57:13.101622 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m15:57:13.102807 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:13.103914 [debug] [MainThread]: On master: BEGIN
[0m15:57:13.103914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:13.245677 [debug] [MainThread]: SQL status: BEGIN in 0.142 seconds
[0m15:57:13.246679 [debug] [MainThread]: On master: COMMIT
[0m15:57:13.246679 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:13.246679 [debug] [MainThread]: On master: COMMIT
[0m15:57:13.248471 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:13.248471 [debug] [MainThread]: On master: Close
[0m15:57:13.249470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:13.249870 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:57:13.250226 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m15:57:13.250226 [debug] [MainThread]: Connection 'model.gyb_test_project.fct_sales' was properly closed.
[0m15:57:13.251273 [info ] [MainThread]: 
[0m15:57:13.251273 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:57:13.252276 [debug] [MainThread]: Command end result
[0m15:57:13.279222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:57:13.281218 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:57:13.289704 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:57:13.290141 [info ] [MainThread]: 
[0m15:57:13.291194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:13.291194 [info ] [MainThread]: 
[0m15:57:13.292239 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:57:13.292899 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:13.292899 after 2.27 seconds
[0m15:57:13.293899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B03A90AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B04FC4BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B04D2DF30>]}
[0m15:57:13.293899 [debug] [MainThread]: Flushing usage events
[0m15:57:13.818135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:25.729730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFF3E0AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A805DFC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A807E16F0>]}


============================== 15:57:25.733483 | 85680f07-3e58-44a8-91de-05a113a4c45a ==============================
[0m15:57:25.733483 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:57:25.733483 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'invocation_command': 'dbt test -s fct_sales', 'printer_width': '80', 'write_json': 'True'}
[0m15:57:25.967530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85680f07-3e58-44a8-91de-05a113a4c45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A808199C0>]}
[0m15:57:26.045686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85680f07-3e58-44a8-91de-05a113a4c45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFF752A40>]}
[0m15:57:26.047496 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:57:26.308599 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:57:26.566630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:26.566630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:26.658820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85680f07-3e58-44a8-91de-05a113a4c45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A81F556F0>]}
[0m15:57:26.804165 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:57:26.807743 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:57:26.880244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85680f07-3e58-44a8-91de-05a113a4c45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A81F64FA0>]}
[0m15:57:26.880244 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 6 data tests, 447 macros
[0m15:57:26.881321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85680f07-3e58-44a8-91de-05a113a4c45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A81F67B20>]}
[0m15:57:26.883222 [info ] [MainThread]: 
[0m15:57:26.883222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:26.884410 [info ] [MainThread]: 
[0m15:57:26.885033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:26.890060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m15:57:26.967623 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:57:26.968627 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m15:57:26.968627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:27.012603 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m15:57:27.013856 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m15:57:27.013856 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m15:57:27.021196 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:57:27.022510 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m15:57:27.022510 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m15:57:27.023671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m15:57:27.027157 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:57:27.027157 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m15:57:27.027157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:27.062638 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:57:27.063715 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m15:57:27.063715 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m15:57:27.069995 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:57:27.072266 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m15:57:27.072665 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m15:57:27.077770 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:27.077770 [debug] [MainThread]: On master: BEGIN
[0m15:57:27.078810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:27.113194 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m15:57:27.113194 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:27.114273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:57:27.121530 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m15:57:27.122658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85680f07-3e58-44a8-91de-05a113a4c45a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A81F2B4F0>]}
[0m15:57:27.123861 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:27.124862 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:27.124862 [debug] [MainThread]: On master: BEGIN
[0m15:57:27.125945 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:57:27.125945 [debug] [MainThread]: On master: COMMIT
[0m15:57:27.125945 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:27.126977 [debug] [MainThread]: On master: COMMIT
[0m15:57:27.127841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:27.127841 [debug] [MainThread]: On master: Close
[0m15:57:27.131619 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2
[0m15:57:27.132711 [info ] [Thread-1 (]: 1 of 3 START test not_null_fct_sales_order_date_kyiv ........................... [RUN]
[0m15:57:27.133742 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2'
[0m15:57:27.133742 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2
[0m15:57:27.151333 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2"
[0m15:57:27.152718 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2
[0m15:57:27.170795 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2"
[0m15:57:27.172303 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2"
[0m15:57:27.172779 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2: BEGIN
[0m15:57:27.172779 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:27.209102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:57:27.209102 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2"
[0m15:57:27.210134 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date_kyiv
from "postgres"."public_marts"."fct_sales"
where order_date_kyiv is null



  
  
      
    ) dbt_internal_test
[0m15:57:27.211457 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_date_kyiv" does not exist
LINE 16: select order_date_kyiv
                ^
HINT:  Perhaps you meant to reference the column "fct_sales.order_date_kyiv_ts" or the column "fct_sales.order_date_ny".

[0m15:57:27.211457 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2: ROLLBACK
[0m15:57:27.212730 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2: Close
[0m15:57:27.216066 [debug] [Thread-1 (]: Database Error in test not_null_fct_sales_order_date_kyiv (tests\schema.yml)
  column "order_date_kyiv" does not exist
  LINE 16: select order_date_kyiv
                  ^
  HINT:  Perhaps you meant to reference the column "fct_sales.order_date_kyiv_ts" or the column "fct_sales.order_date_ny".
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_order_date_kyiv.sql
[0m15:57:27.216066 [error] [Thread-1 (]: 1 of 3 ERROR not_null_fct_sales_order_date_kyiv ................................ [[31mERROR[0m in 0.08s]
[0m15:57:27.217530 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2
[0m15:57:27.218540 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m15:57:27.218540 [debug] [Thread-4 (]: Marking all children of 'test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_sales_order_date_kyiv (tests\schema.yml)
  column "order_date_kyiv" does not exist
  LINE 16: select order_date_kyiv
                  ^
  HINT:  Perhaps you meant to reference the column "fct_sales.order_date_kyiv_ts" or the column "fct_sales.order_date_ny".
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_order_date_kyiv.sql.
[0m15:57:27.218540 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_sales_reference_id .............................. [RUN]
[0m15:57:27.220374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_order_date_kyiv.3921a348c2, now test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f)
[0m15:57:27.221487 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m15:57:27.225644 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m15:57:27.226670 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m15:57:27.229982 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m15:57:27.231017 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m15:57:27.231017 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: BEGIN
[0m15:57:27.231017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:27.267570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:57:27.267570 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m15:57:27.268602 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reference_id
from "postgres"."public_marts"."fct_sales"
where reference_id is null



  
  
      
    ) dbt_internal_test
[0m15:57:27.273844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:57:27.277835 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: ROLLBACK
[0m15:57:27.279155 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: Close
[0m15:57:27.280154 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_sales_reference_id .................................... [[32mPASS[0m in 0.06s]
[0m15:57:27.280154 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m15:57:27.281192 [debug] [Thread-1 (]: Began running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m15:57:27.282208 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_sales_reference_id ................................ [RUN]
[0m15:57:27.282565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f, now test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8)
[0m15:57:27.283605 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m15:57:27.289588 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m15:57:27.290585 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m15:57:27.293905 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m15:57:27.295183 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m15:57:27.296256 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: BEGIN
[0m15:57:27.296256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:27.332217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:57:27.333333 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m15:57:27.333333 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reference_id as unique_field,
    count(*) as n_records

from "postgres"."public_marts"."fct_sales"
where reference_id is not null
group by reference_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:57:27.338612 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:57:27.340736 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: ROLLBACK
[0m15:57:27.341355 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: Close
[0m15:57:27.342233 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_sales_reference_id ...................................... [[32mPASS[0m in 0.06s]
[0m15:57:27.342623 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m15:57:27.343657 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:27.344803 [debug] [MainThread]: On master: BEGIN
[0m15:57:27.344803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:27.381006 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:57:27.381006 [debug] [MainThread]: On master: COMMIT
[0m15:57:27.382337 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:27.382337 [debug] [MainThread]: On master: COMMIT
[0m15:57:27.383048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:27.383048 [debug] [MainThread]: On master: Close
[0m15:57:27.384231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:27.385348 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m15:57:27.385348 [debug] [MainThread]: Connection 'test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8' was properly closed.
[0m15:57:27.386349 [info ] [MainThread]: 
[0m15:57:27.386349 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m15:57:27.388473 [debug] [MainThread]: Command end result
[0m15:57:27.416525 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m15:57:27.418739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m15:57:27.426400 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m15:57:27.427768 [info ] [MainThread]: 
[0m15:57:27.427768 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:57:27.428822 [info ] [MainThread]: 
[0m15:57:27.428822 [error] [MainThread]: [31mFailure in test not_null_fct_sales_order_date_kyiv (tests\schema.yml)[0m
[0m15:57:27.429859 [error] [MainThread]:   Database Error in test not_null_fct_sales_order_date_kyiv (tests\schema.yml)
  column "order_date_kyiv" does not exist
  LINE 16: select order_date_kyiv
                  ^
  HINT:  Perhaps you meant to reference the column "fct_sales.order_date_kyiv_ts" or the column "fct_sales.order_date_ny".
  compiled code at target\run\gyb_test_project\tests\schema.yml\not_null_fct_sales_order_date_kyiv.sql
[0m15:57:27.430592 [info ] [MainThread]: 
[0m15:57:27.431085 [info ] [MainThread]:   compiled code at target\compiled\gyb_test_project\tests\schema.yml\not_null_fct_sales_order_date_kyiv.sql
[0m15:57:27.431085 [info ] [MainThread]: 
[0m15:57:27.432119 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m15:57:27.433126 [debug] [MainThread]: Command `dbt test` failed at 15:57:27.433126 after 1.80 seconds
[0m15:57:27.434309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AFF3E0AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A80945CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A808199C0>]}
[0m15:57:27.434309 [debug] [MainThread]: Flushing usage events
[0m15:57:27.980147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:57.852420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5654DCAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5666F3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5666F1BD0>]}


============================== 16:02:57.856689 | 38eb4b1f-2c2f-4d01-97d5-f644743d981e ==============================
[0m16:02:57.856689 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:02:57.858171 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -s fct_sales', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:02:58.115712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38eb4b1f-2c2f-4d01-97d5-f644743d981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B565E7A860>]}
[0m16:02:58.205358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38eb4b1f-2c2f-4d01-97d5-f644743d981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B565852A40>]}
[0m16:02:58.206986 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:02:58.480062 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:02:58.749544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:58.750579 [debug] [MainThread]: Partial parsing: updated file: gyb_test_project://tests\schema.yml
[0m16:02:59.347593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38eb4b1f-2c2f-4d01-97d5-f644743d981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5680C0130>]}
[0m16:02:59.496694 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m16:02:59.500283 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m16:02:59.538888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38eb4b1f-2c2f-4d01-97d5-f644743d981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B567D9A770>]}
[0m16:02:59.539892 [info ] [MainThread]: Found 2 models, 3 analyses, 1 seed, 6 data tests, 447 macros
[0m16:02:59.539892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38eb4b1f-2c2f-4d01-97d5-f644743d981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B567D985E0>]}
[0m16:02:59.541997 [info ] [MainThread]: 
[0m16:02:59.543000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:59.543000 [info ] [MainThread]: 
[0m16:02:59.544146 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:59.550436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_marts'
[0m16:02:59.658785 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m16:02:59.658785 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m16:02:59.660136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:59.707087 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:02:59.707087 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m16:02:59.708270 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:02:59.714994 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:02:59.715994 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m16:02:59.717010 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m16:02:59.717010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_marts, now list_postgres_public_staging)
[0m16:02:59.720842 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:02:59.720842 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:02:59.720842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:59.761071 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m16:02:59.761071 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:02:59.762335 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:02:59.770966 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:02:59.772025 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:02:59.773030 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:02:59.781727 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:59.782724 [debug] [MainThread]: On master: BEGIN
[0m16:02:59.783721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:59.825752 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m16:02:59.827025 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:59.827025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:02:59.834700 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m16:02:59.836847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38eb4b1f-2c2f-4d01-97d5-f644743d981e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B562867D60>]}
[0m16:02:59.836847 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:59.837882 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:59.837882 [debug] [MainThread]: On master: BEGIN
[0m16:02:59.838886 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:02:59.838886 [debug] [MainThread]: On master: COMMIT
[0m16:02:59.839888 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:59.839888 [debug] [MainThread]: On master: COMMIT
[0m16:02:59.840885 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:59.840885 [debug] [MainThread]: On master: Close
[0m16:02:59.845876 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50
[0m16:02:59.845876 [info ] [Thread-1 (]: 1 of 3 START test not_null_fct_sales_order_date_kyiv_ts ........................ [RUN]
[0m16:02:59.846916 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50'
[0m16:02:59.847918 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50
[0m16:02:59.866419 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50"
[0m16:02:59.867457 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50
[0m16:02:59.889476 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50"
[0m16:02:59.890517 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50"
[0m16:02:59.890517 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50: BEGIN
[0m16:02:59.891878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:02:59.930393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m16:02:59.930393 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50"
[0m16:02:59.931430 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date_kyiv_ts
from "postgres"."public_marts"."fct_sales"
where order_date_kyiv_ts is null



  
  
      
    ) dbt_internal_test
[0m16:02:59.935655 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:02:59.939966 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50: ROLLBACK
[0m16:02:59.941306 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50: Close
[0m16:02:59.941306 [info ] [Thread-1 (]: 1 of 3 PASS not_null_fct_sales_order_date_kyiv_ts .............................. [[32mPASS[0m in 0.09s]
[0m16:02:59.942305 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50
[0m16:02:59.943516 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m16:02:59.943516 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_sales_reference_id .............................. [RUN]
[0m16:02:59.944848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50, now test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f)
[0m16:02:59.944848 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m16:02:59.951270 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m16:02:59.952458 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m16:02:59.955834 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m16:02:59.956838 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m16:02:59.956838 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: BEGIN
[0m16:02:59.957842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:59.994207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:02:59.994560 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m16:02:59.994560 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reference_id
from "postgres"."public_marts"."fct_sales"
where reference_id is null



  
  
      
    ) dbt_internal_test
[0m16:02:59.998203 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:02:59.999202 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: ROLLBACK
[0m16:03:00.000199 [debug] [Thread-1 (]: On test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f: Close
[0m16:03:00.000199 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_sales_reference_id .................................... [[32mPASS[0m in 0.06s]
[0m16:03:00.001320 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m16:03:00.002487 [debug] [Thread-1 (]: Began running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m16:03:00.003514 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_sales_reference_id ................................ [RUN]
[0m16:03:00.004184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f, now test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8)
[0m16:03:00.005296 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m16:03:00.013330 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m16:03:00.014348 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m16:03:00.017852 [debug] [Thread-1 (]: Writing runtime sql for node "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m16:03:00.018892 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m16:03:00.019922 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: BEGIN
[0m16:03:00.019922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:00.058037 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m16:03:00.058037 [debug] [Thread-1 (]: Using postgres connection "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m16:03:00.059075 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "node_id": "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    reference_id as unique_field,
    count(*) as n_records

from "postgres"."public_marts"."fct_sales"
where reference_id is not null
group by reference_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:00.063870 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:03:00.064917 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: ROLLBACK
[0m16:03:00.066329 [debug] [Thread-1 (]: On test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8: Close
[0m16:03:00.066329 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_sales_reference_id ...................................... [[32mPASS[0m in 0.06s]
[0m16:03:00.067328 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m16:03:00.068546 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:00.069714 [debug] [MainThread]: On master: BEGIN
[0m16:03:00.069714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:00.107503 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m16:03:00.107503 [debug] [MainThread]: On master: COMMIT
[0m16:03:00.108503 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:00.108503 [debug] [MainThread]: On master: COMMIT
[0m16:03:00.109761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:03:00.109761 [debug] [MainThread]: On master: Close
[0m16:03:00.110761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:00.110761 [debug] [MainThread]: Connection 'list_postgres_public_staging' was properly closed.
[0m16:03:00.110761 [debug] [MainThread]: Connection 'test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8' was properly closed.
[0m16:03:00.110761 [info ] [MainThread]: 
[0m16:03:00.112254 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m16:03:00.113423 [debug] [MainThread]: Command end result
[0m16:03:00.144407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m16:03:00.147200 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m16:03:00.156904 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m16:03:00.156904 [info ] [MainThread]: 
[0m16:03:00.157944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:00.158983 [info ] [MainThread]: 
[0m16:03:00.158983 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:03:00.160981 [debug] [MainThread]: Command `dbt test` succeeded at 16:03:00.160017 after 2.41 seconds
[0m16:03:00.160981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5654DCAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B565852A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56696B400>]}
[0m16:03:00.161979 [debug] [MainThread]: Flushing usage events
[0m16:03:00.779360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:14.836784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D5180A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D7363E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D73603D0>]}


============================== 16:08:14.840558 | f45ebb91-0298-48f0-8e75-f41af8357efe ==============================
[0m16:08:14.840558 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:08:14.840558 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\IVS737\\.dbt', 'write_json': 'True', 'invocation_command': 'dbt compile', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\IVS737\\Desktop\\16.10 data test task\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:08:15.057589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f45ebb91-0298-48f0-8e75-f41af8357efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D73BD600>]}
[0m16:08:15.129787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f45ebb91-0298-48f0-8e75-f41af8357efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D6B114B0>]}
[0m16:08:15.131506 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:08:15.381191 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:08:15.634627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:08:15.635667 [debug] [MainThread]: Partial parsing: added file: gyb_test_project://analyses\analytics.sql
[0m16:08:15.950020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f45ebb91-0298-48f0-8e75-f41af8357efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D7A06C80>]}
[0m16:08:16.076711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m16:08:16.079721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m16:08:16.106066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f45ebb91-0298-48f0-8e75-f41af8357efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D8AA1990>]}
[0m16:08:16.106066 [info ] [MainThread]: Found 2 models, 4 analyses, 1 seed, 6 data tests, 447 macros
[0m16:08:16.107243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f45ebb91-0298-48f0-8e75-f41af8357efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D8B2E710>]}
[0m16:08:16.109349 [info ] [MainThread]: 
[0m16:08:16.110622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:16.110622 [info ] [MainThread]: 
[0m16:08:16.111757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:08:16.116384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_staging'
[0m16:08:16.194896 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:08:16.195911 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m16:08:16.195911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:16.236556 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m16:08:16.236556 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m16:08:16.237589 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:08:16.243806 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m16:08:16.245845 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m16:08:16.246362 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m16:08:16.246362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now list_postgres_public_marts)
[0m16:08:16.249439 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m16:08:16.249439 [debug] [ThreadPool]: On list_postgres_public_marts: BEGIN
[0m16:08:16.250840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:16.390401 [debug] [ThreadPool]: SQL status: BEGIN in 0.140 seconds
[0m16:08:16.390401 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_marts"
[0m16:08:16.391435 [debug] [ThreadPool]: On list_postgres_public_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "list_postgres_public_marts"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:08:16.398226 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m16:08:16.399226 [debug] [ThreadPool]: On list_postgres_public_marts: ROLLBACK
[0m16:08:16.400194 [debug] [ThreadPool]: On list_postgres_public_marts: Close
[0m16:08:16.404912 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:16.404912 [debug] [MainThread]: On master: BEGIN
[0m16:08:16.405959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:16.441243 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m16:08:16.441243 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:16.442286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "gyb_test_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:08:16.450085 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m16:08:16.451085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f45ebb91-0298-48f0-8e75-f41af8357efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D8AA2020>]}
[0m16:08:16.452082 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:16.452082 [debug] [MainThread]: On master: Close
[0m16:08:16.457260 [debug] [Thread-1 (]: Began running node seed.gyb_test_project.sales_data
[0m16:08:16.457260 [debug] [Thread-1 (]: Acquiring new postgres connection 'seed.gyb_test_project.sales_data'
[0m16:08:16.458259 [debug] [Thread-1 (]: Began compiling node seed.gyb_test_project.sales_data
[0m16:08:16.465895 [debug] [Thread-1 (]: Began executing node seed.gyb_test_project.sales_data
[0m16:08:16.465895 [debug] [Thread-1 (]: Finished running node seed.gyb_test_project.sales_data
[0m16:08:16.467111 [debug] [Thread-1 (]: Began running node model.gyb_test_project.stg_sales
[0m16:08:16.468266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.gyb_test_project.sales_data, now model.gyb_test_project.stg_sales)
[0m16:08:16.468266 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.stg_sales
[0m16:08:16.472255 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.stg_sales"
[0m16:08:16.473608 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.stg_sales
[0m16:08:16.474793 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.stg_sales
[0m16:08:16.476019 [debug] [Thread-1 (]: Began running node model.gyb_test_project.fct_sales
[0m16:08:16.476019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.gyb_test_project.stg_sales, now model.gyb_test_project.fct_sales)
[0m16:08:16.477018 [debug] [Thread-1 (]: Began compiling node model.gyb_test_project.fct_sales
[0m16:08:16.480009 [debug] [Thread-1 (]: Writing injected SQL for node "model.gyb_test_project.fct_sales"
[0m16:08:16.481007 [debug] [Thread-1 (]: Began executing node model.gyb_test_project.fct_sales
[0m16:08:16.482004 [debug] [Thread-1 (]: Finished running node model.gyb_test_project.fct_sales
[0m16:08:16.482004 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m16:08:16.483791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.gyb_test_project.fct_sales, now test.gyb_test_project.not_null_stg_sales_country.54818173bf)
[0m16:08:16.483791 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m16:08:16.495912 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_country.54818173bf"
[0m16:08:16.497126 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m16:08:16.497126 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_country.54818173bf
[0m16:08:16.498581 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m16:08:16.498581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_country.54818173bf, now test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb)
[0m16:08:16.499609 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m16:08:16.503789 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb"
[0m16:08:16.504822 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m16:08:16.504822 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb
[0m16:08:16.505838 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m16:08:16.505838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_product_name.cba89fddbb, now test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb)
[0m16:08:16.507034 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m16:08:16.511355 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb"
[0m16:08:16.512449 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m16:08:16.513463 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb
[0m16:08:16.513815 [debug] [Thread-1 (]: Began running node analysis.gyb_test_project.agent_performance
[0m16:08:16.513815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_stg_sales_reference_id.35245943eb, now analysis.gyb_test_project.agent_performance)
[0m16:08:16.514847 [debug] [Thread-1 (]: Began compiling node analysis.gyb_test_project.agent_performance
[0m16:08:16.517839 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.gyb_test_project.agent_performance"
[0m16:08:16.518836 [debug] [Thread-1 (]: Began executing node analysis.gyb_test_project.agent_performance
[0m16:08:16.519834 [debug] [Thread-1 (]: Finished running node analysis.gyb_test_project.agent_performance
[0m16:08:16.520831 [debug] [Thread-1 (]: Began running node analysis.gyb_test_project.analytics
[0m16:08:16.520831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.gyb_test_project.agent_performance, now analysis.gyb_test_project.analytics)
[0m16:08:16.520831 [debug] [Thread-1 (]: Began compiling node analysis.gyb_test_project.analytics
[0m16:08:16.526942 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.gyb_test_project.analytics"
[0m16:08:16.528418 [debug] [Thread-1 (]: Began executing node analysis.gyb_test_project.analytics
[0m16:08:16.528418 [debug] [Thread-1 (]: Finished running node analysis.gyb_test_project.analytics
[0m16:08:16.529703 [debug] [Thread-1 (]: Began running node analysis.gyb_test_project.discount_analysis
[0m16:08:16.529703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.gyb_test_project.analytics, now analysis.gyb_test_project.discount_analysis)
[0m16:08:16.530750 [debug] [Thread-1 (]: Began compiling node analysis.gyb_test_project.discount_analysis
[0m16:08:16.533855 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.gyb_test_project.discount_analysis"
[0m16:08:16.544182 [debug] [Thread-1 (]: Began executing node analysis.gyb_test_project.discount_analysis
[0m16:08:16.545220 [debug] [Thread-1 (]: Finished running node analysis.gyb_test_project.discount_analysis
[0m16:08:16.545220 [debug] [Thread-1 (]: Began running node analysis.gyb_test_project.revenue_growth
[0m16:08:16.546213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.gyb_test_project.discount_analysis, now analysis.gyb_test_project.revenue_growth)
[0m16:08:16.546213 [debug] [Thread-1 (]: Began compiling node analysis.gyb_test_project.revenue_growth
[0m16:08:16.549207 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.gyb_test_project.revenue_growth"
[0m16:08:16.550204 [debug] [Thread-1 (]: Began executing node analysis.gyb_test_project.revenue_growth
[0m16:08:16.551202 [debug] [Thread-1 (]: Finished running node analysis.gyb_test_project.revenue_growth
[0m16:08:16.552199 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50
[0m16:08:16.552199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.gyb_test_project.revenue_growth, now test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50)
[0m16:08:16.552199 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50
[0m16:08:16.556916 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50"
[0m16:08:16.557950 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50
[0m16:08:16.559011 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50
[0m16:08:16.559011 [debug] [Thread-1 (]: Began running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m16:08:16.560337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_order_date_kyiv_ts.a6c48e7f50, now test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f)
[0m16:08:16.560337 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m16:08:16.564872 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f"
[0m16:08:16.566275 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m16:08:16.566275 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f
[0m16:08:16.567737 [debug] [Thread-1 (]: Began running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m16:08:16.567737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.gyb_test_project.not_null_fct_sales_reference_id.cef00ba80f, now test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8)
[0m16:08:16.568746 [debug] [Thread-1 (]: Began compiling node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m16:08:16.574940 [debug] [Thread-1 (]: Writing injected SQL for node "test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8"
[0m16:08:16.576020 [debug] [Thread-1 (]: Began executing node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m16:08:16.576020 [debug] [Thread-1 (]: Finished running node test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8
[0m16:08:16.577391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:16.578407 [debug] [MainThread]: Connection 'list_postgres_public_marts' was properly closed.
[0m16:08:16.578407 [debug] [MainThread]: Connection 'test.gyb_test_project.unique_fct_sales_reference_id.4ac4f9b0c8' was properly closed.
[0m16:08:16.581417 [debug] [MainThread]: Command end result
[0m16:08:16.606764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\manifest.json
[0m16:08:16.609774 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\IVS737\Desktop\16.10 data test task\target\semantic_manifest.json
[0m16:08:16.618909 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\IVS737\Desktop\16.10 data test task\target\run_results.json
[0m16:08:16.619912 [debug] [MainThread]: Command `dbt compile` succeeded at 16:08:16.619912 after 1.88 seconds
[0m16:08:16.619912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D5180A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D6B114B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D8AA2DD0>]}
[0m16:08:16.620916 [debug] [MainThread]: Flushing usage events
[0m16:08:17.197648 [debug] [MainThread]: An error was encountered while trying to flush usage events
